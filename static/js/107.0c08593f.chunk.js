"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[107,990],{5658:function(e,n,t){t.d(n,{s:function(){return u},u:function(){return a}});var r=t(8312),i=(t(2411),t(6676)),s=t(3896),c=t(8136),l=["cartInstance","itemSlug"],a=function(e){var n=e.cartInstance,t=e.itemSlug,a=(0,r.Z)(e,l);return t?(0,c.jsx)(i.pu,{renderHeader:function(){return(0,c.jsx)("div",{children:"Supprimer ce produit"})},renderFooter:function(e){var r=e.setOpen;return(0,c.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,c.jsx)(i.zx,{onClick:function(){return r(!1)},children:"Annuler"}),(0,c.jsx)(i.zx,{onClick:function(){return n.destroyItem(t).then((function(e){var n;null===a||void 0===a||null===(n=a.onSuccess)||void 0===n||n.call(a,e)})).catch((function(e){var n;null===a||void 0===a||null===(n=a.onError)||void 0===n||n.call(a,e)}))},className:"btn-danger",children:"Supprimer"})]})},render:function(){return(0,c.jsx)("div",{className:"p-3",children:"Voulez-vous supprimer ce produit"})},className:(0,s.UT)(["cart-item-delete-button btn-danger-3"]),children:(0,c.jsx)(i.PJ.rF,{})}):null},u=function(e){var n=e.instance,t=e.onSuccess,r=e.onError,l=e.label;return(0,c.jsxs)(i.pu,{disabled:!n.canDestroy,title:n.canDestroy?"Delete this cart":"Can't delete a cart with items",renderHeader:function(){return(0,c.jsx)("div",{children:"Supprimer ce panier"})},renderFooter:function(e){var s=e.setOpen;return(0,c.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,c.jsx)(i.zx,{onClick:function(){return s(!1)},children:"Annuler"}),(0,c.jsx)(i.zx,{onClick:function(){return function(e){n.canDestroy&&n.destroy().then((function(n){null===t||void 0===t||t(n),null===e||void 0===e||e(!1)})).catch((function(e){return null===r||void 0===r?void 0:r(e)}))}(s)},className:"btn-danger",children:"Supprimer"})]})},render:function(){return(0,c.jsx)("div",{className:"p-3",children:"Are you sure you want to delete this"})},className:(0,s.UT)(["cart-delete-button btn-danger-3",e.className]),children:[(0,c.jsx)(i.PJ.rF,{}),l&&(0,c.jsx)("span",{className:"label",children:l})]})}},606:function(e,n,t){t.d(n,{n:function(){return d},q:function(){return o}});var r=t(8312),i=t(8519),s=(t(2411),t(9650)),c=t(3896),l=t(4113),a=t(8136),u=["product","width","height"],d=function(e){var n=e.product,t=e.size;return(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[(0,a.jsx)(o,{product:n,width:60,height:60}),(0,a.jsxs)("div",{className:"flex-1 rounded p-1 ",children:[(0,a.jsx)("div",{className:"fw-bold",children:(0,c.bI)(null===n||void 0===n?void 0:n.name,0,25)}),(0,a.jsx)(l._S,(0,i.Z)((0,i.Z)({},n),{},{inline:!0})),t&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"me-1",children:"Size:"}),(0,a.jsx)("span",{className:"text-sm",children:null===t||void 0===t?void 0:t.name})]})]})]})},o=function(e){var n=e.product,t=e.width,c=e.height,l=(0,r.Z)(e,u);return null!==n&&void 0!==n&&n.slug?(0,a.jsx)("div",(0,i.Z)((0,i.Z)({},l),{},{style:{width:t,height:c},children:(0,a.jsx)(s.ZP.Img.Square,(0,i.Z)((0,i.Z)({slug:"slug",src:"src"},n.cover_data),{},{className:"rounded"}))})):null}},5511:function(e,n,t){t.d(n,{A:function(){return d}});var r=t(8519),i=t(1135),s=t(7411),c=t(2518),l=t(2485),a=t(9650),u=function(e){(0,c.Z)(t,e);var n=(0,l.Z)(t);function t(){return(0,i.Z)(this,t),n.apply(this,arguments)}return(0,s.Z)(t,[{key:"canDestroy",get:function(){var e,n;return 0===(null===this||void 0===this||null===(e=this.data)||void 0===e||null===(n=e.products)||void 0===n?void 0:n.length)}},{key:"addItems",value:function(e){return this.post("".concat(this._path,"products/"),e)}},{key:"addItem",value:function(e,n){return this.post("".concat(this._path,"product/").concat(e,"/"),n)}},{key:"updateItem",value:function(e,n){return this.post("".concat(this._path,"item/").concat(e,"/"),(0,r.Z)({},n),{timeout:5e3})}},{key:"destroyItem",value:function(e){return this.delete("".concat(this._path,"item/").concat(e,"/"),{timeout:5e3})}}]),t}(a.x5),d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.eR)(e,"carts",u)}},2107:function(e,n,t){t.r(n),t.d(n,{ProductAddForm:function(){return w},default:function(){return S}});var r=t(8519),i=t(6009),s=t(8312),c=t(2411),l=t(6520),a=t(9650),u=t(9110),d=t(6676),o=t(3308),m=t(3896),h=t(4113),x=t(5511),f=t(606),v=t(9062),j=t(8136),p=function(e){var n=e.setOpen,t=e.selected,r=void 0===t?[]:t;return(0,j.jsxs)("div",{className:"cart-add-item-view-header miq-container center px-1 pt-2",children:[(0,j.jsx)(d.M$,{title:(0,j.jsx)("span",{className:"fw-bold mt-2",children:"Ajouter des produits"}),text:"Tap on a product to add to the cart/ Cliquez sur un produit pour l'ajouter au panier",actions:(0,j.jsx)("div",{onClick:function(){return null===n||void 0===n?void 0:n(!1)},children:" [ x ]"})}),(0,j.jsx)(d.j6,{className:"cart-items-preview",style:{minHeight:48,paddingBottom:0},children:r.map((function(e){return(0,j.jsx)("div",{children:(0,j.jsx)(f.q,{product:e,width:48,height:48})},(0,m.Vj)())}))})]})};function g(e){var n,t=(0,h._P)(void 0,{published:"include",atc:1}),s=t.res,l=t.loading,u=c.useState([]),o=(0,i.Z)(u,2),x=o[0],g=o[1];if(!e.isOpen)return null;if(l)return(0,j.jsx)(d.gb,{});var b=new m.HM(s).items||[],N=e.cart,Z=(null===N||void 0===N||null===(n=N.items)||void 0===n?void 0:n.map((function(e){return e.size})))||[];return(0,j.jsx)(d.cv,{style:{zIndex:1e4},className:"bg-white m-1 rounded",header:(0,j.jsx)(p,(0,r.Z)((0,r.Z)({},e),{},{selected:x})),footer:(0,j.jsx)("div",{className:"miq-container center",children:(0,j.jsxs)("div",{className:"d-flex justify-content-between bg-white p-2",children:[(0,j.jsx)("div",{children:(0,j.jsx)(d.zx,{onClick:function(){return e.setOpen(!1)},className:"",children:"Annuler"})}),(0,j.jsx)("div",{children:(0,j.jsx)(d.zx,{disabled:0===x.length,onClick:function(){return function(){var n=x.map((function(e){return{product_slug:e.meta_slug,size:e.sizeSlug,quantity:1}}));0!==n.length&&N.addItems(n).then((function(n){var t;g([]),null===e||void 0===e||null===(t=e.onSuccess)||void 0===t||t.call(e,n)})).catch((function(n){var t;return null===e||void 0===e||null===(t=e.onError)||void 0===t?void 0:t.call(e,n)}))}()},className:"btn-primary fw-bold",children:"Ajouter"})})]})}),children:(0,j.jsx)(a.ZP.Section,{header:(0,j.jsx)(h.ir,{}),className:"miq-container center px-1",children:b.map((function(e){var n=e.sizes;return(void 0===n?[]:n).filter((function(e){return e.quantity>=1})).filter((function(e){return!Z.includes(e.slug)})).map((function(n){var t=x.find((function(e){return e.sizeSlug===(null===n||void 0===n?void 0:n.slug)})),i=Boolean(t);return(0,j.jsxs)("div",{className:"d-flex align-items-center mb-1 border-1 rounded",style:{padding:6},onClick:function(){g(i?function(e){return e.filter((function(e){return e.sizeSlug!=(null===n||void 0===n?void 0:n.slug)}))}:[(0,r.Z)((0,r.Z)({},e),{},{sizeSlug:n.slug})].concat((0,v.Z)(x)))},children:[(0,j.jsx)("div",{className:"flex-1",children:(0,j.jsx)(f.n,{product:e,size:n})}),(0,j.jsx)("div",{style:{minWidth:24,marginLeft:3,marginRight:6},children:(0,j.jsx)("input",{type:"checkbox",name:"selected",className:"me-2",checked:i,onChange:function(){}})})]},(0,m.Vj)())}))}))})})}var b=t(5658),N=t(990),Z=["res","setRes","loading"],y=["item","onItemClick"];function S(){var e;(0,u.jr)("Add items to cart - Sales");var n=(0,l.UO)().cartSlug,t=(0,u.QT)((function(){return(0,x.A)({slug:n}).retrieve()}),{refreshDeps:[n],onError:function(e){e.response}}),o=t.res,v=t.setRes,p=t.loading,y=((0,s.Z)(t,Z),c.useState(!1)),S=(0,i.Z)(y,2),w=S[0],_=S[1],z=new m.HM(o);if(!z.isSuccess)return null;if(p)return(0,j.jsx)(d.gb,{});var C=(0,x.A)(z.data);return(0,j.jsxs)(a.ZP.View,{title:"Ajouter au panier",back:"/staff/sales/carts",children:[(0,j.jsxs)("div",{className:"miq-container center",children:[(0,j.jsx)(a.ZP.Section,{border:!0,title:"Panier (".concat(null===C||void 0===C||null===(e=C.products)||void 0===e?void 0:e.length," produits)"),actions:(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(d.zx,{onClick:function(){return _(!0)},className:"btn-primary-3 btn-round",title:"Ajouter des produits",children:(0,j.jsx)(d.PJ.HB,{})})}),footer:(0,j.jsxs)("div",{className:"",children:[(0,j.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,j.jsx)("span",{className:"",children:"Subtotal"}),(0,j.jsx)("span",{children:(0,j.jsx)(h._S,{retail_price_data:null===C||void 0===C?void 0:C.subtotal})})]}),(0,j.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,j.jsx)("span",{className:"",children:"Total"}),(0,j.jsx)("span",{className:"fw-bold",children:(0,j.jsx)(h._S,{retail_price_data:null===C||void 0===C?void 0:C.subtotal})})]})]}),children:C.items.length>0?(0,j.jsx)(j.Fragment,{children:C.items.map((function(e){return(0,j.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,j.jsx)(f.n,(0,r.Z)((0,r.Z)({},e),{},{size:e.size_data})),(0,j.jsx)("div",{children:(0,j.jsx)(b.u,{cartInstance:C,itemSlug:null===e||void 0===e?void 0:e.slug,onSuccess:function(e){return v(e)}})})]},(0,m.Vj)())}))}):(0,j.jsx)(j.Fragment,{children:"Ajouter"})}),(0,j.jsx)(a.ZP.Section,{border:!0,title:"Client",children:(0,j.jsx)(N.CustomerCard,{data:C.customer_data})}),(0,j.jsx)("div",{className:"text-center",children:(0,j.jsx)(d.zx,{disabled:C.products.length<=0,className:"btn-primary btn-md fw-bold w-50",children:"Confirmer"})})]}),w&&(0,j.jsx)(g,{isOpen:w,setOpen:_,cart:C,onSuccess:function(e){v(e),_(!1)}})]})}var w=function(e){var n,t=e.item,i=e.onItemClick,c=((0,s.Z)(e,y),(0,o.cI)({quantity:1,size:""}));if(null===t||void 0===t||!t.slug)return null;var l=t.sizes,u=void 0===l?[]:l,d=(t.is_oos,t.category_data,t.cover_data),x=t.name;t.size_count;return(0,j.jsx)(o.ZP,{context:c,onSubmit:function(e){e.preventDefault(),i(t,c.values.size,c.values.quantity).catch((function(e){c.handleError(e)}))},children:(0,j.jsx)(a.ZP.Section,{border:!0,header:(0,j.jsxs)("div",{className:"d-flex",children:[(0,j.jsx)("div",{style:{minWidth:34,maxWidth:50},className:"me-1",children:(0,j.jsx)(a.ZP.Img.Thumb,(0,r.Z)((0,r.Z)({src:"src"},d),{},{className:"rounded"}))}),(0,j.jsxs)("div",{className:"flex-1",title:x,children:[(0,j.jsx)("div",{className:"text-ellipsis text-sm",children:(0,j.jsx)("span",{className:"me-1 fw-bold",children:(0,m.bI)(x,0,45)})}),(0,j.jsxs)("div",{className:"d-flex flex-column flex-md-ro justify-content-between",children:[(0,j.jsxs)("div",{className:"d-grid grid-md-2 gap-1 flex-1",children:[(0,j.jsx)(h.D8,{required:!0,sizes:u.filter((function(e){return e.quantity>0})),error:c.errors.size}),(0,j.jsx)(h.PI,{max:(null===(n=u.find((function(e){return e.slug===c.values.size})))||void 0===n?void 0:n.quantity)||0,min:1})]}),(0,j.jsx)("div",{className:"text-right",children:(0,j.jsx)(o.ZP.Submit,{className:"btn btn-primary-2 btn-md fw-bold",children:"Ajouter"})})]})]})]}),actions:(0,j.jsx)(h._S,(0,r.Z)((0,r.Z)({},t),{},{className:"d-flex flex-wrap"})),className:"mb-1"})})}},4706:function(e,n,t){t.d(n,{u:function(){return c}});var r=t(8312),i=(t(2411),t(8136)),s=["data"],c=function(e){var n=e.data;(0,r.Z)(e,s);if(!n||!n.slug)return null;var t=n.first_name,c=n.last_name,l=n.email,a=n.phone;return(0,i.jsxs)("div",{className:"customer-card",children:[(0,i.jsx)("div",{className:"fw-bold",children:"".concat(t," ").concat(c)}),(0,i.jsx)("div",{className:"",children:a}),(0,i.jsx)("div",{className:"text-muted text-sm",children:l})]})}},7866:function(e,n,t){t.d(n,{A:function(){return u}});var r=t(8519),i=t(8312),s=(t(2411),t(3308)),c=t(4387),l=t(8136),a=["children","instance","onSuccess","onError","onCustomerSelect"],u=function(e){var n=e.children,t=e.instance,u=(e.onSuccess,e.onError,e.onCustomerSelect),o=(0,i.Z)(e,a),m=o.fields,h=(0,s.cI)(d(null===t||void 0===t?void 0:t.export(),m)),x=h.errors,f={className:"span-md-3",fieldCN:"d-grid grid-md-5"};return(0,l.jsxs)(s.ZP,(0,r.Z)((0,r.Z)({},o),{},{context:h,className:"customer-form",children:[(0,l.jsxs)("div",{className:"base-fields",children:[(null===m||void 0===m?void 0:m.includes("last_name"))&&(0,l.jsx)(c.Pg,(0,r.Z)((0,r.Z)({allowSuggestions:!0,error:x.last_name},f),{},{onCustomerSelect:u,className:""})),(null===m||void 0===m?void 0:m.includes("first_name"))&&(0,l.jsx)(c.jF,(0,r.Z)({error:x.first_name},f)),(null===m||void 0===m?void 0:m.includes("phone"))&&(0,l.jsx)(c.xx,(0,r.Z)({error:x.phone},f)),(null===m||void 0===m?void 0:m.includes("email"))&&(0,l.jsx)(c.ey,(0,r.Z)({error:x.email},f))]}),n]}))},d=function(e,n){e||(e={first_name:"",last_name:"",email:"",phone:""});var t={};return null===n||void 0===n||n.forEach((function(n){t[n]=e[n]})),t}},990:function(e,n,t){t.r(n),t.d(n,{CustomerCard:function(){return c.u},CustomerForm:function(){return l.A},default:function(){return o}});var r=t(2411),i=t(6520),s=t(8136),c=t(4706),l=t(7866),a=r.lazy((function(){return t.e(788).then(t.bind(t,5788))})),u=r.lazy((function(){return t.e(272).then(t.bind(t,5272))})),d=r.lazy((function(){return t.e(538).then(t.bind(t,6538))}));function o(){return(0,s.jsxs)(i.Z5,{children:[(0,s.jsx)(i.AW,{path:":custSlug/",element:(0,s.jsx)(u,{})}),(0,s.jsx)(i.AW,{path:"new/",element:(0,s.jsx)(a,{})}),(0,s.jsx)(i.AW,{index:!0,element:(0,s.jsx)(d,{})})]})}}}]);
//# sourceMappingURL=107.0c08593f.chunk.js.map