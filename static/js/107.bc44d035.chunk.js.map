{"version":3,"file":"static/js/107.bc44d035.chunk.js","mappings":"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","sources":["../../../../shopy/shopy-orderjs/src/cart/buttons.tsx","../../../../shopy/shopy-orderjs/src/cart/components.tsx","../../../../shopy/shopy-orderjs/src/cart/models.tsx","../../../../shopy/shopy-orderjs/src/cart/views.AddItem.tsx","../../../../shopy/shopy-orderjs/src/cart/views.Update.tsx","../../../../shopy/shopy-orderjs/src/customer/components.tsx","../../../../shopy/shopy-orderjs/src/customer/forms/index.tsx","../../../../shopy/shopy-orderjs/src/customer/index.tsx"],"sourcesContent":["import { Button, ConfirmButton, Icons } from '@miq/componentjs';\nimport { IFormUpdateProps } from '@miq/formjs';\nimport { TCampaignInstance } from '@miq/staffjs';\nimport { getCN } from '@miq/utiljs';\n\nimport { TCartInstance } from './models';\nimport { TCart } from './types';\n\nexport const CartItemDeleteButton = ({\n  cartInstance,\n  itemSlug,\n  ...props\n}: {\n  itemSlug: string;\n  cartInstance: TCartInstance;\n  onSuccess?: (res?: any) => void;\n  onError?: (res?: any) => void;\n}) => {\n  if (!itemSlug) return null;\n\n  return (\n    <ConfirmButton\n      renderHeader={() => <div>Supprimer ce produit</div>}\n      renderFooter={({ setOpen }) => (\n        <div className=\"d-flex justify-content-between align-items-center\">\n          <Button onClick={() => setOpen(false)}>Annuler</Button>\n\n          <Button\n            onClick={() =>\n              cartInstance\n                .destroyItem(itemSlug)\n                .then((r) => {\n                  props?.onSuccess?.(r);\n                  // setOpen(false);\n                })\n                .catch((err) => {\n                  props?.onError?.(err);\n                })\n            }\n            className=\"btn-danger\"\n          >\n            Supprimer\n          </Button>\n        </div>\n      )}\n      render={() => <div className=\"p-3\">Voulez-vous supprimer ce produit</div>}\n      className={getCN(['cart-item-delete-button btn-danger-3'])}\n    >\n      <Icons.Trash />\n    </ConfirmButton>\n  );\n};\n\nexport const CartDeleteButton: React.FC<\n  Omit<IFormUpdateProps<TCart>, 'context'> & { label?: string; instance: TCampaignInstance }\n> = (props) => {\n  const { instance, onSuccess, onError, label } = props;\n\n  const handleDelete = (setOpen: any) => {\n    instance\n      .destroy()\n      .then((res: any) => {\n        onSuccess?.(res);\n        setOpen?.(false);\n        // emitter.destroy({ slug: instance.slug });\n      })\n      .catch((err: any) => onError?.(err));\n  };\n  return (\n    <ConfirmButton\n      renderHeader={() => <div>Supprimer ce panier</div>}\n      renderFooter={({ setOpen }) => (\n        <div className=\"d-flex justify-content-between align-items-center\">\n          <Button onClick={() => setOpen(false)}>Annuler</Button>\n\n          <Button onClick={() => handleDelete(setOpen)} className=\"btn-danger\">\n            Supprimer\n          </Button>\n        </div>\n      )}\n      render={() => <div className=\"p-3\">Are you sure you want to delete this</div>}\n      className={getCN(['cart-delete-button btn-danger-3', props.className])}\n    >\n      <Icons.Trash />\n      {label && <span className=\"label\">{label}</span>}\n    </ConfirmButton>\n  );\n};\n","import * as React from 'react';\n\nimport Staff from '@miq/staffjs';\nimport { truncateStr } from '@miq/utiljs';\nimport { ProductPriceDisplay, TProduct, TProductSize } from '@shopy/storejs';\n\nexport const ItemProductCard = ({ product, size }: { product: TProduct; size: TProductSize }) => (\n  <div className=\"d-flex align-items-center\">\n    <ProductImage {...{ product, width: 60, height: 60 }} />\n    <div className=\"flex-1 rounded p-1 \">\n      <div className=\"fw-bold\">{truncateStr(product?.name, 0, 25)}</div>\n      <ProductPriceDisplay {...product} inline />\n      {size && (\n        <div>\n          <span className=\"me-1\">Size:</span>\n          <span className=\"text-sm\">{size?.name}</span>\n        </div>\n      )}\n    </div>\n  </div>\n);\n\nexport const ProductImage = ({\n  product,\n  width,\n  height,\n  ...props\n}: {\n  product: TProduct;\n  width?: number | string;\n  height?: number | string;\n}) =>\n  product?.slug ? (\n    <div {...props} style={{ width: width, height: height }}>\n      <Staff.Img.Square slug=\"slug\" src=\"src\" {...product.cover_data} className=\"rounded\" />\n    </div>\n  ) : null;\n","import { StaffModel, StaffService } from '@miq/staffjs';\nimport { TCart } from './types';\n\nconst timeout = 5000;\n\n/**\n * CART\n */\n\nclass CartService extends StaffService<TCart> {\n  addItems(sizeSlug: string) {\n    return this.post(`${this._path}items/`, { sizeSlug });\n  }\n\n  addItem(prodSlug: string, size: string, qty?: string) {\n    return this.post(`${this._path}item/${prodSlug}/`, { size, qty });\n  }\n\n  updateItem(prodSlug: string, values: Record<string, any>) {\n    return this.post(`${this._path}item/${prodSlug}/`, { ...values }, { timeout });\n  }\n\n  destroyItem(itemSlug: string) {\n    return this.delete(`${this._path}item/${itemSlug}/`, { timeout });\n  }\n}\n\nexport const Cart = (data: TCart = {}) => {\n  return StaffModel<TCart, CartService>(data, 'carts', CartService);\n};\n\nexport type TCartInstance = ReturnType<typeof Cart>;\n\n// export const Cart = (data: any) => {\n//   getIsValid(data: Record<string, any>): boolean {\n//     return data && data.slug && data.products && Boolean(data.items.length);\n//   }\n\n//   getItem(meta_slug: string) {\n//     return;\n//     // return this.items?.find((i: any) => i.product.meta_slug === meta_slug);\n//   }\n\n//   postItem(prod_meta_slug: string, values: any) {\n//     // values may contain size and other info\n\n//     if (this.slug && values) values.cart_slug = this.slug;\n//     return this.postPath(`${this._endpoint}items/`, { ...values, prod_meta_slug });\n//   }\n\n//   patchItem(itemSlug: string, values: any) {\n//     return this.patchPath(`${this._path}/item/${itemSlug}/`, values);\n//   }\n//   deleteItem(itemSlug: string) {\n//     return this.deletePath(`${this._path}/item/${itemSlug}/`);\n//   }\n\n//   patchCustomer(values: any) {\n//     if (values && this?.customer?.slug) values.cust_slug = this.customer.slug;\n//     return this.patchPath(`${this._path}/customer/`, values);\n//   }\n//   postCustomer(values: any) {\n//     return this._s.post(`${this._path}/customer/`, values);\n//   }\n// }\n\n// //   const methods = {\n// //     getItem,\n// //     postItem,\n// //     patchItem,\n// //     deleteItem,\n// //     patchCustomer,\n// //     postCustomer,\n// //   };\n\n// //   return Object.assign({ isValid: getIsValid() }, CrudModel(data, 'api/carts/'), methods);\n// // };\n\n// export const Customer = (data: any) => {\n//   // return Object.assign({}, CrudModel(data, 'api/carts/'), methods);\n// };\n","import * as React from 'react';\n\nimport Staff from '@miq/staffjs';\nimport { Response, uuid } from '@miq/utiljs';\nimport { useProductListRequest, ProductListFilterForm, TProduct, TProductSize } from '@shopy/storejs';\nimport { Button, HorizontalScrollGridLayout, SectionHeader, StickyFooterLayout } from '@miq/componentjs';\n\nimport { TCartInstance } from './models';\nimport { ItemProductCard, ProductImage } from './components';\n\ntype TProps = { cart: TCartInstance; isOpen: boolean; setOpen: any };\n\ntype TSelect = TProduct & { sizeSlug: string };\n\nconst ViewHeader = (props: TProps & { selected: TSelect[] }) => {\n  const { setOpen, selected = [] } = props;\n\n  return (\n    <div className=\"cart-add-item-view-header miq-container center px-1 pt-2\">\n      <SectionHeader\n        title={<span className=\"fw-bold mt-2\">Ajouter des produits</span>}\n        text=\"Tap on a product to add to the cart/ Cliquez sur un produit pour l'ajouter au panier\"\n        actions={<div onClick={() => setOpen?.(false)}> [ x ]</div>}\n      />\n\n      <HorizontalScrollGridLayout className=\"cart-items-preview\" style={{ minHeight: 48, paddingBottom: 0 }}>\n        {selected.map((i) => {\n          return (\n            <div key={uuid()}>\n              <ProductImage product={i} {...{ width: 48, height: 48 }} />\n            </div>\n          );\n        })}\n      </HorizontalScrollGridLayout>\n    </div>\n  );\n};\n\nexport default function CartAddItemView(props: TProps) {\n  const { res: productRes } = useProductListRequest(undefined, { published: 'include', atc: 1 });\n  const [selected, setSelected] = React.useState<TSelect[]>([]);\n\n  if (!props.isOpen) return null;\n\n  const products = new Response(productRes).items || [];\n\n  const { cart } = props;\n  const cartSizes = cart.items.map(({ size }) => size?.slug) || [];\n\n  return (\n    <StickyFooterLayout\n      style={{ zIndex: 10000 }}\n      className=\"bg-white\"\n      header={<ViewHeader {...props} {...{ selected }} />}\n      footer={\n        <div className=\"miq-container center\">\n          <div className=\"d-flex justify-content-between bg-white p-2\">\n            <div>\n              <Button onClick={() => props.setOpen(false)} className=\"\">\n                Annuler\n              </Button>\n            </div>\n            <div>\n              <Button\n                disabled={selected.length === 0}\n                // onClick={() => props.setOpen(false)}\n                className=\"btn-primary fw-bold\"\n              >\n                Ajouter\n              </Button>\n            </div>\n          </div>\n        </div>\n      }\n    >\n      <Staff.Section header={<ProductListFilterForm />} className=\"miq-container center px-1\">\n        {products.map((product) => {\n          const { sizes = [] } = product;\n          return sizes\n            .filter((i) => !cartSizes.includes(i.slug))\n            .map((size: TProductSize) => {\n              const checked = selected.find(({ sizeSlug }) => sizeSlug === size?.slug);\n              const isChecked = Boolean(checked);\n              return (\n                <div\n                  className=\"d-flex align-items-center mb-1 border-1 rounded\"\n                  key={uuid()}\n                  style={{ padding: 6 }}\n                  onClick={() => {\n                    if (isChecked) setSelected((items) => items.filter(({ sizeSlug }) => sizeSlug != size?.slug));\n                    else setSelected([{ ...product, sizeSlug: size.slug }, ...selected]);\n                  }}\n                >\n                  <div className=\"flex-1\">\n                    <ItemProductCard {...{ product, size }} />\n                  </div>\n\n                  <div style={{ minWidth: 24, marginLeft: 3, marginRight: 6 }}>\n                    <input type=\"checkbox\" name=\"selected\" className=\"me-2\" checked={isChecked} onChange={() => {}} />\n                  </div>\n                </div>\n              );\n            });\n        })}\n      </Staff.Section>\n    </StickyFooterLayout>\n  );\n}\n","import * as React from 'react';\nimport { useParams } from 'react-router-dom';\n\nimport Staff from '@miq/staffjs';\nimport { useRequest } from '@miq/hookjs';\nimport { Button, Icons, Loading } from '@miq/componentjs';\nimport Form, { useForm } from '@miq/formjs';\nimport { Response, truncateStr, uuid } from '@miq/utiljs';\nimport { SizeQuantityField, SizeSelectField, TProduct, ProductPriceDisplay } from '@shopy/storejs';\n\nimport { Cart } from './models';\nimport { TCart } from './types';\nimport { ItemProductCard } from './components';\nimport CartAddItemView from './views.AddItem';\nimport { CartItemDeleteButton } from './buttons';\nimport { CustomerCard } from '../customer';\n\nexport default function CartUpdateView() {\n  const { cartSlug } = useParams();\n\n  const { res, setRes, loading, ...request } = useRequest(() => Cart({ slug: cartSlug }).retrieve(), {\n    refreshDeps: [cartSlug],\n    // onSuccess: ({ data }) => form.setValues(mapData2Values(data)),\n    onError: ({ response }) => {\n      // if (response?.status === 404) return navigate('../');\n    },\n  });\n  const [isOpen, setOpen] = React.useState<boolean>(false);\n\n  const r = new Response(res);\n  if (!r.isSuccess) return null;\n\n  if (loading) return <Loading />;\n\n  const cart = Cart(r.data);\n\n  return (\n    <Staff.View title=\"Modifier une commande\" back=\"/staff/sales/\">\n      <div className=\"miq-container center\">\n        <Staff.Section border title=\"Client\" actions={<>Modifier</>}>\n          <CustomerCard data={cart.customer_data} />\n        </Staff.Section>\n\n        <Staff.Section\n          border\n          title={`Panier (${cart.products.length} produits)`}\n          actions={\n            <>\n              <Button onClick={() => setOpen(true)} className=\"btn-primary-3 btn-round\" title=\"Ajouter des produits\">\n                <Icons.CartPlus />\n              </Button>\n            </>\n          }\n          footer={\n            <div className=\"\">\n              <div className=\"d-flex justify-content-between\">\n                <span className=\"\">Subtotal</span>\n                <span>\n                  <ProductPriceDisplay retail_price_data={cart?.subtotal} />\n                </span>\n              </div>\n              <div className=\"d-flex justify-content-between\">\n                <span className=\"\">Total</span>\n                <span className=\"fw-bold\">\n                  <ProductPriceDisplay retail_price_data={cart?.subtotal} />\n                </span>\n              </div>\n            </div>\n          }\n        >\n          {cart.items.length > 0 ? (\n            <>\n              {cart.items.map((i) => {\n                console.log(i);\n\n                return (\n                  <div key={uuid()} className=\"d-flex justify-content-between align-items-center\">\n                    <ItemProductCard {...i} size={i.size_data} />\n                    <div>\n                      <CartItemDeleteButton cartInstance={cart} itemSlug={i?.slug} onSuccess={(r) => setRes(r)} />\n                    </div>\n                  </div>\n                );\n              })}\n            </>\n          ) : (\n            <>Ajouter</>\n          )}\n        </Staff.Section>\n\n        <div className=\"text-center\">\n          <Button disabled={cart.products.length <= 0} className=\"btn-primary btn-md fw-bold w-50\">\n            Confirmer\n          </Button>\n        </div>\n      </div>\n\n      <CartAddItemView {...{ isOpen, setOpen, cart }} />\n    </Staff.View>\n  );\n}\n\nexport const ProductAddForm = ({\n  item,\n  onItemClick,\n  ...props\n}: {\n  item: TProduct;\n  onItemClick: (p: TProduct, size: string, qty: string) => Promise<TCart>;\n}) => {\n  const form = useForm({ quantity: 1, size: '' });\n\n  if (!item?.slug) return null;\n\n  const { sizes = [], is_oos, category_data, cover_data, name, size_count = 0 } = item;\n\n  const canAdd = !is_oos && size_count > 0;\n\n  return (\n    <Form\n      context={form}\n      onSubmit={(e) => {\n        e.preventDefault();\n        onItemClick(item, form.values.size, form.values.quantity).catch((err) => {\n          form.handleError(err);\n        });\n      }}\n    >\n      <Staff.Section\n        border\n        header={\n          <div className=\"d-flex\">\n            <div style={{ minWidth: 34, maxWidth: 50 }} className=\"me-1\">\n              <Staff.Img.Thumb src=\"src\" {...cover_data} className=\"rounded\" />\n            </div>\n\n            <div className=\"flex-1\" title={name}>\n              <div className=\"text-ellipsis text-sm\">\n                <span className=\"me-1 fw-bold\">{truncateStr(name!, 0, 45)}</span>\n              </div>\n\n              <div className=\"d-flex flex-column flex-md-ro justify-content-between\">\n                <div className=\"d-grid grid-md-2 gap-1 flex-1\">\n                  <SizeSelectField required sizes={sizes.filter((i) => i.quantity > 0)} error={form.errors.size} />\n                  <SizeQuantityField max={sizes.find((i) => i.slug === form.values.size)?.quantity || 0} min={1} />\n                </div>\n                <div className=\"text-right\">\n                  <Form.Submit className=\"btn btn-primary-2 btn-md fw-bold\">Ajouter</Form.Submit>\n                </div>\n              </div>\n            </div>\n          </div>\n        }\n        actions={<ProductPriceDisplay {...item} className=\"d-flex flex-wrap\" />}\n        className=\"mb-1\"\n      ></Staff.Section>\n    </Form>\n  );\n};\n","import * as React from 'react';\n\nimport { TCustomer } from './types';\n\nexport const CustomerCard = ({ data, ...props }: { data: TCustomer }) => {\n  if (!data || !data.slug) return null;\n\n  const { first_name, last_name, email, phone } = data;\n\n  return (\n    <div className=\"customer-card\">\n      <div className=\"fw-bold\">{`${first_name} ${last_name}`}</div>\n      <div className=\"\">{phone}</div>\n      <div className=\"text-muted text-sm\">{email}</div>\n    </div>\n  );\n};\n","import * as React from 'react';\n\nimport Form, { IFormUpdateProps, useForm } from '@miq/formjs';\nimport { TCustomer } from '../types';\nimport { TCustomerInstance } from '../../cart/models';\nimport { CustomerEmailField, CustomerFNameField, CustomerLNameField, CustomerPhoneField } from './fields';\n\ntype TFormUpdateProps<T, I> = IFormUpdateProps<T> & {\n  fields: string[];\n  instance?: I;\n};\n\ntype TCustomerFormProps = Omit<TFormUpdateProps<TCustomer, TCustomerInstance>, 'context'> & {\n  onCustomerSelect?: (p: TCustomer) => void;\n};\n\nexport const CustomerForm = ({\n  children,\n  instance,\n  onSuccess,\n  onError,\n  onCustomerSelect,\n  ...props\n}: TCustomerFormProps) => {\n  const { fields } = props;\n  const form = useForm<TCustomer>(getCustomerFD(instance?.export(), fields));\n\n  const { errors } = form;\n  const sharedProps = { className: 'span-md-3', fieldCN: 'd-grid grid-md-5' };\n\n  return (\n    <Form {...props} context={form} className=\"customer-form\">\n      <div className=\"base-fields\">\n        {fields?.includes('last_name') && (\n          <CustomerLNameField\n            allowSuggestions\n            error={errors.last_name}\n            {...sharedProps}\n            onCustomerSelect={onCustomerSelect}\n            className=\"\"\n          />\n        )}\n\n        {fields?.includes('first_name') && <CustomerFNameField error={errors.first_name} {...sharedProps} />}\n\n        {fields?.includes('phone') && <CustomerPhoneField error={errors.phone} {...sharedProps} />}\n        {fields?.includes('email') && <CustomerEmailField error={errors.email} {...sharedProps} />}\n      </div>\n\n      {children}\n    </Form>\n  );\n};\nconst getCustomerFD = (data?: TCustomer, fields?: string[]) => {\n  if (!data) data = { first_name: '', last_name: '', email: '', phone: '' };\n  const fd: TCustomer = {};\n  fields?.forEach((field) => {\n    fd[field] = data![field];\n  });\n\n  return fd;\n};\n\nconst CustomerSearchInput = (props) => {\n  return <Form.Text {...props} />;\n};\n","import * as React from 'react';\nimport { Routes, Route } from 'react-router-dom';\n\nconst CustomerCreateView = React.lazy(() => import('./views.Create'));\nconst CustomerUpdateView = React.lazy(() => import('./views.Update'));\nconst CustomerListView = React.lazy(() => import('./views.List'));\n\nexport default function CustomerRoutes() {\n  return (\n    <Routes>\n      <Route path=\":custSlug/\" element={<CustomerUpdateView />} />\n      <Route path=\"new/\" element={<CustomerCreateView />} />\n      <Route index element={<CustomerListView />} />\n    </Routes>\n  );\n}\n\nexport * from './types';\nexport * from './components';\nexport { CustomerForm } from './forms';\n"],"names":["CartItemDeleteButton","cartInstance","itemSlug","props","renderHeader","renderFooter","setOpen","className","onClick","destroyItem","then","r","onSuccess","catch","err","onError","render","getCN","CartDeleteButton","instance","label","destroy","res","handleDelete","ItemProductCard","product","size","ProductImage","width","height","truncateStr","name","inline","slug","style","src","cover_data","CartService","sizeSlug","this","post","_path","prodSlug","qty","values","timeout","delete","StaffService","Cart","data","StaffModel","ViewHeader","selected","title","text","actions","minHeight","paddingBottom","map","i","uuid","CartAddItemView","productRes","useProductListRequest","undefined","published","atc","React","setSelected","isOpen","products","Response","items","cartSizes","cart","zIndex","header","footer","disabled","length","sizes","filter","includes","checked","find","isChecked","Boolean","padding","minWidth","marginLeft","marginRight","type","onChange","CartUpdateView","cartSlug","useParams","useRequest","retrieve","refreshDeps","response","setRes","loading","isSuccess","back","border","CustomerCard","customer_data","retail_price_data","subtotal","console","log","size_data","ProductAddForm","item","onItemClick","form","useForm","quantity","is_oos","category_data","size_count","context","onSubmit","e","preventDefault","handleError","maxWidth","required","error","errors","max","min","first_name","last_name","email","phone","CustomerForm","children","onCustomerSelect","fields","getCustomerFD","export","sharedProps","fieldCN","allowSuggestions","fd","forEach","field","CustomerCreateView","CustomerUpdateView","CustomerListView","CustomerRoutes","path","element","index"],"sourceRoot":""}