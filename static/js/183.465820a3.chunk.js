"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[183],{1507:function(e,n,r){r.d(n,{CB:function(){return m},V5:function(){return v}});var i=r(8519),t=r(8312),s=(r(7497),r(5927)),o=r(4089),c=r(7719),l=r(9009),a=["instance","fields","children"],d=["onSuccess","onError","onWillSubmit"],u=["label","error"],m=function(e){var n=(0,o.cI)({name:""});return(0,l.jsxs)(x,{context:n,onSubmit:function(r){return r.preventDefault(),(0,c.D)().create(n.values).then((function(n){var r;return null===e||void 0===e||null===(r=e.onSuccess)||void 0===r?void 0:r.call(e,n)})).catch((function(r){var i;n.handleError(r),null===e||void 0===e||null===(i=e.onError)||void 0===i||i.call(e,r)}))},children:[(0,l.jsx)("div",{className:"",children:(0,l.jsx)(x.NameField,{error:n.errors.name})}),(0,l.jsx)("div",{className:"my-3",children:(0,l.jsx)(o.ZP.Submit,{value:"Save category",className:"btn btn-primary"})})]})},v=function(e){var n,r,o,c=e.instance,u=void 0===c?(0,s.q9)("Category instance"):c,m=e.fields,v=void 0===m?[]:m,h=e.children,p=(0,t.Z)(e,a),j=p.onSuccess,f=p.onError,b=p.onWillSubmit,g=(0,t.Z)(p,d),Z=g.context;return(0,l.jsxs)(x,(0,i.Z)((0,i.Z)({},g),{},{onSubmit:function(e){e.preventDefault(),null===b||void 0===b||b();var n={};return v.forEach((function(e){var r=Z.values[e];null!=r&&(n[e]=r)})),u.update(n).then((function(e){return null===j||void 0===j?void 0:j(e)})).catch((function(e){var n;return f?f(e):null===Z||void 0===Z||null===(n=Z.handleError)||void 0===n?void 0:n.call(Z,e)}))},children:[v.includes("name")&&(0,l.jsx)(x.NameField,{label:"Nom de la cat\xe9gorie",error:null===Z||void 0===Z||null===(n=Z.errors)||void 0===n?void 0:n.name,text:"Ajoutez un nom qui d\xe9crit cette cat\xe9gorie.\nNous recommandons 65 caract\xe8res au max."}),v.includes("description")&&(0,l.jsx)(x.DescriptionField,{label:"Description",error:null===Z||void 0===Z||null===(r=Z.errors)||void 0===r?void 0:r.description,text:"D\xe9crivez cet cat\xe9gorie."}),v.includes("position")&&(0,l.jsx)(x.PositionField,{label:"Position",error:null===Z||void 0===Z||null===(o=Z.errors)||void 0===o?void 0:o.position}),h]}))},x=function(e){return(0,l.jsx)(o.ZP,(0,i.Z)({},e))};x.NameField=function(e){return(0,l.jsx)(o.wd,(0,i.Z)((0,i.Z)({placeholder:"Entrez le nom de la cat\xe9gorie ..."},e),{},{required:!0}))},x.DescriptionField=function(e){return(0,l.jsx)(o.F$,(0,i.Z)({},e))},x.PositionField=function(e){var n=e.label,r=e.error,s=(0,t.Z)(e,u);return(0,l.jsx)(o.ZP.Field,{label:n,error:r,children:(0,l.jsx)(o.ZP.Text,(0,i.Z)({name:"position",type:"number",min:0},s))})}},9183:function(e,n,r){r.r(n),r.d(n,{default:function(){return b}});var i=r(8519),t=r(8312),s=r(6113),o=r(7497),c=r(866),l=r(4390),a=r(715),d=r(5927),u=r(265),m=r(4089),v=r(9309),x=r(4980),h=r(7719),p=r(1507),j=r(9009),f=["item"];function b(){var e=(0,c.s0)(),n=(0,l.lr)(),r=(0,s.Z)(n,1)[0].get("page"),i=(0,u.QT)((function(){return(0,h.D)().list({params:{page:r}})}),{refreshDeps:[r]}),t=i.res,m=i.updateItem,v=o.useState(!1),x=(0,s.Z)(v,2),f=x[0],b=x[1],Z=new d.HM(t);return Z.isSuccess?(0,j.jsxs)(a.ZP.View,{title:"Cat\xe9gories",back:"/staff/store/",actions:(0,j.jsx)(a.ZP.Button,{onClick:function(){return b(!f)},className:"btn-primary-3",title:"Add a new category",requiredPerms:["store.add_category"],children:"Ajouter"}),requiredPerms:["store.view_category"],children:[f&&(0,j.jsx)("div",{className:"miq-container center",children:(0,j.jsx)(a.ZP.Section,{title:"Add a category",requiredPerms:["store.add_category"],border:!0,children:(0,j.jsx)(p.CB,{onSuccess:function(n){var r=n.data;return e(r.slug)}})})}),0===Z.items.length&&!f&&(0,j.jsxs)("div",{className:"text-center p-staff-list-empty py-3 my-3",children:[(0,j.jsx)("p",{className:"fw-light text-md",children:"Ajouter une cat\xe9gorie pour commencer"}),(0,j.jsx)("div",{className:"my-4",children:(0,j.jsx)(a.ZP.Button,{onClick:function(){return b(!f)},requiredPerms:["store.add_category"],className:"btn btn-primary btn-md",children:"Add a category"})})]}),Z.items.sort((function(e,n){return e.position>n.position?1:-1})).map((function(e){return(0,j.jsx)(g,{item:e,onUpdate:function(e){m(e.data)}},e.slug)}))]}):null}function g(e){var n=e.item,r=(0,t.Z)(e,f),c=o.useState(!1),l=(0,s.Z)(c,2),d=l[0],u=l[1],b=(0,h.D)(n),g=(0,m.cI)({name:(null===b||void 0===b?void 0:b.name)||"",description:(null===b||void 0===b?void 0:b.description)||"",position:(null===b||void 0===b?void 0:b.position)||0});return(0,j.jsx)(v.vz,{border:!0,title:(0,j.jsxs)("div",{onClick:function(){return u(!d)},className:"d-flex align-items-center",children:[(0,j.jsx)("div",{style:{minWidth:48,width:48,height:48},children:(0,j.jsx)(a.ZP.Img.Square,(0,i.Z)((0,i.Z)({slug:"slug",src:"src"},b.cover_data),{},{className:"rounded"}))}),(0,j.jsxs)("div",{className:"ms-1",children:[(0,j.jsxs)("div",{className:"text-ellipsis",children:[(0,j.jsx)("span",{className:"me-1",children:g.values.name}),(0,j.jsx)(x.TK,{show:b.is_published})]}),(0,j.jsxs)("div",{className:"text-sm",children:[(0,j.jsxs)("span",{children:["Total: ",b.products_count," "]}),(0,j.jsxs)("span",{children:["(",b.published_count,"/",(0,j.jsx)("span",{className:"text-muted",children:b.draft_count}),")"]})]})]})]}),actions:(0,j.jsx)("div",{children:(0,j.jsx)(a.ZP.Link,{to:"".concat(b.slug,"/"),className:"btn btn-square btn-primary-3",requiredPerms:["store.change_category"],children:(0,j.jsx)(v.PJ.I8,{})})}),className:"mb-1",children:d&&(0,j.jsx)("div",{className:"",children:(0,j.jsx)(p.V5,{context:g,instance:b,fields:["name","description","position"],onSuccess:r.onUpdate,children:(0,j.jsx)("div",{className:"d-flex justify-content-center",children:(0,j.jsx)(m.ZP.Submit,{value:"Sauvegarder",className:"btn-primary-3 min-w-25"})})})})})}}}]);
//# sourceMappingURL=183.465820a3.chunk.js.map