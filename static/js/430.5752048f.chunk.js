"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[430],{6949:function(e,n,r){r.d(n,{CB:function(){return m},V5:function(){return v}});var t=r(8519),i=r(8312),s=(r(7497),r(5927)),o=r(4089),c=r(3788),a=r(9009),l=["instance","fields","children"],u=["onSuccess","onError","onWillSubmit"],d=["label","error"],m=function(e){var n=(0,o.cI)({name:""});return(0,a.jsxs)(h,{context:n,onSubmit:function(r){return r.preventDefault(),(0,c.D)().create(n.values).then((function(n){var r;return null===e||void 0===e||null===(r=e.onSuccess)||void 0===r?void 0:r.call(e,n)})).catch((function(r){var t;n.handleError(r),null===e||void 0===e||null===(t=e.onError)||void 0===t||t.call(e,r)}))},children:[(0,a.jsx)("div",{className:"",children:(0,a.jsx)(h.NameField,{error:n.errors.name})}),(0,a.jsx)("div",{className:"my-3",children:(0,a.jsx)(o.ZP.Submit,{value:"Save category",className:"btn btn-primary"})})]})},v=function(e){var n,r,o,c=e.instance,d=void 0===c?(0,s.q9)("Category instance"):c,m=e.fields,v=void 0===m?[]:m,p=e.children,x=(0,i.Z)(e,l),f=x.onSuccess,j=x.onError,b=x.onWillSubmit,g=(0,i.Z)(x,u),Z=g.context;return(0,a.jsxs)(h,(0,t.Z)((0,t.Z)({},g),{},{onSubmit:function(e){e.preventDefault(),null===b||void 0===b||b();var n={};return v.forEach((function(e){var r=Z.values[e];null!=r&&(n[e]=r)})),d.update(n).then((function(e){return null===f||void 0===f?void 0:f(e)})).catch((function(e){var n;return j?j(e):null===Z||void 0===Z||null===(n=Z.handleError)||void 0===n?void 0:n.call(Z,e)}))},children:[v.includes("name")&&(0,a.jsx)(h.NameField,{label:"Nom de la cat\xe9gorie",error:null===Z||void 0===Z||null===(n=Z.errors)||void 0===n?void 0:n.name,text:"Ajoutez un nom qui d\xe9crit cette cat\xe9gorie.\nNous recommandons 65 caract\xe8res au max."}),v.includes("description")&&(0,a.jsx)(h.DescriptionField,{label:"Description",error:null===Z||void 0===Z||null===(r=Z.errors)||void 0===r?void 0:r.description,text:"D\xe9crivez cet cat\xe9gorie."}),v.includes("position")&&(0,a.jsx)(h.PositionField,{label:"Position",error:null===Z||void 0===Z||null===(o=Z.errors)||void 0===o?void 0:o.position}),p]}))},h=function(e){return(0,a.jsx)(o.ZP,(0,t.Z)({},e))};h.NameField=function(e){return(0,a.jsx)(o.wd,(0,t.Z)((0,t.Z)({placeholder:"Entrez le nom de la cat\xe9gorie ..."},e),{},{required:!0}))},h.DescriptionField=function(e){return(0,a.jsx)(o.F$,(0,t.Z)({},e))},h.PositionField=function(e){var n=e.label,r=e.error,s=(0,i.Z)(e,d);return(0,a.jsx)(o.ZP.Field,{label:n,error:r,children:(0,a.jsx)(o.ZP.Text,(0,t.Z)({name:"position",type:"number",min:0},s))})}},4430:function(e,n,r){r.r(n),r.d(n,{StaffCategory:function(){return h.D},default:function(){return b}});var t=r(8519),i=r(8312),s=r(6113),o=r(7497),c=r(866),a=r(4390),l=r(715),u=r(5927),d=r(265),m=r(9309),v=r(4980),h=r(3788),p=r(6949),x=r(4089),f=r(9009),j=["item"];function b(){var e=(0,c.s0)(),n=(0,a.lr)(),r=(0,s.Z)(n,1)[0].get("page"),t=(0,d.QT)((function(){return(0,h.D)().list({params:{page:r}})}),{refreshDeps:[r]}),i=t.res,m=t.updateItem,v=o.useState(!1),x=(0,s.Z)(v,2),j=x[0],b=x[1],Z=new u.HM(i);return Z.isSuccess?(0,f.jsxs)(l.ZP.View,{title:"Cat\xe9gories",back:"/staff/store/",actions:(0,f.jsx)(l.ZP.Button,{onClick:function(){return b(!j)},className:"btn-primary-3",title:"Add a new category",requiredPerms:["store.add_category"],children:"Ajouter"}),requiredPerms:["store.view_category"],children:[j&&(0,f.jsx)("div",{className:"miq-container center",children:(0,f.jsx)(l.ZP.Section,{title:"Add a category",requiredPerms:["store.add_category"],border:!0,children:(0,f.jsx)(p.CB,{onSuccess:function(n){var r=n.data;return e(r.slug)}})})}),0===Z.items.length&&!j&&(0,f.jsxs)("div",{className:"text-center p-staff-list-empty py-3 my-3",children:[(0,f.jsx)("p",{className:"fw-light text-md",children:"Ajouter une cat\xe9gorie pour commencer"}),(0,f.jsx)("div",{className:"my-4",children:(0,f.jsx)(l.ZP.Button,{onClick:function(){return b(!j)},requiredPerms:["store.add_category"],className:"btn btn-primary btn-md",children:"Add a category"})})]}),Z.items.sort((function(e,n){return e.position>n.position?1:-1})).map((function(e){return(0,f.jsx)(g,{item:e,onUpdate:function(e){m(e.data)}},e.slug)}))]}):null}function g(e){var n=e.item,r=(0,i.Z)(e,j),c=o.useState(!1),a=(0,s.Z)(c,2),u=a[0],d=a[1],b=(0,h.D)(n),g=(0,x.cI)({name:(null===b||void 0===b?void 0:b.name)||"",description:(null===b||void 0===b?void 0:b.description)||"",position:(null===b||void 0===b?void 0:b.position)||0});return(0,f.jsx)(m.vz,{border:!0,title:(0,f.jsxs)("div",{onClick:function(){return d(!u)},className:"d-flex align-items-center",children:[(0,f.jsx)("div",{style:{minWidth:48,width:48,height:48},children:(0,f.jsx)(l.ZP.Img.Square,(0,t.Z)((0,t.Z)({slug:"slug",src:"src"},b.cover_data),{},{className:"rounded"}))}),(0,f.jsxs)("div",{className:"ms-1",children:[(0,f.jsxs)("div",{className:"text-ellipsis",children:[(0,f.jsx)("span",{className:"me-1",children:g.values.name}),(0,f.jsx)(v.TK,{show:b.is_published})]}),(0,f.jsxs)("div",{className:"text-sm",children:[(0,f.jsxs)("span",{children:["Total: ",b.products_count," "]}),(0,f.jsxs)("span",{children:["(",b.published_count,"/",(0,f.jsx)("span",{className:"text-muted",children:b.draft_count}),")"]})]})]})]}),actions:(0,f.jsx)("div",{children:(0,f.jsx)(l.ZP.Link,{to:"".concat(b.slug,"/"),className:"btn btn-square btn-primary-3",requiredPerms:["store.change_category"],children:(0,f.jsx)(m.PJ.I8,{})})}),className:"mb-1",children:u&&(0,f.jsx)("div",{className:"",children:(0,f.jsx)(p.V5,{context:g,instance:b,fields:["name","description","position"],onSuccess:r.onUpdate,children:(0,f.jsx)("div",{className:"d-flex justify-content-center",children:(0,f.jsx)(x.ZP.Submit,{value:"Sauvegarder",className:"btn-primary-3 min-w-25"})})})})})}},3788:function(e,n,r){r.d(n,{D:function(){return u}});var t=r(8519),i=r(1135),s=r(7411),o=r(2518),c=r(2485),a=r(715),l=function(e){(0,o.Z)(r,e);var n=(0,c.Z)(r);function r(){return(0,i.Z)(this,r),n.apply(this,arguments)}return(0,s.Z)(r,[{key:"publish",value:function(){return this.update({is_published:!0})}},{key:"unpublish",value:function(){return this.update({is_published:!1})}}]),r}(a.x5),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.dt_published;return n&&(n=new Date(n)),(0,a.eR)((0,t.Z)((0,t.Z)({},e),{},{dt_published:n}),"categories",l)}}}]);
//# sourceMappingURL=430.5752048f.chunk.js.map