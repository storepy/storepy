{"version":3,"file":"static/js/472.1cf8232f.chunk.js","mappings":"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","sources":["../../../../shopy/shopy-storejs/src/view.Index.tsx","../../../../.yarn/cache/@babel-runtime-npm-7.17.2-ec60bc114d-a48702d271.zip/node_modules/@babel/runtime/helpers/esm/toArray.js"],"sourcesContent":["import * as React from 'react';\nimport Staff from '@miq/staffjs';\n\nimport { Icons, Card, HorizontalScrollGridLayout, ViewSection } from '@miq/componentjs';\nimport { SharedDataCtx } from '@miq/contextjs';\n\nimport { getImgUrl, truncateStr, uuid } from '@miq/utiljs';\nimport { useDocumentTitle } from '@miq/hookjs';\n\nconst TopItemCard = (props: any) => {\n  const { data, top } = props;\n\n  return (\n    <div className=\"d-flex align-items-center\" title={`${data?.name}: ${data?.count}`}>\n      {data.img && (\n        <div className=\"bg-gray-100 rounded\" style={{ width: 48, maxWidth: 48 }}>\n          <img\n            src={getImgUrl(data.img)}\n            alt={truncateStr(data?.name, 0, 4)}\n            className=\"rounded\"\n            style={{ objectFit: 'cover', width: '100%', height: 'auto', aspectRatio: '1/1' }}\n          />\n        </div>\n      )}\n      {top && (\n        <div className=\"ms-1\">\n          <div className=\"text-ellipsis fw-bold\">{data?.name}</div>\n          <div className=\"text-muted text-sm\">{data?.count} vues</div>\n        </div>\n      )}\n    </div>\n  );\n};\nconst TopItemsCard = ({ hits = {}, itemKey = 'top_products', ...props }: any) => {\n  const { title = '' } = props;\n\n  const items = hits?.[itemKey] || [];\n  const [item, ...rest] = items;\n\n  return (\n    <ViewSection border text={title} mainCN=\"d-grid gap-2\">\n      {item && <TopItemCard top data={item} />}\n      <HorizontalScrollGridLayout className=\"mt-2\" style={{ gridAutoColumns: 'min-content', gap: 6 }}>\n        {rest && rest.map((data) => <TopItemCard data={data} key={uuid()} />)}\n      </HorizontalScrollGridLayout>\n    </ViewSection>\n  );\n};\n\nconst PerformanceCard = ({ hits = {}, ...props }: any) => {\n  const { views_count = 0, visitors_count = 0, sent_message = 0 } = hits;\n\n  return (\n    <Staff.Section title=\"Performance\">\n      <div className=\"d-grid gap-2 mb-3\">\n        <div className=\"\">Messages: {sent_message}</div>\n        <div className=\"\">Visitors: {visitors_count}</div>\n        <div className=\"\">Page views: {views_count}</div>\n      </div>\n\n      <div className=\"d-grid grid-md-2 gap-2\">\n        <TopItemsCard hits={hits} title=\"Top viewed products\" itemKey=\"top_products\" />\n        <TopItemsCard hits={hits} title=\"Top viewed categories\" itemKey=\"top_cats\" />\n      </div>\n    </Staff.Section>\n  );\n};\n\nexport default function ShopStaffIndexView() {\n  const ctx = React.useContext(SharedDataCtx);\n  useDocumentTitle('Store');\n\n  const { isLoaded, products, orders, cats, shopy_settings, hits = {} } = ctx;\n  if (!isLoaded) return null;\n\n  return (\n    <Staff.View\n      title=\"Commerce\"\n      className=\"no-bg\"\n      back=\"/staff/\"\n      actions={\n        <div className=\"d-flex\">\n          <Staff.NavLink to=\"notifications/\" className=\"btn btn-round btn-secondary-3\" title=\"Action needed\">\n            <Icons.Notification />\n          </Staff.NavLink>\n\n          <Staff.NavLink to=\"settings/\" className=\"btn btn-round btn-secondary-3\" title=\"Shop settings\">\n            <Icons.Adjustments />\n          </Staff.NavLink>\n        </div>\n      }\n    >\n      <Staff.Section>\n        <div className=\"d-grid grid-2 grid-sm-3 grid-md-4 grid-lg-6\">\n          {shopy_settings?.config?.has_suppliers && (\n            <CardLink\n              title=\"Supplier Orders\"\n              tab=\"./\"\n              link={{ to: 'orders/', text: 'View all orders', perms: ['store.view_supplierorder'] }}\n            >\n              <h3>{orders?.count || 0}</h3>\n            </CardLink>\n          )}\n\n          <CardLink\n            title=\"Products\"\n            tab=\"./?tab=products\"\n            link={{ to: 'products', text: 'View all products', perms: ['store.view_product'] }}\n          >\n            <h3>{products?.count || 0}</h3>\n          </CardLink>\n\n          <CardLink\n            tab=\"./?tab=categories\"\n            title=\"Categories\"\n            link={{ to: 'categories', text: 'View all categories', perms: ['store.view_category'] }}\n          >\n            <h3>{cats?.count || 0}</h3>\n          </CardLink>\n        </div>\n      </Staff.Section>\n\n      <PerformanceCard hits={hits} />\n\n      <Staff.Section title=\"Products by category\" className=\"my-2\">\n        {cats?.cat_count\n          ?.filter((i) => i.category__name)\n          ?.map(({ category__name, count }, i) => (\n            <div key={i}>\n              {category__name}: {count}\n            </div>\n          ))}\n      </Staff.Section>\n    </Staff.View>\n  );\n}\n\nconst CardLink: React.FC<{\n  title: string;\n  tab?: string;\n  link: { to: string; text: string; perms: string[] };\n}> = ({ children, title, link, tab = './' }) => {\n  const { to } = link;\n  return (\n    <div className=\"card-link mb-3\">\n      <Staff.NavLink to={tab}>\n        {title && <div className=\"card-link-title\">{title}</div>}\n        {children}\n      </Staff.NavLink>\n\n      <Staff.Link to={to} requiredPerms={link.perms}>\n        {link?.text && `${link.text} Â»`}\n      </Staff.Link>\n    </div>\n  );\n};\n","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _toArray(arr) {\n  return arrayWithHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableRest();\n}"],"names":["TopItemCard","props","data","top","className","title","name","count","img","style","width","maxWidth","src","getImgUrl","alt","truncateStr","objectFit","height","aspectRatio","TopItemsCard","arr","hits","itemKey","items","arrayWithHoles","iterableToArray","unsupportedIterableToArray","nonIterableRest","item","rest","border","text","mainCN","gridAutoColumns","gap","map","uuid","PerformanceCard","views_count","visitors_count","sent_message","ShopStaffIndexView","ctx","React","SharedDataCtx","useDocumentTitle","isLoaded","products","orders","cats","shopy_settings","back","actions","to","config","has_suppliers","CardLink","tab","link","perms","cat_count","filter","i","category__name","children","requiredPerms"],"sourceRoot":""}