"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[472],{472:function(e,t,i){i.r(t),i.d(t,{default:function(){return N}});var s=i(8519),n=i(6113),r=i(8129),l=i(5037),d=i(1036),o=i(9286);var a=i(8312),c=i(2411),u=i(9650),v=i(6676),m=i(9002),x=i(3896),h=i(9110),g=i(1408),j=i(8136),p=["hits","itemKey"],b=["settingSlug"],f=function(e){var t=e.data,i=e.top;return(0,j.jsxs)("div",{className:"d-flex align-items-center",title:"".concat(null===t||void 0===t?void 0:t.name,": ").concat(null===t||void 0===t?void 0:t.count),children:[t.img&&(0,j.jsx)("div",{className:"bg-gray-100 rounded",style:{width:48,maxWidth:48},children:(0,j.jsx)("img",{src:(0,x.wD)(t.img),alt:(0,x.bI)(null===t||void 0===t?void 0:t.name,0,4),className:"rounded",style:{objectFit:"cover",width:"100%",height:"auto",aspectRatio:"1/1"}})}),i&&(0,j.jsxs)("div",{className:"ms-1",children:[(0,j.jsx)("div",{className:"text-ellipsis fw-bold",children:null===t||void 0===t?void 0:t.name}),(0,j.jsxs)("div",{className:"text-muted text-sm",children:[null===t||void 0===t?void 0:t.count," vues"]})]})]})},_=function(e){var t=e.hits,i=void 0===t?{}:t,s=e.itemKey,n=void 0===s?"top_products":s,c=(0,a.Z)(e,p).title,u=void 0===c?"":c,m=(null===i||void 0===i?void 0:i[n])||[];if(!Boolean(m.length))return null;var h,g=(h=m,(0,r.Z)(h)||(0,l.Z)(h)||(0,d.Z)(h)||(0,o.Z)()),b=g[0],_=g.slice(1);return(0,j.jsxs)(v.vz,{border:!0,text:u,mainCN:"d-grid gap-2",children:[b&&(0,j.jsx)(f,{top:!0,data:b}),(0,j.jsx)(v.j6,{className:"mt-2",style:{gridAutoColumns:"min-content",gap:6},children:_&&_.map((function(e){return(0,j.jsx)(f,{data:e},(0,x.Vj)())}))})]})},y=function(e){var t=e.settingSlug,i=((0,a.Z)(e,b),(0,g.lr)()),r=(0,n.Z)(i,2),l=r[0],d=r[1],o=l.get("__range"),c=(0,h.QT)((function(){return u.bl.get("shopy-analytics/".concat(t,"/summary/"),{params:l})}),{refreshDeps:[o]}),m=c.res;if(c.loading)return(0,j.jsx)(v.gb,{});var p=new x.HM(m);if(!p.isSuccess)return null;var f=null===p||void 0===p?void 0:p.data,y=f.views_count,N=void 0===y?0:y,k=f.visitors_count,Z=void 0===k?0:k,w=f.sent_message,P=void 0===w?0:w;return(0,j.jsxs)(u.ZP.Section,{title:"Performance",actions:(0,j.jsxs)("div",{className:"d-flex",children:[(0,j.jsx)(v.zx,{onClick:function(){return d((0,s.Z)((0,s.Z)({},l),{},{__range:"today"}))},className:(0,x.UT)(["btn me-1","today"===o&&"btn-primary"]),children:"Today"}),(0,j.jsx)(v.zx,{onClick:function(){return d((0,s.Z)((0,s.Z)({},l),{},{__range:"week"}))},className:(0,x.UT)(["btn me-1","week"===o&&"btn-primary"]),children:"Week"}),(0,j.jsx)(v.zx,{onClick:function(){return d((0,s.Z)((0,s.Z)({},l),{},{__range:"month"}))},className:(0,x.UT)(["btn me-1","month"===o&&"btn-primary"]),children:"Month"}),(0,j.jsx)(v.zx,{onClick:function(){l.delete("__range"),d((0,s.Z)({},l))},className:(0,x.UT)(["btn me-1",!o&&"btn-primary"]),children:"All"})]}),children:[(0,j.jsxs)("div",{className:"d-grid gap-2 mb-3",children:[(0,j.jsxs)("div",{className:"",children:["Messages: ",P]}),(0,j.jsxs)("div",{className:"",children:["Visitors: ",Z]}),(0,j.jsxs)("div",{className:"",children:["Page views: ",N]})]}),(0,j.jsxs)("div",{className:"d-grid grid-md-2 gap-2",children:[(0,j.jsx)(_,{hits:null===p||void 0===p?void 0:p.data,title:"Top viewed products",itemKey:"top_products"}),(0,j.jsx)(_,{hits:null===p||void 0===p?void 0:p.data,title:"Top viewed categories",itemKey:"top_cats"})]})]})};function N(){var e,t,i;(0,h.jr)("Store");var s=c.useContext(m.h2),n=s.isLoaded,r=s.products,l=s.orders,d=s.cats,o=s.shopy_settings,a=s.site,x=(void 0===a?{}:a).settings;return n?(0,j.jsxs)(u.ZP.View,{title:"Commerce",className:"no-bg",back:"/staff/",actions:(0,j.jsxs)("div",{className:"d-flex",children:[(0,j.jsx)(u.ZP.NavLink,{to:"notifications/",className:"btn btn-round btn-secondary-3",title:"Action needed",children:(0,j.jsx)(v.PJ.P_,{})}),(0,j.jsx)(u.ZP.NavLink,{to:"settings/",className:"btn btn-round btn-secondary-3",title:"Shop settings",children:(0,j.jsx)(v.PJ.lk,{})})]}),children:[(0,j.jsx)(u.ZP.Section,{children:(0,j.jsxs)("div",{className:"d-grid grid-2 grid-sm-3 grid-md-4 grid-lg-6",children:[(null===o||void 0===o||null===(e=o.config)||void 0===e?void 0:e.has_suppliers)&&(0,j.jsx)(k,{title:"Supplier Orders",tab:"./",link:{to:"orders/",text:"View all orders",perms:["store.view_supplierorder"]},children:(0,j.jsx)("h3",{children:(null===l||void 0===l?void 0:l.count)||0})}),(0,j.jsx)(k,{title:"Products",tab:"./?tab=products",link:{to:"products",text:"View all products",perms:["store.view_product"]},children:(0,j.jsx)("h3",{children:(null===r||void 0===r?void 0:r.count)||0})}),(0,j.jsx)(k,{tab:"./?tab=categories",title:"Categories",link:{to:"categories",text:"View all categories",perms:["store.view_category"]},children:(0,j.jsx)("h3",{children:(null===d||void 0===d?void 0:d.count)||0})})]})}),x&&(0,j.jsx)(y,{settingSlug:x}),(0,j.jsx)(u.ZP.Section,{title:"Products by category",className:"my-2",children:null===d||void 0===d||null===(t=d.cat_count)||void 0===t||null===(i=t.filter((function(e){return e.category__name})))||void 0===i?void 0:i.map((function(e,t){var i=e.category__name,s=e.count;return(0,j.jsxs)("div",{children:[i,": ",s]},t)}))})]}):null}var k=function(e){var t=e.children,i=e.title,s=e.link,n=e.tab,r=void 0===n?"./":n,l=s.to;return(0,j.jsxs)("div",{className:"card-link mb-3",children:[(0,j.jsxs)(u.ZP.NavLink,{to:r,children:[i&&(0,j.jsx)("div",{className:"card-link-title",children:i}),t]}),(0,j.jsx)(u.ZP.Link,{to:l,requiredPerms:s.perms,children:(null===s||void 0===s?void 0:s.text)&&"".concat(s.text," \xbb")})]})}}}]);
//# sourceMappingURL=472.6dc48fc8.chunk.js.map