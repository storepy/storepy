"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[484],{7494:function(e,n,t){t.d(n,{n:function(){return u},q:function(){return o}});var i=t(4384),s=t(3872),r=(t(7406),t(5789)),l=t(810),c=t(3088),a=t(7457),d=["product","width","height"],u=function(e){var n=e.product,t=e.size;return(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[(0,a.jsx)(o,{product:n,width:60,height:60}),(0,a.jsxs)("div",{className:"flex-1 rounded p-1 ",children:[(0,a.jsx)("div",{className:"fw-bold",children:(0,l.bI)(null===n||void 0===n?void 0:n.name,0,25)}),(0,a.jsx)(c._S,(0,s.Z)((0,s.Z)({},n),{},{inline:!0})),t&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"me-1",children:"Size:"}),(0,a.jsx)("span",{className:"text-sm",children:null===t||void 0===t?void 0:t.name})]})]})]})},o=function(e){var n=e.product,t=e.width,l=e.height,c=(0,i.Z)(e,d);return null!==n&&void 0!==n&&n.slug?(0,a.jsx)("div",(0,s.Z)((0,s.Z)({},c),{},{style:{width:t,height:l},children:(0,a.jsx)(r.ZP.Img.Square,(0,s.Z)((0,s.Z)({slug:"slug",src:"src"},n.cover_data),{},{className:"rounded"}))})):null}},474:function(e,n,t){t.d(n,{A:function(){return o}});var i=t(3872),s=t(5561),r=t(1253),l=t(4733),c=t(2562),a=t(5789),d=5e3,u=function(e){(0,l.Z)(t,e);var n=(0,c.Z)(t);function t(){return(0,s.Z)(this,t),n.apply(this,arguments)}return(0,r.Z)(t,[{key:"canDestroy",get:function(){var e,n;return 0===(null===this||void 0===this||null===(e=this.data)||void 0===e||null===(n=e.products)||void 0===n?void 0:n.length)}},{key:"place",value:function(){return this.post("".concat(this._path,"place/"),{},{timeout:d})}},{key:"addItems",value:function(e){return this.post("".concat(this._path,"products/"),e)}},{key:"addItem",value:function(e,n){return this.post("".concat(this._path,"product/").concat(e,"/"),n)}},{key:"updateItem",value:function(e,n){return this.post("".concat(this._path,"item/").concat(e,"/"),(0,i.Z)({},n),{timeout:d})}},{key:"destroyItem",value:function(e){return this.delete("".concat(this._path,"item/").concat(e,"/"),{timeout:d})}}]),t}(a.x5),o=(0,a.QY)("carts",u)},8484:function(e,n,t){t.r(n),t.d(n,{ProductAddForm:function(){return w},default:function(){return y}});var i=t(4384),s=t(3872),r=t(2551),l=t(7406),c=t(3041),a=t(5789),d=t(9474),u=t(2050),o=t(9576),h=t(810),m=t(3088),x=t(474),v=t(7494),f=t(5880),j=t(7457),p=function(e){var n=e.setOpen,t=e.selected,i=void 0===t?[]:t;return(0,j.jsxs)("div",{className:"cart-add-item-view-header miq-container center px-1 pt-2",children:[(0,j.jsx)(u.M$,{title:(0,j.jsx)("span",{className:"fw-bold mt-2",children:"Ajouter des produits"}),text:"Tap on a product to add to the cart/ Cliquez sur un produit pour l'ajouter au panier",actions:(0,j.jsx)("div",{onClick:function(){return null===n||void 0===n?void 0:n(!1)},children:" [ x ]"})}),(0,j.jsx)(u.j6,{className:"cart-items-preview",style:{minHeight:48,paddingBottom:0},children:i.map((function(e){return(0,j.jsx)("div",{children:(0,j.jsx)(v.q,{product:e,width:48,height:48})},(0,h.Vj)())}))})]})};function g(e){var n,t=(0,m._P)({},{atc:"1"}),i=t.res,c=t.loading,o=l.useState([]),x=(0,r.Z)(o,2),g=x[0],b=x[1];if(!e.isOpen)return null;if(c)return(0,j.jsx)(u.gb,{});var N=new d.F6(i).items||[],Z=e.cart,y=(null===Z||void 0===Z||null===(n=Z.items)||void 0===n?void 0:n.map((function(e){return e.size})))||[];return(0,j.jsx)(u.cv,{style:{zIndex:1e4},className:"bg-white m-1 rounded",header:(0,j.jsx)(p,(0,s.Z)((0,s.Z)({},e),{},{selected:g})),footer:(0,j.jsx)("div",{className:"miq-container center",children:(0,j.jsxs)("div",{className:"d-flex justify-content-between bg-white p-2",children:[(0,j.jsx)("div",{children:(0,j.jsx)(u.zx,{onClick:function(){return e.setOpen(!1)},className:"",children:"Annuler"})}),(0,j.jsx)("div",{children:(0,j.jsx)(u.zx,{disabled:0===g.length,onClick:function(){return function(){var n=g.map((function(e){return{product_slug:e.meta_slug,size:e.sizeSlug,quantity:1}}));0!==n.length&&Z.addItems(n).then((function(n){var t;b([]),null===e||void 0===e||null===(t=e.onSuccess)||void 0===t||t.call(e,n)})).catch((function(n){var t;return null===e||void 0===e||null===(t=e.onError)||void 0===t?void 0:t.call(e,n)}))}()},className:"btn-primary fw-bold",children:"Ajouter"})})]})}),children:(0,j.jsx)(a.ZP.Section,{header:(0,j.jsx)(m.ir,{fields:[]}),className:"miq-container center px-1",children:N.map((function(e){var n=e.sizes;return(void 0===n?[]:n).filter((function(e){return e.quantity>=1})).filter((function(e){return!y.includes(e.slug)})).map((function(n){var t=g.find((function(e){return e.sizeSlug===(null===n||void 0===n?void 0:n.slug)})),i=Boolean(t);return(0,j.jsxs)("div",{className:"d-flex align-items-center mb-1 border-1 rounded",style:{padding:6},onClick:function(){b(i?function(e){return e.filter((function(e){return e.sizeSlug!=(null===n||void 0===n?void 0:n.slug)}))}:[(0,s.Z)((0,s.Z)({},e),{},{sizeSlug:n.slug})].concat((0,f.Z)(g)))},children:[(0,j.jsx)("div",{className:"flex-1",children:(0,j.jsx)(v.n,{product:e,size:n})}),(0,j.jsx)("div",{style:{minWidth:24,marginLeft:3,marginRight:6},children:(0,j.jsx)("input",{type:"checkbox",name:"selected",className:"me-2",checked:i,onChange:function(){}})})]},(0,h.Vj)())}))}))})})}var b=t(7532),N=t(2444),Z=["item","onItemClick"];function y(){var e,n,t;(0,d.jr)("Add items to cart - Sales");var i=(0,c.UO)().cartSlug,o=(0,d.QT)((function(){return(0,x.A)({slug:i}).retrieve()}),{refreshDeps:[i],onError:function(e){e.response}}),f=o.res,p=o.setRes,Z=o.loading,y=l.useState(!1),w=(0,r.Z)(y,2),S=w[0],_=w[1],z=new d.HM(f);if(!z.isSuccess)return null;if(Z)return(0,j.jsx)(u.gb,{});var k=(0,x.A)(z.data||{});return(0,j.jsxs)(a.ZP.View,{title:"Ajouter au panier",back:"/staff/sales/carts",children:[(0,j.jsx)("pre",{children:JSON.stringify(k.export(),null,2)}),(0,j.jsxs)("div",{className:"miq-container center",children:[(0,j.jsx)(a.ZP.Section,{border:!0,title:"Panier (".concat(null===k||void 0===k||null===(e=k.products)||void 0===e?void 0:e.length," produits)"),actions:(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(u.zx,{onClick:function(){return _(!0)},className:"btn-primary-3 btn-round",title:"Ajouter des produits",children:(0,j.jsx)(u.PJ.HB,{})})}),footer:(0,j.jsxs)("div",{className:"",children:[(0,j.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,j.jsx)("span",{className:"",children:"Subtotal"}),(0,j.jsx)("span",{children:(0,j.jsx)(m._S,{retail_price_data:null===k||void 0===k?void 0:k.subtotal})})]}),(0,j.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,j.jsx)("span",{className:"",children:"Total"}),(0,j.jsx)("span",{className:"fw-bold",children:(0,j.jsx)(m._S,{retail_price_data:null===k||void 0===k?void 0:k.subtotal})})]})]}),children:k&&(null===k||void 0===k||null===(n=k.items)||void 0===n?void 0:n.length)>0?(0,j.jsx)(j.Fragment,{children:null===(t=k.items)||void 0===t?void 0:t.map((function(e){return(0,j.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,j.jsx)(v.n,(0,s.Z)((0,s.Z)({},e),{},{size:e.size_data})),(0,j.jsx)("div",{children:(0,j.jsx)(b.uf,{cartInstance:k,itemSlug:null===e||void 0===e?void 0:e.slug,onSuccess:function(e){return p(e)}})})]},(0,h.Vj)())}))}):(0,j.jsx)(j.Fragment,{children:"Ajouter"})}),(0,j.jsx)(a.ZP.Section,{border:!0,title:"Client",children:(0,j.jsx)(N.CustomerCard,{data:k.customer_data})}),(0,j.jsx)("div",{className:"text-center",children:(0,j.jsx)(u.zx,{onClick:function(){k.place().then((function(e){p(e)})).catch((function(e){return console.log(e)}))},disabled:k.products.length<=0,className:"btn-primary btn-md fw-bold w-50",children:"Confirmer"})})]}),S&&(0,j.jsx)(g,{isOpen:S,setOpen:_,cart:k,onSuccess:function(e){p(e),_(!1)}})]})}var w=function(e){var n,t=e.item,r=e.onItemClick,l=((0,i.Z)(e,Z),(0,o.cI)({quantity:1,size:""}));if(null===t||void 0===t||!t.slug)return null;var c=t.sizes,d=void 0===c?[]:c,u=(t.is_oos,t.cover_data),x=t.name;t.size_count;return(0,j.jsx)(o.ZP,{context:l,onSubmit:function(e){e.preventDefault(),r(t,l.values.size,l.values.quantity).catch((function(e){l.handleError(e)}))},children:(0,j.jsx)(a.ZP.Section,{border:!0,header:(0,j.jsxs)("div",{className:"d-flex",children:[(0,j.jsx)("div",{style:{minWidth:34,maxWidth:50},className:"me-1",children:(0,j.jsx)(a.ZP.Img.Thumb,(0,s.Z)((0,s.Z)({src:"src"},u),{},{className:"rounded"}))}),(0,j.jsxs)("div",{className:"flex-1",title:x,children:[(0,j.jsx)("div",{className:"text-ellipsis text-sm",children:(0,j.jsx)("span",{className:"me-1 fw-bold",children:(0,h.bI)(x,0,45)})}),(0,j.jsxs)("div",{className:"d-flex flex-column flex-md-ro justify-content-between",children:[(0,j.jsxs)("div",{className:"d-grid grid-md-2 gap-1 flex-1",children:[(0,j.jsx)(m.D8,{required:!0,sizes:d.filter((function(e){return e.quantity>0})),error:l.errors.size}),(0,j.jsx)(m.PI,{max:(null===(n=d.find((function(e){return e.slug===l.values.size})))||void 0===n?void 0:n.quantity)||0,min:1})]}),(0,j.jsx)("div",{className:"text-right",children:(0,j.jsx)(o.ZP.Submit,{className:"btn btn-primary-2 btn-md fw-bold",children:"Ajouter"})})]})]})]}),actions:(0,j.jsx)(m._S,(0,s.Z)((0,s.Z)({},t),{},{className:"d-flex flex-wrap"})),className:"mb-1"})})}}}]);
//# sourceMappingURL=484.fc7cc8d8.chunk.js.map