{"version":3,"file":"static/js/494.7205d97f.chunk.js","mappings":"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","sources":["../../../../shopy/shopy-storejs/src/IndexView.tsx"],"sourcesContent":["import * as React from 'react';\nimport Staff from '@miq/staffjs';\n\nimport { Icons } from '@miq/componentjs';\nimport { SharedDataCtx } from '@miq/contextjs';\nimport { useSearchParams } from 'react-router-dom';\nimport { useHitListRequest, hitsByPath } from '@miq/staffjs';\nimport { Response } from '@miq/utiljs';\n\nconst TopViewsSection = () => {\n  const { res } = useHitListRequest('/shop/');\n\n  const r = new Response(res);\n  if (!r.isSuccess) return null;\n\n  const paths = hitsByPath(r.items);\n\n  return (\n    <Staff.Section title=\"Top Views\" text=\"This data is based on the last 100 hits.\" className=\"my-2\">\n      {Object.entries(paths)\n        .sort((a, b) => (a?.[1].length > b?.[1].length ? -1 : 1))\n        .map((i) => {\n          const [path, hits] = i;\n          const { session_data } = hits.find((i) => i.session_data) || {};\n          const { name, img } = session_data;\n\n          return (\n            <Staff.Section\n              title={\n                <div className=\"text-sm\">\n                  {name && <div className=\"\">{session_data?.name}</div>}\n                  <div className=\"fw-normal text-muted\">{path}</div>\n                </div>\n              }\n              actions={\n                <div>\n                  {img && (\n                    <div style={{ maxWidth: 20 }}>\n                      <Staff.Img.Image {...{ src: img }} className=\"rounded\" />\n                    </div>\n                  )}\n                </div>\n              }\n              border\n              className=\"mb-1\"\n              key={path}\n            />\n          );\n        })}\n    </Staff.Section>\n  );\n};\n\nexport default function ShopStaffIndexView() {\n  const ctx = React.useContext(SharedDataCtx);\n  const { isLoaded, products, orders, cats, shopy_settings } = ctx as any;\n  const [params] = useSearchParams();\n\n  const tab = params.get('tab');\n\n  if (!isLoaded) return null;\n\n  return (\n    <Staff.View\n      title=\"Shop\"\n      back=\"/staff/\"\n      actions={\n        <Staff.NavLink to=\"settings/\" className=\"btn btn-round btn-secondary-3\" title=\"Shop settings\">\n          <Icons.Gear />\n        </Staff.NavLink>\n      }\n    >\n      <Staff.Section>\n        <div className=\"d-grid grid-2 grid-sm-3 grid-md-4 grid-lg-6\">\n          {shopy_settings?.config?.has_suppliers && (\n            <CardLink\n              title=\"Supplier Orders\"\n              tab=\"./\"\n              link={{ to: 'orders/', text: 'View all orders', perms: ['store.view_supplierorder'] }}\n            >\n              <h3>{orders?.count || 0}</h3>\n            </CardLink>\n          )}\n\n          <CardLink\n            title=\"Products\"\n            tab=\"./?tab=products\"\n            link={{ to: 'products', text: 'View all products', perms: ['store.view_product'] }}\n          >\n            <h3>{products?.count || 0}</h3>\n          </CardLink>\n\n          <CardLink\n            tab=\"./?tab=categories\"\n            title=\"Categories\"\n            link={{ to: 'categories', text: 'View all categories', perms: ['store.view_category'] }}\n          >\n            <h3>{cats?.count || 0}</h3>\n          </CardLink>\n        </div>\n      </Staff.Section>\n\n      <TopViewsSection />\n\n      <Staff.Section title=\"Top Categories\" className=\"my-2\">\n        {cats?.cat_count\n          ?.filter((i) => i.category__name)\n          ?.map(({ category__name, count }, i) => (\n            <div key={i}>\n              {category__name}: {count}\n            </div>\n          ))}\n      </Staff.Section>\n    </Staff.View>\n  );\n}\n\nconst CardLink: React.FC<{\n  title: string;\n  tab?: string;\n  link: { to: string; text: string; perms: string[] };\n}> = ({ children, title, link, tab = './' }) => {\n  const { to } = link;\n  return (\n    <div className=\"card-link mb-3\">\n      <Staff.NavLink to={tab}>\n        {title && <div className=\"card-link-title\">{title}</div>}\n        {children}\n      </Staff.NavLink>\n\n      <Staff.Link to={to} requiredPerms={link.perms}>\n        {link?.text && `${link.text} Â»`}\n      </Staff.Link>\n    </div>\n  );\n};\n"],"names":["TopViewsSection","res","useHitListRequest","r","Response","isSuccess","paths","hitsByPath","items","title","text","className","Object","entries","sort","a","b","length","map","i","path","find","session_data","name","img","actions","style","maxWidth","src","border","ShopStaffIndexView","React","SharedDataCtx","isLoaded","products","orders","cats","shopy_settings","useSearchParams","get","back","to","config","has_suppliers","CardLink","tab","link","perms","count","cat_count","filter","category__name","children","requiredPerms"],"sourceRoot":""}