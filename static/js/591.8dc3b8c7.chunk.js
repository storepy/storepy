"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[591],{2591:function(e,t,n){n.r(t),n.d(t,{default:function(){return N}});var r=n(8312),i=n(6113),a=n(8519),s=(n(7497),n(4390)),l=n(866),c=n(243),o=n(715),u=n(4089),d=n(265),m=n(9309),x=n(5927),p=n(3830),v=n(6012),f=n(4980),j=n(2456),b=n(208),h=n(9009),g=["res","setRes","loading"],_=function(e){return window.i18n(c.Z,e)},Z=[].concat(["name","category","description","retail_price","is_pre_sale","is_pre_sale_text","is_pre_sale_dt","is_oos","is_on_sale","sale_price","is_explicit"],["cost","color_group_pk","stage"],["supplier_name","supplier_item_id","supplier_item_sn","supplier_item_category","supplier_item_url","supplier_item_cost","supplier_item_cost_currency","supplier_order_id"],["meta_title","meta_description","meta_slug"]),S={retail_price:0,is_pre_sale:!1,sale_price:0,is_on_sale:!1,is_published:!1},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};return Z.forEach((function(n){var r,i=null===e||void 0===e?void 0:e[n];null!=i?t[n]=i:t[n]=null!==(r=S[n])&&void 0!==r?r:""})),(0,a.Z)((0,a.Z)({},S),t)};function N(e){var t,n=e.back,c=(0,l.UO)().prodSlug,_=(0,s.lr)(),Z=(0,i.Z)(_,1)[0],S=(0,l.s0)(),N=(0,u.cI)(w()),y=(0,d.QT)((function(){return(0,v.Z)({slug:c}).retrieve()}),{refreshDeps:[c],onSuccess:function(e){var t=e.data;document.title="".concat(null===t||void 0===t?void 0:t.name," - Update product"),N.setValues(w(t))},onError:function(e){var t=e.response;if(404===(null===t||void 0===t?void 0:t.status))return S("../")}}),I=y.res,T=y.setRes,F=y.loading,k=(0,r.Z)(y,g),A=new x.HM(I);if(!A.isSuccess)return null;if(F)return(0,h.jsx)(m.gb,{});var C=(0,v.Z)(A.data),E=function(e){k.updateData(e),p.u.update(e)},D=Z.get("tab"),L={instance:C,form:N,setRes:T,onUpdate:E,navigate:S,back:n,params:Z,tab:D,categories:null===A||void 0===A||null===(t=A.data)||void 0===t?void 0:t.categories};return(0,h.jsx)(o.ZP.View,{className:"product-staff-update-view",requiredPerms:["store.change_product"],title:(0,h.jsx)(b.wP,{data:(0,a.Z)({},C.export())}),back:"".concat((0,x.Xs)(n)).concat("".concat(Z)?"?".concat(Z):""),children:(0,h.jsx)(o.ZP.Section,{title:(0,h.jsx)("div",{className:"mb-1",children:P}),actions:C.is_published?(0,h.jsx)(f.Ko,{instance:C,onSuccess:function(e){var t=e.data;return E(t)},children:"D\xe9publier"}):(0,h.jsx)(f.H5,{instance:C,onSuccess:function(e){var t=e.data;return E(t)},onError:function(e){return N.handleError(e)},children:"Publier"}),children:function(){switch(D){case"inventory":return(0,h.jsx)(j.W2,(0,a.Z)({},L));case"settings":return(0,h.jsx)(j.CW,(0,a.Z)({},L));case"media":return(0,h.jsx)(j.EJ,(0,a.Z)({},L));default:return(0,h.jsx)(j.wQ,(0,a.Z)({},L))}}()})})}var P=(0,h.jsxs)("div",{className:"query-buttons",children:[(0,h.jsx)(m.$Q,{index:!0,target:"tab",className:"btn-md",children:"Info"}),(0,h.jsx)(m.$Q,{target:"tab",value:"media",className:"btn-md",children:_("MediaTab.title")}),(0,h.jsx)(m.$Q,{target:"tab",value:"inventory",className:"btn-md",children:_("InventoryTab.title")}),(0,h.jsx)(m.$Q,{target:"tab",value:"settings",className:"btn-md",children:_("SettingsTab.title")})]})},2456:function(e,t,n){n.d(t,{wQ:function(){return F},W2:function(){return k},EJ:function(){return C},CW:function(){return A},ex:function(){return E}});var r=n(8312),i=n(8519),a=n(6113),s=n(7497),l=n(243),c=n(761),o=n(715),u=n(9309),d=n(4089),m=n(4024),x=n(974),p=n(9009),v=["data","productInstance"],f=["productInstance"],j=["label","text","error","placeholder"],b=["label","text","error","placeholder"],h=["data","productInstance"],g=["onSuccess","onError"],_=function(e){var t=e.data,n=e.productInstance,i=(0,r.Z)(e,v),a=(0,d.cI)({name:t.name||"",value:t.value||""});if(null===t||void 0===t||!t.slug||null===n||void 0===n||!n.slug)return null;var s=i.onSuccess,l=i.onError;return(0,p.jsx)(d.ZP,{context:a,onSubmit:function(e){e.preventDefault(),n.patchAttribute(t.slug,a.values).then((function(e){return null===s||void 0===s?void 0:s(e)})).catch((function(e){return a.handleError(e),null===l||void 0===l?void 0:l(e)}))},children:(0,p.jsxs)("div",{className:"d-grid grid-md-6 gap-1",children:[(0,p.jsx)("div",{className:"span-md-2",children:(0,p.jsx)(w,{error:a.errors.name})}),(0,p.jsx)("div",{className:"span-md-3",children:(0,p.jsx)(N,{error:a.errors.value,className:""})}),(0,p.jsxs)("div",{className:"span-md-1",children:[(0,p.jsx)(d.ZP.Submit,{value:"Save",className:"btn-primary-2 me-2"}),(0,p.jsx)(P,{productInstance:n,data:t,onSuccess:s,onError:l})]})]})})},Z={name:"",value:""},S=function(e){var t=e.productInstance,n=(0,r.Z)(e,f),i=(0,d.cI)(Z);return null!==t&&void 0!==t&&t.slug?(0,p.jsx)(d.ZP,{context:i,onSubmit:function(e){e.preventDefault(),t.postAttribute(i.values).then((function(e){var t;return i.setValues(Z),null===n||void 0===n||null===(t=n.onSuccess)||void 0===t?void 0:t.call(n,e)})).catch((function(e){var t;return i.handleError(e),null===n||void 0===n||null===(t=n.onError)||void 0===t?void 0:t.call(n,e)}))},children:(0,p.jsxs)("div",{className:"d-grid grid-md-6 gap-1",children:[(0,p.jsx)("div",{className:"span-md-2",children:(0,p.jsx)(w,{error:i.errors.name})}),(0,p.jsx)("div",{className:"span-md-3",children:(0,p.jsx)(N,{error:i.errors.value,className:""})}),(0,p.jsx)("div",{className:"span-md-1",children:(0,p.jsx)(d.ZP.Submit,{value:"Save",className:"btn-primary-2"})})]})}):null},w=function(e){var t=e.label,n=e.text,a=e.error,s=e.placeholder,l=void 0===s?"Entrez le nom de l'attribut ...":s,c=(0,r.Z)(e,j);return(0,p.jsx)(d.ZP.Field,{label:t,text:n,error:a,children:(0,p.jsx)(d.ZP.Text,(0,i.Z)((0,i.Z)({},c),{},{required:!0,name:"name",placeholder:l,maxLength:30,minLength:2}))})},N=function(e){var t=e.label,n=e.text,a=e.error,s=e.placeholder,l=void 0===s?"Entrez la valuer de l'attribut ...":s,c=(0,r.Z)(e,b);return(0,p.jsx)(d.ZP.Field,{label:t,text:n,error:a,children:(0,p.jsx)(d.ZP.Text,(0,i.Z)((0,i.Z)({},c),{},{required:!0,name:"value",placeholder:l,maxLength:99,minLength:2}))})},P=function(e){var t=e.data,n=e.productInstance,a=(0,r.Z)(e,h);if(null===t||void 0===t||!t.slug||null===n||void 0===n||!n.slug)return null;var s=a.onSuccess,l=a.onError,c=(0,r.Z)(a,g);return(0,p.jsx)(u.pu,(0,i.Z)((0,i.Z)({},c),{},{renderHeader:function(){return(0,p.jsx)("div",{children:"Supprimer un attribut"})},renderFooter:function(e){var r=e.setOpen;return(0,p.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,p.jsx)(u.zx,{onClick:function(){return r(!1)},children:"Annuler"}),(0,p.jsx)(u.zx,{onClick:function(){return n.deleteAttribute(t.slug).then((function(e){return r(!1),null===s||void 0===s?void 0:s(e)})).catch((function(e){return null===l||void 0===l?void 0:l(e)}))},className:"btn-danger",children:"Supprimer"})]})},render:function(){return(0,p.jsxs)("div",{className:"p-3",children:["Are you sure you want to delete this attribute:",(0,p.jsx)("div",{className:"fw-bold",children:t.name})]})},className:"attr-delete-button btn-danger-3",children:(0,p.jsx)(u.PJ.rF,{})}))},y=n(8876),I=["img","actions"],T=function(e){return window.i18n(l.Z,e)},F=function(e){var t=e.form,n=e.instance,r=e.categories,i=e.onUpdate,a=t.errors,s=(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(x.HG.NameField,{error:a.name,label:window.i18n(c.Z,"NField.label"),text:window.i18n(c.Z,"NField.text")}),(0,p.jsxs)("div",{className:"d-grid grid-md-2 gap-1",children:[(0,p.jsx)(x.HG.CategoryField,{error:a.category,categories:r,label:window.i18n(c.Z,"CatField.label")}),(0,p.jsx)(x.HG.RetailPriceField,{label:window.i18n(c.Z,"RetailPField.label"),error:a.retail_price})]}),(0,p.jsx)(x.HG.PresaleCheckboxField,{error:a.is_pre_sale,label:window.i18n(c.Z,"PresaleField.label")}),t.values.is_pre_sale&&(0,p.jsx)(x.HG.PresaleTextField,{text:window.i18n(c.Z,"PresaleTextField.text"),error:a.is_pre_sale_text}),(0,p.jsx)(x.HG.OnSaleCheckboxField,{error:a.is_on_sale,label:window.i18n(c.Z,"OnsaleField.label")}),t.values.is_on_sale&&(0,p.jsx)(x.HG.SalePriceField,{label:window.i18n(c.Z,"SalePField.label"),error:a.sale_price}),(0,p.jsx)(x.HG.DescriptionField,{error:a.description,label:window.i18n(c.Z,"DField.label"),text:window.i18n(c.Z,"DField.text")}),(0,p.jsx)("div",{className:"my-4",children:(0,p.jsx)(x.HG.OosCheckboxField,{error:a.is_oos})}),(0,p.jsx)("div",{className:"my-4",children:(0,p.jsx)(x.HG.IsExplicitCheckboxField,{error:a.is_explicit})})]});return(0,p.jsxs)(o.ZP.Section,{children:[(0,p.jsx)(x.Eh,{context:t,instance:n,fields:["name","category","description","retail_price","is_pre_sale","is_pre_sale_text","is_pre_sale_dt","is_on_sale","sale_price","is_oos","is_explicit"],onSuccess:function(e){var t=e.data;return i(t)},children:(0,p.jsx)(o.ZP.Section,{title:T("InfoTab.title"),text:T("InfoTab.text"),footer:(0,p.jsx)("div",{className:"d-flex justify-content-center",children:(0,p.jsx)(d.ZP.Submit,{value:T("Btn.saveLabel"),className:"btn-primary min-w-25 fw-bold"})}),children:s})}),(0,p.jsx)(o.ZP.Section,{border:!0,title:T("SeoTab.title"),children:(0,p.jsxs)(x.Eh,{context:t,instance:n,fields:["meta_title","meta_description","meta_slug"],onSuccess:function(e){var t=e.data;return i(t)},children:[(0,p.jsx)(d.lm,{error:a.meta_title}),(0,p.jsx)(d.uV,{error:a.meta_slug}),(0,p.jsx)(d.bA,{error:a.meta_description}),(0,p.jsx)("div",{className:"d-flex justify-content-center",children:(0,p.jsx)(d.ZP.Submit,{value:T("Btn.saveLabel"),className:"btn-primary-3 min-w-25 fw-bold"})})]})})]})},k=function(e){var t=e.instance,n=e.onUpdate,r=s.useState(!1),i=(0,a.Z)(r,2),l=i[0],c=i[1],d=s.useState(!1),x=(0,a.Z)(d,2),v=x[0],f=x[1];return(0,p.jsx)(o.ZP.Section,{title:T("InventoryTab.title"),children:(0,p.jsx)("div",{className:"d-grid grid-md-3 gap-1",children:(0,p.jsxs)("div",{className:"span-md-2",children:[(0,p.jsxs)(o.ZP.Section,{title:"Tailles",text:"Ajouter des tailles",actions:(0,p.jsx)(u.zx,{onClick:function(){return f(!v)},className:"btn-primary-3",children:"Ajouter une taille"}),children:[v&&(0,p.jsx)(o.ZP.Section,{text:"Ajouter une taille",children:(0,p.jsx)(m.T9,{productInstance:t,onSuccess:function(e){var t=e.data;return n(t)}})}),t.sizes.map((function(e){return(0,p.jsx)(m.dh,{data:e,productInstance:t,onSuccess:function(e){var t=e.data;return n(t)}},e.slug)}))]}),(0,p.jsxs)(o.ZP.Section,{title:"Attributs",actions:(0,p.jsx)(u.zx,{onClick:function(){return c(!l)},className:"btn-primary-3",children:"Ajouter un attribut"}),children:[l&&(0,p.jsx)(o.ZP.Section,{text:"Ajouter un attribut au produit.",children:(0,p.jsx)(S,{productInstance:t,onSuccess:function(e){var t=e.data;return n(t)}})}),t.attributes.map((function(e){return(0,p.jsx)("div",{className:"mb-1",children:(0,p.jsx)(_,{data:e,productInstance:t,onSuccess:function(e){var t=e.data;return n(t)}})},e.slug)}))]})]})})})},A=function(e){var t=e.instance,n=e.listRes,r=e.navigate;return(0,p.jsx)(o.ZP.Section,{title:T("SettingsTab.title"),children:(0,p.jsx)(o.ZP.Section,{title:T("SettingsTab.deleteSectionTitle"),actions:(0,p.jsx)(y.sq,{instance:t,onSuccess:function(){return n.refresh(),r(e.back)},onError:function(e){404===e.status&&r("../")}})})})},C=function(e){var t=e.instance,n=e.onUpdate,r=t.cover_data;return(0,p.jsx)(o.ZP.Section,{title:T("MediaTab.title"),actions:(0,p.jsx)(y.n9,{productInstance:t,onSuccess:function(e){return null===n||void 0===n?void 0:n(e.data)}}),children:(0,p.jsxs)("div",{className:"d-grid grid-md-3 grid-lg-4 gap-2",children:[(0,p.jsx)(D,(0,i.Z)((0,i.Z)({},e),{},{img:(0,o.pB)(r),onDeleteSuccess:function(){return n({cover_data:null,cover:null})}})),t.images_data.map((function(r){var a=(0,o.pB)(r);return(0,s.createElement)(L,(0,i.Z)((0,i.Z)({},e),{},{img:a,actions:(0,p.jsx)(o.ZP.Button,{onClick:function(){return t.swapCover(a.slug).then((function(e){var t=e.data;return n(t)}))},children:"Set as cover"}),onDeleteSuccess:function(){return n({images_data:t.images_data.filter((function(e){return e.slug!==a.slug})),images:t.images.filter((function(e){return e!==a.slug}))})},key:a.slug}))}))]})})},E=function(e){switch(e){case"mobile":return o.pB.Mobile;case"square":return o.pB.Square;case"thumb":return o.pB.Thumb;case"picture":return o.pB.Picture;default:return o.pB.Image}},D=function(e){var t=e.img,n=e.onUpdate,r=e.instance,a=(0,d.cI)({view:"src"});if(!t.slug)return(0,p.jsxs)("div",{className:"p-cover-add-btn d-flex align-items-center justify-content-center flex-column text-center border-1 rounded p-3",children:[(0,p.jsx)("p",{className:"text-sm text-muted mb-3",children:"Ce produit n'a pas d'image principale"}),(0,p.jsx)(o.CD,{onSuccess:function(e){var t=e.data;r.update({cover:t.slug}).then((function(e){var t=e.data;return n(t)})).catch((function(e){}))},label:"Ajouter une image",className:"btn-primary-3 btn-md"})]});var s=E(a.values.view);return(0,p.jsx)(d.ZP,{context:a,className:"p-cover-update-form",children:(0,p.jsx)(o.ZP.Section,{border:!0,title:(0,p.jsx)(H,(0,i.Z)((0,i.Z)({},e),{},{img:t})),actions:(0,p.jsx)(o.K7,{required:!0,name:"view"}),className:"p-image-card",children:(0,p.jsx)(o.Cz,{instance:t,field:a.values.view,onSuccess:function(e){var t=e.data;return n({cover:t.slug,cover_data:t})},children:(0,p.jsx)(s,(0,i.Z)({},t))})})})},L=function(e){var t=e.img,n=e.actions,a=(0,r.Z)(e,I);return(0,p.jsx)(o.ZP.Section,{border:!0,title:(0,p.jsx)(H,(0,i.Z)((0,i.Z)({},a),{},{img:t})),actions:n,className:"p-image-card",children:(0,p.jsx)(o.pB.Image,(0,i.Z)({},t))})},H=function(e){var t=e.img,n=e.onDeleteSuccess;return t&&t.slug?(0,p.jsx)(o.RC,{onSuccess:n,instance:t,className:"btn-danger-3",children:(0,p.jsx)(u.PJ.rF,{})}):null}},243:function(e,t){t.Z={"InfoTab.title":{fr:"D\xe9tails",en:"Details"},"InfoTab.text":{fr:"Modifier les informations de ce produit",en:"Update product's info"},"SeoTab.title":{fr:"Seo",en:"Seo"},"InventoryTab.title":{fr:"Inventaire",en:"Inventory"},"MediaTab.title":{fr:"M\xe9dia",en:"Media"},"SettingsTab.title":{fr:"Param\xe8tres",en:"Settings"},"SettingsTab.deleteSectionTitle":{fr:"Supprimer ce produit",en:"Delete product"},"CreateView.title":{fr:"Ajouter un produit",en:"Add product"},"ListView.title":{fr:"Produits",en:"Products"},"ListView.actionLinkLabel":{fr:"Ajouter",en:"Add product"},"ListView.noItemText":{fr:"Ajouter un produit pour commencer",en:"Add products to your shop to get started"},"ListView.addProductLinkLabel":{fr:"Ajouter un produit",en:"Add a new product"},"Btn.saveLabel":{fr:"Sauvegarder",en:"Save"}}}}]);
//# sourceMappingURL=591.8dc3b8c7.chunk.js.map