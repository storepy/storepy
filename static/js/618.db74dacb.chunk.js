"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[618],{4908:function(e,n,r){r.d(n,{CB:function(){return x},V5:function(){return p}});var t=r(3872),i=r(4384),a=r(7406),l=r(810),s=r(9576),c=r(2322),o=r(7457),u=["instance","categories","fields","children"],d=["onSuccess","onError","onWillSubmit"],v=["label","text","error","categories"],m=["label","error"],x=function(e){var n=(0,s.cI)({name:""});return(0,o.jsxs)(f,{context:n,onSubmit:function(r){return r.preventDefault(),(0,c.D)({}).create(n.values).then((function(n){var r;return null===e||void 0===e||null===(r=e.onSuccess)||void 0===r?void 0:r.call(e,n)})).catch((function(r){var t;n.handleError(r),null===e||void 0===e||null===(t=e.onFailure)||void 0===t||t.call(e,r)}))},children:[(0,o.jsx)("div",{className:"",children:(0,o.jsx)(f.NameField,{error:n.errors.name})}),(0,o.jsx)("div",{className:"my-3",children:(0,o.jsx)(s.ZP.Submit,{value:"Save category",className:"btn btn-primary"})})]})},p=function(e){var n,r,a,s,c=e.instance,v=void 0===c?(0,l.q9)("Category instance"):c,m=e.categories,x=e.fields,p=void 0===x?[]:x,j=e.children,h=(0,i.Z)(e,u),g=h.onSuccess,b=h.onError,Z=h.onWillSubmit,S=(0,i.Z)(h,d),P=S.context;return(0,o.jsxs)(f,(0,t.Z)((0,t.Z)({},S),{},{onSubmit:function(e){e.preventDefault(),null===Z||void 0===Z||Z();var n={};return p.forEach((function(e){var r=P.values[e];null!=r&&(n[e]=r)})),v.update(n).then((function(e){return null===g||void 0===g?void 0:g(e)})).catch((function(e){var n;return b?b(e):null===P||void 0===P||null===(n=P.handleError)||void 0===n?void 0:n.call(P,e)}))},children:[p.includes("parent")&&m&&(0,o.jsx)(f.ParentField,{categories:m,label:"Cat\xe9gorie m\xe8re",error:null===P||void 0===P||null===(n=P.errors)||void 0===n?void 0:n.parent}),p.includes("name")&&(0,o.jsx)(f.NameField,{label:"Nom",error:null===P||void 0===P||null===(r=P.errors)||void 0===r?void 0:r.name,text:"65 caract\xe8res au max."}),p.includes("description")&&(0,o.jsx)(f.DescriptionField,{label:"Description",error:null===P||void 0===P||null===(a=P.errors)||void 0===a?void 0:a.description,text:"D\xe9crivez cet cat\xe9gorie."}),p.includes("position")&&(0,o.jsx)(f.PositionField,{label:"Position",error:null===P||void 0===P||null===(s=P.errors)||void 0===s?void 0:s.position}),j]}))},f=function(e){return(0,o.jsx)(s.ZP,(0,t.Z)({},e))};f.NameField=function(e){return(0,o.jsx)(s.wd,(0,t.Z)((0,t.Z)({placeholder:"Entrez le nom de la cat\xe9gorie ..."},e),{},{required:!0}))},f.DescriptionField=function(e){return(0,o.jsx)(s.F$,(0,t.Z)({},e))},f.ParentField=function(e){var n,r=e.label,l=e.text,c=e.error,u=e.categories,d=(0,i.Z)(e,v);return(0,o.jsx)(s.ZP.Field,{label:r,text:l,error:c,children:(0,o.jsx)(s.ZP.Select,(0,t.Z)((0,t.Z)({},d),{},{name:"parent",nullValue:{label:"Aucune ..."},children:null===u||void 0===u||null===(n=u.items)||void 0===n?void 0:n.map((function(e){return(0,a.createElement)(s.ZP.Option,(0,t.Z)((0,t.Z)({},e),{},{key:e.value}))}))}))})},f.PositionField=function(e){var n=e.label,r=e.error,a=(0,i.Z)(e,m);return(0,o.jsx)(s.ZP.Field,{label:n,error:r,children:(0,o.jsx)(s.ZP.Text,(0,t.Z)({name:"position",type:"number",min:0},a))})}},9618:function(e,n,r){r.r(n),r.d(n,{default:function(){return x}});var t=r(3872),i=r(7406),a=r(9996),l=r(2050),s=r(5789),c=r(9576),o=r(2988),u=r(2322),d=r(4908),v=r(9450),m=r(7457);function x(){var e=(0,a.UO)().catSlug,n=i.useContext(v.h2),r=n.category,x=n.top_categories,f=(0,c.cI)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:e.name||"",parent:e.parent||"",description:e.description||"",is_published:e.is_published||!1,meta_title:e.meta_title||"",meta_slug:(null===e||void 0===e?void 0:e.meta_slug)||"",meta_description:(null===e||void 0===e?void 0:e.meta_description)||""}}(r));if(e!==(null===r||void 0===r?void 0:r.slug))return(0,m.jsx)(l.gb,{icon:!0});var j=(0,u.D)(r),h=function(e){return n.updateData({category:(0,t.Z)((0,t.Z)({},r),e)})},g=function(e){var n=e.data;return h(n)},b=f.errors;return(0,m.jsx)(s.ZP.View,{title:"Modifier cette cat\xe9gorie",back:"../",requiredPerms:["store.change_category"],className:"cat-staff-update-view",children:(0,m.jsxs)("div",{className:"d-grid grid-md-4",children:[(0,m.jsx)("div",{className:"p-md-1",children:(0,m.jsx)("div",{className:"p-1",children:(0,m.jsx)(p,{instance:j,updateData:h})})}),e===(null===r||void 0===r?void 0:r.slug)&&(0,m.jsxs)("div",{className:"span-md-3 span-lg-2",children:[(0,m.jsx)(s.ZP.Section,{title:"Details",children:(0,m.jsx)(d.V5,{context:f,instance:j,categories:x,fields:["name","parent","description"],onSuccess:g,children:(0,m.jsx)("div",{className:"d-flex justify-content-center",children:(0,m.jsx)(c.ZP.Submit,{value:"Sauvegarder",className:"btn-primary-3 min-w-25"})})})}),(0,m.jsx)(s.ZP.Section,{title:"SEO",children:(0,m.jsxs)(d.V5,{context:f,instance:j,fields:["meta_title","meta_description","meta_slug"],onSuccess:g,children:[(0,m.jsx)(c.lm,{error:b.meta_title}),(0,m.jsx)(c.uV,{error:b.meta_slug}),(0,m.jsx)(c.bA,{error:b.meta_description}),(0,m.jsx)("div",{className:"d-flex justify-content-center",children:(0,m.jsx)(c.ZP.Submit,{value:"Sauvegarder",className:"btn-primary-3 min-w-25"})})]})})]}),(0,m.jsx)("div",{className:"span-lg-1",children:(0,m.jsx)("div",{style:{top:0,position:"sticky"},children:j.is_published?(0,m.jsx)(o.Ko,{instance:j,onSuccess:function(e){var n=e.data;h(n)},children:"D\xe9publier cette cat\xe9gorie"}):(0,m.jsx)(o.H5,{instance:j,onSuccess:function(e){var n=e.data;return h(n)},onFailure:function(e){return f.handleError(e)},children:"Publier cette cat\xe9gorie"})})})]})})}var p=function(e){var n=e.updateData,r=e.instance,i=(0,c.cI)({view:"src"}),a=s.ZP.Img((null===r||void 0===r?void 0:r.cover_data)||{});return null!==a&&void 0!==a&&a.slug?(0,m.jsx)(c.ZP,{context:i,className:"p-cover-update-form",children:(0,m.jsx)(s.ZP.Section,{border:!0,actions:(0,m.jsx)(s.RC,{onSuccess:function(){return n({cover_data:null,cover:null})},instance:a,className:"btn-danger-3 btn-square",children:(0,m.jsx)(l.PJ.rF,{})}),className:"p-image-card",children:(0,m.jsx)(s.pB.Image,(0,t.Z)({},a))})}):(0,m.jsx)("div",{className:"d-flex align-items-center justify-content-center flex-column text-center border-1 rounded p-3",children:(0,m.jsx)(s.CD,{onSuccess:function(e){var t=e.data;r.updateCover(t.slug).then((function(e){var r=e.data;return n(r)})).catch((function(e){}))},label:"Ajouter une image",className:"btn-primary-3 btn-md"})})}}}]);
//# sourceMappingURL=618.db74dacb.chunk.js.map