"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[691],{4908:function(e,n,r){r.d(n,{CB:function(){return x},V5:function(){return p}});var i=r(3872),t=r(4384),s=r(7406),l=r(810),o=r(9576),a=r(2322),c=r(7457),d=["instance","categories","fields","children"],u=["onSuccess","onError","onWillSubmit"],m=["label","text","error","categories"],v=["label","error"],x=function(e){var n=(0,o.cI)({name:""});return(0,c.jsxs)(h,{context:n,onSubmit:function(r){return r.preventDefault(),(0,a.D)({}).create(n.values).then((function(n){var r;return null===e||void 0===e||null===(r=e.onSuccess)||void 0===r?void 0:r.call(e,n)})).catch((function(r){var i;n.handleError(r),null===e||void 0===e||null===(i=e.onFailure)||void 0===i||i.call(e,r)}))},children:[(0,c.jsx)("div",{className:"",children:(0,c.jsx)(h.NameField,{error:n.errors.name})}),(0,c.jsx)("div",{className:"my-3",children:(0,c.jsx)(o.ZP.Submit,{value:"Save category",className:"btn btn-primary"})})]})},p=function(e){var n,r,s,o,a=e.instance,m=void 0===a?(0,l.q9)("Category instance"):a,v=e.categories,x=e.fields,p=void 0===x?[]:x,j=e.children,f=(0,t.Z)(e,d),Z=f.onSuccess,g=f.onError,b=f.onWillSubmit,y=(0,t.Z)(f,u),P=y.context;return(0,c.jsxs)(h,(0,i.Z)((0,i.Z)({},y),{},{onSubmit:function(e){e.preventDefault(),null===b||void 0===b||b();var n={};return p.forEach((function(e){var r=P.values[e];null!=r&&(n[e]=r)})),m.update(n).then((function(e){return null===Z||void 0===Z?void 0:Z(e)})).catch((function(e){var n;return g?g(e):null===P||void 0===P||null===(n=P.handleError)||void 0===n?void 0:n.call(P,e)}))},children:[p.includes("parent")&&v&&(0,c.jsx)(h.ParentField,{categories:v,label:"Cat\xe9gorie m\xe8re",error:null===P||void 0===P||null===(n=P.errors)||void 0===n?void 0:n.parent}),p.includes("name")&&(0,c.jsx)(h.NameField,{label:"Nom",error:null===P||void 0===P||null===(r=P.errors)||void 0===r?void 0:r.name,text:"65 caract\xe8res au max."}),p.includes("description")&&(0,c.jsx)(h.DescriptionField,{label:"Description",error:null===P||void 0===P||null===(s=P.errors)||void 0===s?void 0:s.description,text:"D\xe9crivez cet cat\xe9gorie."}),p.includes("position")&&(0,c.jsx)(h.PositionField,{label:"Position",error:null===P||void 0===P||null===(o=P.errors)||void 0===o?void 0:o.position}),j]}))},h=function(e){return(0,c.jsx)(o.ZP,(0,i.Z)({},e))};h.NameField=function(e){return(0,c.jsx)(o.wd,(0,i.Z)((0,i.Z)({placeholder:"Entrez le nom de la cat\xe9gorie ..."},e),{},{required:!0}))},h.DescriptionField=function(e){return(0,c.jsx)(o.F$,(0,i.Z)({},e))},h.ParentField=function(e){var n,r=e.label,l=e.text,a=e.error,d=e.categories,u=(0,t.Z)(e,m);return(0,c.jsx)(o.ZP.Field,{label:r,text:l,error:a,children:(0,c.jsx)(o.ZP.Select,(0,i.Z)((0,i.Z)({},u),{},{name:"parent",nullValue:{label:"Aucune ..."},children:null===d||void 0===d||null===(n=d.items)||void 0===n?void 0:n.map((function(e){return(0,s.createElement)(o.ZP.Option,(0,i.Z)((0,i.Z)({},e),{},{key:e.value}))}))}))})},h.PositionField=function(e){var n=e.label,r=e.error,s=(0,t.Z)(e,v);return(0,c.jsx)(o.ZP.Field,{label:n,error:r,children:(0,c.jsx)(o.ZP.Text,(0,i.Z)({name:"position",type:"number",min:0},s))})}},9691:function(e,n,r){r.r(n),r.d(n,{default:function(){return f}});var i=r(4384),t=r(3872),s=r(3251),l=r(7406),o=r(9996),a=r(9157),c=r(5789),d=r(9474),u=r(9576),m=r(1340),v=r(2988),x=r(2322),p=r(4908),h=r(7457),j=["item"];function f(){var e=(0,o.s0)(),n=(0,a.lr)(),r=(0,s.Z)(n,1)[0].get("page"),i=(0,d.QT)((function(){return(0,x.D)({}).list({params:{page:r}})}),{refreshDeps:[r]}),u=i.res,v=i.updateItem,j=l.useState(!1),f=(0,s.Z)(j,2),g=f[0],b=f[1],y=new d.F6(u);return y.isSuccess?(0,h.jsxs)(c.ZP.View,{title:"Cat\xe9gories",back:"/staff/store/",actions:(0,h.jsx)(c.ZP.Button,{onClick:function(){return b(!g)},className:"btn-primary-3",title:"Add a new category",requiredPerms:["store.add_category"],children:"Ajouter"}),requiredPerms:["store.view_category"],children:[g&&(0,h.jsx)("div",{className:"miq-container center",children:(0,h.jsx)(c.ZP.Section,{title:"Add a category",requiredPerms:["store.add_category"],border:!0,children:(0,h.jsx)(p.CB,{onSuccess:function(n){var r=n.data;return e(r.slug)}})})}),0===y.items.length&&!g&&(0,h.jsxs)("div",{className:"text-center p-staff-list-empty py-3 my-3",children:[(0,h.jsx)("p",{className:"fw-light text-md",children:"Ajouter une cat\xe9gorie pour commencer"}),(0,h.jsx)("div",{className:"my-4",children:(0,h.jsx)(c.ZP.Button,{onClick:function(){return b(!g)},requiredPerms:["store.add_category"],className:"btn btn-primary btn-md",children:"Add a category"})})]}),y.items.sort((function(e,n){return e.position>n.position?1:-1})).map((function(e){return(0,h.jsx)(Z,{item:e,onUpdate:function(e){v(e.data)}},e.slug)})),(0,h.jsx)("div",{children:(0,h.jsx)(m.tl,(0,t.Z)((0,t.Z)({},y.pagination),{},{component:c.ZP.Link,to:!0}))})]}):null}function Z(e){var n=e.item,r=(0,i.Z)(e,j),o=l.useState(!1),a=(0,s.Z)(o,2),d=a[0],f=a[1],Z=(0,x.D)(n),g=(0,u.cI)({name:(null===Z||void 0===Z?void 0:Z.name)||"",description:(null===Z||void 0===Z?void 0:Z.description)||"",position:(null===Z||void 0===Z?void 0:Z.position)||0});return(0,h.jsx)(m.vz,{border:!0,title:(0,h.jsxs)("div",{onClick:function(){return f(!d)},className:"d-flex align-items-center",children:[(0,h.jsx)("div",{style:{minWidth:48,width:48,height:48},children:(0,h.jsx)(c.ZP.Img.Square,(0,t.Z)((0,t.Z)({slug:"slug",src:"src"},Z.cover_data),{},{className:"rounded"}))}),(0,h.jsxs)("div",{className:"ms-1",children:[(0,h.jsxs)("div",{className:"text-ellipsis",children:[(0,h.jsx)("span",{className:"me-1",children:g.values.name}),(0,h.jsx)(v.TK,{show:Z.is_published})]}),(0,h.jsxs)("div",{className:"text-sm",children:[(0,h.jsxs)("span",{children:["Total: ",Z.products_count," "]}),(0,h.jsxs)("span",{children:["(",Z.published_count,"/",(0,h.jsx)("span",{className:"text-muted",children:Z.draft_count}),")"]})]})]})]}),actions:(0,h.jsx)("div",{children:(0,h.jsx)(c.ZP.Link,{to:"".concat(Z.slug,"/"),className:"btn btn-square btn-primary-3",requiredPerms:["store.change_category"],children:(0,h.jsx)(m.PJ.I8,{})})}),children:d&&(0,h.jsx)("div",{className:"",children:(0,h.jsx)(p.V5,{context:g,instance:Z,fields:["name","description","position"],onSuccess:r.onUpdate,children:(0,h.jsx)("div",{className:"d-flex justify-content-center",children:(0,h.jsx)(u.ZP.Submit,{value:"Sauvegarder",className:"btn-primary-3 min-w-25"})})})})})}}}]);
//# sourceMappingURL=691.338a466a.chunk.js.map