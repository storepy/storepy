"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[691],{4908:function(e,n,r){r.d(n,{CB:function(){return m},V5:function(){return v}});var i=r(3872),t=r(4384),s=(r(7406),r(810)),o=r(9576),c=r(2322),l=r(7457),a=["instance","fields","children"],d=["onSuccess","onError","onWillSubmit"],u=["label","error"],m=function(e){var n=(0,o.cI)({name:""});return(0,l.jsxs)(x,{context:n,onSubmit:function(r){return r.preventDefault(),(0,c.D)().create(n.values).then((function(n){var r;return null===e||void 0===e||null===(r=e.onSuccess)||void 0===r?void 0:r.call(e,n)})).catch((function(r){var i;n.handleError(r),null===e||void 0===e||null===(i=e.onFailure)||void 0===i||i.call(e,r)}))},children:[(0,l.jsx)("div",{className:"",children:(0,l.jsx)(x.NameField,{error:n.errors.name})}),(0,l.jsx)("div",{className:"my-3",children:(0,l.jsx)(o.ZP.Submit,{value:"Save category",className:"btn btn-primary"})})]})},v=function(e){var n,r,o,c=e.instance,u=void 0===c?(0,s.q9)("Category instance"):c,m=e.fields,v=void 0===m?[]:m,p=e.children,h=(0,t.Z)(e,a),j=h.onSuccess,f=h.onError,g=h.onWillSubmit,b=(0,t.Z)(h,d),Z=b.context;return(0,l.jsxs)(x,(0,i.Z)((0,i.Z)({},b),{},{onSubmit:function(e){e.preventDefault(),null===g||void 0===g||g();var n={};return v.forEach((function(e){var r=Z.values[e];null!=r&&(n[e]=r)})),u.update(n).then((function(e){return null===j||void 0===j?void 0:j(e)})).catch((function(e){var n;return f?f(e):null===Z||void 0===Z||null===(n=Z.handleError)||void 0===n?void 0:n.call(Z,e)}))},children:[v.includes("name")&&(0,l.jsx)(x.NameField,{label:"Nom de la cat\xe9gorie",error:null===Z||void 0===Z||null===(n=Z.errors)||void 0===n?void 0:n.name,text:"Ajoutez un nom qui d\xe9crit cette cat\xe9gorie.\nNous recommandons 65 caract\xe8res au max."}),v.includes("description")&&(0,l.jsx)(x.DescriptionField,{label:"Description",error:null===Z||void 0===Z||null===(r=Z.errors)||void 0===r?void 0:r.description,text:"D\xe9crivez cet cat\xe9gorie."}),v.includes("position")&&(0,l.jsx)(x.PositionField,{label:"Position",error:null===Z||void 0===Z||null===(o=Z.errors)||void 0===o?void 0:o.position}),p]}))},x=function(e){return(0,l.jsx)(o.ZP,(0,i.Z)({},e))};x.NameField=function(e){return(0,l.jsx)(o.wd,(0,i.Z)((0,i.Z)({placeholder:"Entrez le nom de la cat\xe9gorie ..."},e),{},{required:!0}))},x.DescriptionField=function(e){return(0,l.jsx)(o.F$,(0,i.Z)({},e))},x.PositionField=function(e){var n=e.label,r=e.error,s=(0,t.Z)(e,u);return(0,l.jsx)(o.ZP.Field,{label:n,error:r,children:(0,l.jsx)(o.ZP.Text,(0,i.Z)({name:"position",type:"number",min:0},s))})}},9691:function(e,n,r){r.r(n),r.d(n,{default:function(){return f}});var i=r(4384),t=r(3872),s=r(3251),o=r(7406),c=r(9996),l=r(9157),a=r(5789),d=r(9474),u=r(9576),m=r(2050),v=r(2988),x=r(2322),p=r(4908),h=r(7457),j=["item"];function f(){var e=(0,c.s0)(),n=(0,l.lr)(),r=(0,s.Z)(n,1)[0].get("page"),i=(0,d.QT)((function(){return(0,x.D)({}).list({params:{page:r}})}),{refreshDeps:[r]}),u=i.res,v=i.updateItem,j=o.useState(!1),f=(0,s.Z)(j,2),b=f[0],Z=f[1],y=new d.F6(u);return y.isSuccess?(0,h.jsxs)(a.ZP.View,{title:"Cat\xe9gories",back:"/staff/store/",actions:(0,h.jsx)(a.ZP.Button,{onClick:function(){return Z(!b)},className:"btn-primary-3",title:"Add a new category",requiredPerms:["store.add_category"],children:"Ajouter"}),requiredPerms:["store.view_category"],children:[b&&(0,h.jsx)("div",{className:"miq-container center",children:(0,h.jsx)(a.ZP.Section,{title:"Add a category",requiredPerms:["store.add_category"],border:!0,children:(0,h.jsx)(p.CB,{onSuccess:function(n){var r=n.data;return e(r.slug)}})})}),0===y.items.length&&!b&&(0,h.jsxs)("div",{className:"text-center p-staff-list-empty py-3 my-3",children:[(0,h.jsx)("p",{className:"fw-light text-md",children:"Ajouter une cat\xe9gorie pour commencer"}),(0,h.jsx)("div",{className:"my-4",children:(0,h.jsx)(a.ZP.Button,{onClick:function(){return Z(!b)},requiredPerms:["store.add_category"],className:"btn btn-primary btn-md",children:"Add a category"})})]}),y.items.sort((function(e,n){return e.position>n.position?1:-1})).map((function(e){return(0,h.jsx)(g,{item:e,onUpdate:function(e){v(e.data)}},e.slug)})),(0,h.jsx)("div",{children:(0,h.jsx)(m.tl,(0,t.Z)((0,t.Z)({},y.pagination),{},{component:a.ZP.Link,to:!0}))})]}):null}function g(e){var n=e.item,r=(0,i.Z)(e,j),c=o.useState(!1),l=(0,s.Z)(c,2),d=l[0],f=l[1],g=(0,x.D)(n),b=(0,u.cI)({name:(null===g||void 0===g?void 0:g.name)||"",description:(null===g||void 0===g?void 0:g.description)||"",position:(null===g||void 0===g?void 0:g.position)||0});return(0,h.jsx)(m.vz,{border:!0,title:(0,h.jsxs)("div",{onClick:function(){return f(!d)},className:"d-flex align-items-center",children:[(0,h.jsx)("div",{style:{minWidth:48,width:48,height:48},children:(0,h.jsx)(a.ZP.Img.Square,(0,t.Z)((0,t.Z)({slug:"slug",src:"src"},g.cover_data),{},{className:"rounded"}))}),(0,h.jsxs)("div",{className:"ms-1",children:[(0,h.jsxs)("div",{className:"text-ellipsis",children:[(0,h.jsx)("span",{className:"me-1",children:b.values.name}),(0,h.jsx)(v.TK,{show:g.is_published})]}),(0,h.jsxs)("div",{className:"text-sm",children:[(0,h.jsxs)("span",{children:["Total: ",g.products_count," "]}),(0,h.jsxs)("span",{children:["(",g.published_count,"/",(0,h.jsx)("span",{className:"text-muted",children:g.draft_count}),")"]})]})]})]}),actions:(0,h.jsx)("div",{children:(0,h.jsx)(a.ZP.Link,{to:"".concat(g.slug,"/"),className:"btn btn-square btn-primary-3",requiredPerms:["store.change_category"],children:(0,h.jsx)(m.PJ.I8,{})})}),children:d&&(0,h.jsx)("div",{className:"",children:(0,h.jsx)(p.V5,{context:b,instance:g,fields:["name","description","position"],onSuccess:r.onUpdate,children:(0,h.jsx)("div",{className:"d-flex justify-content-center",children:(0,h.jsx)(u.ZP.Submit,{value:"Sauvegarder",className:"btn-primary-3 min-w-25"})})})})})}}}]);
//# sourceMappingURL=691.46e2a8f9.chunk.js.map