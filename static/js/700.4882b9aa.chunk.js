"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[700],{4803:function(e,t,n){n.d(t,{Bj:function(){return o},Xu:function(){return u},sZ:function(){return m}});var i=n(4384),r=(n(7406),n(5789)),s=n(3088),a=n(9576),l=n(1340),c=n(7457),d=["item","cart"],o=function(e){var t=(0,a.cI)({description:"",amt:""}),n=e.instance,i=e.onSuccess,r=e.onError,s=n.products.length<=0,d=function(e){t.setValues({description:"",amt:""}),e(!1)};return(0,c.jsx)(a.ZP,{context:t,onSubmit:function(e){return e.preventDefault()},className:"cart-discount-form",children:(0,c.jsx)(l.pu,{disabled:s,modal:{width:"md",bodyCN:"cart-discount-modal-body"},title:s?"Ajouter un produit avant de pouvoir ajouter une r\xe9duction":"Ajouter une r\xe9duction",renderHeader:function(){return(0,c.jsxs)("div",{className:"fw-bold p-1 d-flex align-items-center",children:[(0,c.jsx)(l.PJ.Xb,{className:"btn-round"}),(0,c.jsx)("div",{children:"Ajouter une r\xe9duction"})]})},renderFooter:function(e){var s=e.setOpen;return(0,c.jsxs)("div",{className:"d-flex justify-content-between align-items-center p-2",children:[(0,c.jsx)(l.zx,{onClick:function(){return d(s)},children:"Annuler"}),(0,c.jsx)(a.ZP.Submit,{onClick:function(e){e.preventDefault(),n.postDiscount(t.values).then((function(e){d(s),null===i||void 0===i||i(e)})).catch((function(e){t.handleError(e),null===r||void 0===r||r(e)}))},className:"btn-primary fw-bold w-50",children:"Ajouter"})]})},render:function(){return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:"p-2",children:[(0,c.jsx)(a.ZP.Field,{label:"Description",text:"",error:t.errors.description,children:(0,c.jsx)(a.ZP.Text,{placeholder:"D\xe9crivez la r\xe9duction ...",required:!0,name:"description",minLength:4,maxLength:80})}),(0,c.jsx)(a.ZP.Field,{label:"Montant",text:"",error:t.errors.amt,children:(0,c.jsx)(a.ZP.Text,{"aria-describedby":"sale_price_label",min:"0",step:"0.01",required:!0,placeholder:"Entrez le montant de la r\xe9duction ...",type:"number",name:"amt"})})]})})},className:"btn-primary-3 btn-round fw-bold",children:(0,c.jsx)(l.PJ.Xb,{})})})},u=function(e){var t=e.item,n=e.cart,s=(0,i.Z)(e,d);return(0,c.jsx)(l.o,{editView:function(e){var i=e.setEdit;return(0,c.jsxs)("div",{className:"d-flex align-items-center justify-content-between",children:[(0,c.jsxs)("div",{className:"color-red-400 me-1",children:["Supprimer ",(0,c.jsx)("span",{className:"fw-bold",children:t.description.slice(0,30)}),"?"]}),(0,c.jsxs)("div",{className:"d-flex",children:[(0,c.jsx)(r.ZP.Button,{onClick:function(){n.destroyDiscount(t.slug).then((function(e){var t;i(!1),null===s||void 0===s||null===(t=s.onSuccess)||void 0===t||t.call(s,e)})).catch((function(e){var t;return null===s||void 0===s||null===(t=s.onError)||void 0===t?void 0:t.call(s,e)}))},className:"btn-danger",children:"Supprimer"}),(0,c.jsx)(l.zx,{onClick:function(){return i(!1)},className:"ms-1 btn-round",title:"Annuler",children:"x"})]})]})},className:s.className,children:(0,c.jsx)(m,{item:t})})},m=function(e){var t=e.item;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{className:"discount-item-description",children:t.description.slice(0,30)}),(0,c.jsxs)("span",{className:"discount-item-price d-flex color-green-500",children:["-",(0,c.jsx)(s._S,{retail_price_data:t.amt_data})]})]})}},7150:function(e,t,n){n.d(t,{a:function(){return d},y:function(){return o}});var i=n(3872),r=n(4384),s=(n(7406),n(5789)),a=n(1340),l=n(7457),c=["instance"],d=function(e){var t=e.instance,n=(0,r.Z)(e,c);return(0,l.jsxs)(a.pu,{renderHeader:function(){return(0,l.jsx)("div",{className:"text-md p-1",children:"Le client a t'il re\xe7u le produit?"})},renderFooter:function(e){var i=e.setOpen;return(0,l.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,l.jsx)(a.zx,{onClick:function(){return i(!1)},children:"Pas encore"}),(0,l.jsx)(a.zx,{onClick:function(){return t.mark_delivered().then((function(e){var t;null===n||void 0===n||null===(t=n.onSuccess)||void 0===t||t.call(n,e)})).catch((function(e){var t;null===n||void 0===n||null===(t=n.onFailure)||void 0===t||t.call(n,e)}))},className:"btn-primary fw-bold",children:"Oui"})]})},render:function(){return(0,l.jsx)("div",{className:"p-3"})},className:"btn-primary btn-md fw-bold w-50 d-flex align-items-center justify-content-center",children:[null!==t&&void 0!==t&&t.is_delivered?(0,l.jsx)(a.PJ._D,{}):(0,l.jsx)(a.PJ.NW,{}),!(null!==n&&void 0!==n&&n.icon)&&(0,l.jsx)("span",{className:"ms-1",children:"Confirmer la livraison"})]})},o=function(e){return(0,l.jsx)(s.ZP.Link,(0,i.Z)((0,i.Z)({title:"Modifier cette commande"},e),{},{to:"/staff/sales/orders/".concat(e.instance.slug,"/"),requiredPerms:["sales.change_order"],children:e.children}))}},4034:function(e,t,n){n.d(t,{K:function(){return d}});var i=n(5561),r=n(1253),s=n(4733),a=n(2562),l=n(5789),c=function(e){(0,s.Z)(n,e);var t=(0,a.Z)(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"mark_delivered",value:function(){var e;return null!==(e=this.data)&&void 0!==e&&e.is_delivered?Promise.resolve({data:this.data}):this.post("".concat(this._path,"deliver/"),{},{timeout:5e3})}},{key:"postDiscount",value:function(e){return this.post("".concat(this._path,"discount/"),e)}},{key:"deliveredDt",get:function(){var e;return this.formatDt(null===(e=this.data)||void 0===e?void 0:e.dt_delivered)}},{key:"updatedDt",get:function(){var e;return this.formatDt(null===(e=this.data)||void 0===e?void 0:e.updated)}},{key:"createdDt",get:function(){var e;return this.formatDt(null===(e=this.data)||void 0===e?void 0:e.created)}},{key:"formatDt",value:function(e){return e?new Date(e).toLocaleDateString(void 0,{day:"2-digit",weekday:"short",month:"short",year:"2-digit"}):null}}]),n}(l.x5),d=(0,l.QY)("orders",c)},700:function(e,t,n){n.r(t),n.d(t,{default:function(){return j}});var i=n(3872),r=n(7406),s=n(9996),a=n(5789),l=n(810),c=n(1340),d=n(9474),o=n(9450),u=n(2444),m=n(4803),v=n(7494),f=n(4034),x=n(7150),h=n(7457);function j(){var e,t;(0,d.jr)("Place cart - Sales");var n=(0,s.UO)().orderSlug,j=r.useContext(o.h2),p=j.order_data;if(n!==(null===p||void 0===p?void 0:p.slug)||!j.isLoaded)return(0,h.jsx)(c.gb,{});var b=(0,f.K)(p||{});return(0,h.jsx)(a.ZP.View,{title:"Commande",actions:(0,h.jsx)(h.Fragment,{}),back:"/staff/sales/orders/",headerCN:"miq-container",footer:(0,h.jsx)("div",{className:"d-flex align-items-center",children:!(null!==b&&void 0!==b&&b.is_delivered)&&(0,h.jsx)(x.a,{instance:b,onSuccess:function(e){j.updateData({order_data:(0,i.Z)((0,i.Z)({},p),e.data)})}})}),children:(0,h.jsxs)(a.ZP.Section,{mainCN:"miq-container",children:[(0,h.jsx)(a.ZP.Section,{title:"\xbb Details",mainCN:"ps-2",children:(0,h.jsxs)("ul",{children:[(0,h.jsxs)("li",{children:["Num\xe9ro de transaction: ",(0,h.jsx)("span",{className:"fw-bold",children:b.transaction_id})]}),b.is_delivered?(0,h.jsxs)("li",{className:"text-muted text-sm",children:["Livr\xe9e le ",b.deliveredDt]}):(0,h.jsxs)("li",{className:"text-muted text-sm",children:["Modifi\xe9e le ",b.updatedDt]}),(0,h.jsxs)("li",{className:"text-muted text-sm",children:["Ajout\xe9e le ",b.createdDt]})]})}),(0,h.jsx)(a.ZP.Section,{title:"\xbb Client",mainCN:"ps-2",children:(0,h.jsx)(u.CustomerCard,{data:b.customer_data})}),(0,h.jsx)(a.ZP.Section,{title:"\xbb Produits (".concat(null===b||void 0===b?void 0:b.items_count,")"),mainCN:"ps-2",footer:(0,h.jsxs)("div",{className:"",children:[(0,h.jsx)("div",{className:"d-flex justify-content-between",children:(0,h.jsx)(v.e2,{label:"Sous-total",amount:null===p||void 0===p?void 0:p.subtotal})}),p.discounts&&p.discounts.length>0&&(null===p||void 0===p||null===(e=p.discounts)||void 0===e?void 0:e.map((function(e){return(0,h.jsx)("div",{className:"d-flex justify-content-between",children:(0,h.jsx)(m.sZ,{item:e})},e.slug)}))),(0,h.jsx)("div",{className:"d-flex justify-content-between",children:(0,h.jsx)(v.e2,{bold:!0,label:"Total",amount:null===p||void 0===p?void 0:p.total})})]}),children:null===(t=b.items)||void 0===t?void 0:t.map((function(e){return(0,r.createElement)(v.nG,(0,i.Z)((0,i.Z)({},e),{},{size:e.size_data,key:(0,l.Vj)()}))}))})]})})}}}]);
//# sourceMappingURL=700.4882b9aa.chunk.js.map