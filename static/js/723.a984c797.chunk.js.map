{"version":3,"file":"static/js/723.a984c797.chunk.js","mappings":"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","sources":["../../../../packages/miq-staffjs/src/account/index.lang.ts","../../../../packages/miq-staffjs/src/account/index.tsx"],"sourcesContent":["import { TLang } from '@miq/utiljs';\n\nexport default {\n  //\n  'PUpdateView.title': { fr: 'Mon compte', en: 'Account' },\n  'PUpdateView.text': { fr: '', en: '' },\n\n  //\n  'PForm.title': { fr: 'Profile', en: 'Profile' },\n  'PForm.text': { fr: 'Mettez vos informations à jour', en: 'Update your profile information' },\n  'PForm.submitLabel': { fr: 'Enrégistrer', en: ' Update ' },\n\n  //\n  'FNField.label': { fr: 'Prénom', en: 'First name' },\n  'FNField.placeholder': { fr: 'Entrez votre prénom', en: 'Enter your first name' },\n  //\n  'GenderField.label': { fr: 'Sexe', en: 'Gender' },\n  'GenderField.nullValue': { fr: 'Sélectionner ...', en: 'Select ...' },\n  'GenderField.male': { fr: 'Masculin', en: 'Male' },\n  'GenderField.female': { fr: 'Féminin', en: 'Female' },\n  'GenderField.other': { fr: 'Autre', en: 'Other' },\n\n  //\n  'Email.sectionTitle': { fr: 'Email', en: 'Email' },\n  'Email.sectionText': {\n    fr: 'Veuillez contacter notre support pour changer votre email',\n    en: 'Please contact support to change your email',\n  },\n  //\n  'PWD.sectionTitle': { fr: 'Mot de passe', en: 'Password' },\n  'PWD.sectionText': {\n    fr: 'Veuillez contacter notre support pour changer votre mot de passe',\n    en: 'Please contact support to change your password',\n  },\n\n  //\n  'LNField.label': { fr: 'Nom', en: 'Last name' },\n  'LNField.placeholder': { fr: 'Entrez votre nom', en: 'Enter your last name' },\n  //\n  'Avatar.title': { fr: 'Avatar', en: 'Avatar' },\n  'Avatar.text': {\n    fr: 'Ajoutez votre photo de profile avec une image de format .png, .jpg ou .gif',\n    en: 'Update your profile picture\\nImages must be .png, .jpg or .gif format.',\n  },\n\n  //\n} as TLang;\n","import * as React from 'react';\nimport * as Axios from 'axios';\nimport { Routes, Route } from 'react-router-dom';\n\nimport './account.scss';\nimport lang from './index.lang';\n\nimport { Icons } from '@miq/componentjs';\nimport Form, { useForm } from '@miq/formjs';\nimport { SharedDataCtx, TSDState } from '@miq/contextjs';\nimport { FirstNameField, LastNameField } from '@miq/formjs';\n\nimport StaffView from '../Views';\nimport { StaffSection } from '../components';\nimport { StaffImgAddButton, StaffImgDeleteButton } from '../img';\nimport { StaffImg, StaffUser, TStaffUserInstance } from '../models';\n\nconst i18n = (key: string) => window.i18n(lang, key);\n\nconst AvatarUpdate = ({ instance }: { instance: TStaffUserInstance }) => {\n  const { updateUser } = React.useContext(SharedDataCtx);\n\n  if (instance.img) return <StaffImg.Square {...instance.img_data} className=\"rounded\" />;\n\n  return (\n    <StaffImgAddButton\n      className=\"btn-primary-3\"\n      onSuccess={({ data }) => {\n        instance\n          .update({ img: data?.slug })\n          .then(({ data }) => updateUser(data))\n          .catch((err) => {});\n      }}\n    />\n  );\n};\n\nconst ProfileUpdateRoute = () => {\n  const { user, updateUser, apps } = React.useContext<TSDState>(SharedDataCtx);\n  const { employee } = user;\n\n  const formInitData: any = { first_name: user.first_name, last_name: user.last_name, gender: user.gender };\n  if (employee) formInitData.position = employee.position;\n\n  const form = useForm(formInitData);\n\n  if (!user) return null;\n\n  const instance = StaffUser(user);\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    return instance\n      .update(form.values)\n      .then(({ data }: Axios.AxiosResponse) => updateUser(data))\n      .catch((err: Axios.AxiosResponse) => form.handleError(err));\n  };\n\n  return (\n    <StaffView title={i18n('PUpdateView.title')} text={i18n('PUpdateView.text')} back=\"/staff/\">\n      <Form context={form} onSubmit={handleSubmit}>\n        <div className=\"d-grid grid-md-4 gap-2\">\n          <StaffSection\n            title={i18n('PForm.title')}\n            text={i18n('PForm.text')}\n            className=\"span-md-3\"\n            footer={\n              <div className=\"text-center\">\n                <Form.Submit value={i18n('PForm.submitLabel')} className=\"btn-md btn-primary-3 fw-bold my-2 w-50\" />\n              </div>\n            }\n            mainCN=\"pt-2\"\n          >\n            <FirstNameField\n              required\n              label={i18n('FNField.label')}\n              error={form.errors.first_name}\n              placeholder={i18n('FNField.placeholder')}\n              className=\"span-md-3\"\n              fieldCN=\"d-grid grid-md-5\"\n            />\n\n            <LastNameField\n              required\n              label={i18n('LNField.label')}\n              error={form.errors.last_name}\n              placeholder={i18n('LNField.placeholder')}\n              className=\"span-md-3\"\n              fieldCN=\"d-grid grid-md-5\"\n            />\n\n            {/* <Form.Field label=\"Last name\" error={form.errors.last_name} className=\"d-grid grid-md-5\">\n              <Form.Text\n                required\n                name=\"last_name\"\n                // onSave={saveAccount}\n                // isValid={validate}\n                placeholder=\"Last name\"\n                className=\"span-md-3\"\n                minLength={2}\n              />\n            </Form.Field> */}\n\n            <Form.Field label={i18n('GenderField.label')} className=\"d-grid grid-md-5\">\n              <Form.Select\n                required\n                name=\"gender\"\n                nullValue={{ label: i18n('GenderField.nullValue') }}\n                // onChange={({ target }) => saveAccount(target)}\n                className=\"span-md-3\"\n              >\n                <option value=\"OTHER\">{i18n('GenderField.other')}</option>\n                <option value=\"MALE\">{i18n('GenderField.male')}</option>\n                <option value=\"FEMALE\">{i18n('GenderField.female')}</option>\n              </Form.Select>\n            </Form.Field>\n\n            {\n              //#region HRM\n            }\n            {Object.keys(apps).includes('miq_hrm') && (\n              <Form.Field label=\"Role\" error={form.errors.position} className=\"d-grid grid-md-5 mb-1\">\n                <Form.Text\n                  required\n                  name=\"position\"\n                  // onSave={({ value }) =>\n                  //   services\n                  //     .patch(\n                  //       'account/current/position/',\n                  //       { position: value }\n                  //       // { position: employee.position }\n                  //     )\n                  //     .catch((err) => {\n                  //       form.handleError(err);\n                  //     })\n                  // }\n                  // isValid={validate}\n                  placeholder=\"Role\"\n                  className=\"span-md-3\"\n                  minLength={2}\n                />\n              </Form.Field>\n            )}\n            {\n              //#endregion HRM\n            }\n          </StaffSection>\n\n          <StaffSection\n            title={i18n('Avatar.title')}\n            text={i18n('Avatar.text')}\n            actions={\n              <StaffImgDeleteButton\n                instance={StaffImg(instance.img_data)}\n                onSuccess={() => updateUser({ img: null, img_data: null })}\n                // onFailure={() => toast.error({ message: 'Something went wrong.' })}\n                className=\"btn-danger-3\"\n              >\n                <Icons.Trash />\n              </StaffImgDeleteButton>\n            }\n            className=\"avatar-section\"\n            mainCN=\"p-3\"\n          >\n            <AvatarUpdate instance={instance} />\n          </StaffSection>\n        </div>\n\n        <StaffSection title={i18n('Email.sectionTitle')} text={i18n('Email.sectionText')}>\n          <p className=\"text-muted text-sm\">{user.email}</p>\n        </StaffSection>\n\n        <StaffSection title={i18n('PWD.sectionTitle')} text={i18n('PWD.sectionText')} />\n      </Form>\n    </StaffView>\n  );\n};\n\nexport default function AccountStaffLayout() {\n  return (\n    <Routes>\n      <Route path=\"/\" element={<ProfileUpdateRoute />} />\n    </Routes>\n  );\n}\n"],"names":["fr","en","i18n","key","window","lang","AvatarUpdate","instance","updateUser","React","SharedDataCtx","img","img_data","className","onSuccess","data","update","slug","then","catch","err","ProfileUpdateRoute","user","apps","employee","formInitData","first_name","last_name","gender","position","form","useForm","StaffUser","title","text","back","context","onSubmit","e","preventDefault","values","handleError","footer","value","mainCN","required","label","error","errors","placeholder","fieldCN","name","nullValue","Object","keys","includes","minLength","actions","StaffImg","email","AccountStaffLayout","path","element"],"sourceRoot":""}