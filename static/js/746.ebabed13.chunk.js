"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[746],{1507:function(e,n,r){r.d(n,{CB:function(){return v},V5:function(){return m}});var t=r(8519),i=r(8312),a=(r(7497),r(5927)),c=r(4089),s=r(7719),l=r(9009),o=["instance","fields","children"],u=["onSuccess","onError","onWillSubmit"],d=["label","error"],v=function(e){var n=(0,c.cI)({name:""});return(0,l.jsxs)(f,{context:n,onSubmit:function(r){return r.preventDefault(),(0,s.D)().create(n.values).then((function(n){var r;return null===e||void 0===e||null===(r=e.onSuccess)||void 0===r?void 0:r.call(e,n)})).catch((function(r){var t;n.handleError(r),null===e||void 0===e||null===(t=e.onFailure)||void 0===t||t.call(e,r)}))},children:[(0,l.jsx)("div",{className:"",children:(0,l.jsx)(f.NameField,{error:n.errors.name})}),(0,l.jsx)("div",{className:"my-3",children:(0,l.jsx)(c.ZP.Submit,{value:"Save category",className:"btn btn-primary"})})]})},m=function(e){var n,r,c,s=e.instance,d=void 0===s?(0,a.q9)("Category instance"):s,v=e.fields,m=void 0===v?[]:v,x=e.children,p=(0,i.Z)(e,o),j=p.onSuccess,h=p.onError,g=p.onWillSubmit,b=(0,i.Z)(p,u),S=b.context;return(0,l.jsxs)(f,(0,t.Z)((0,t.Z)({},b),{},{onSubmit:function(e){e.preventDefault(),null===g||void 0===g||g();var n={};return m.forEach((function(e){var r=S.values[e];null!=r&&(n[e]=r)})),d.update(n).then((function(e){return null===j||void 0===j?void 0:j(e)})).catch((function(e){var n;return h?h(e):null===S||void 0===S||null===(n=S.handleError)||void 0===n?void 0:n.call(S,e)}))},children:[m.includes("name")&&(0,l.jsx)(f.NameField,{label:"Nom de la cat\xe9gorie",error:null===S||void 0===S||null===(n=S.errors)||void 0===n?void 0:n.name,text:"Ajoutez un nom qui d\xe9crit cette cat\xe9gorie.\nNous recommandons 65 caract\xe8res au max."}),m.includes("description")&&(0,l.jsx)(f.DescriptionField,{label:"Description",error:null===S||void 0===S||null===(r=S.errors)||void 0===r?void 0:r.description,text:"D\xe9crivez cet cat\xe9gorie."}),m.includes("position")&&(0,l.jsx)(f.PositionField,{label:"Position",error:null===S||void 0===S||null===(c=S.errors)||void 0===c?void 0:c.position}),x]}))},f=function(e){return(0,l.jsx)(c.ZP,(0,t.Z)({},e))};f.NameField=function(e){return(0,l.jsx)(c.wd,(0,t.Z)((0,t.Z)({placeholder:"Entrez le nom de la cat\xe9gorie ..."},e),{},{required:!0}))},f.DescriptionField=function(e){return(0,l.jsx)(c.F$,(0,t.Z)({},e))},f.PositionField=function(e){var n=e.label,r=e.error,a=(0,i.Z)(e,d);return(0,l.jsx)(c.ZP.Field,{label:n,error:r,children:(0,l.jsx)(c.ZP.Text,(0,t.Z)({name:"position",type:"number",min:0},a))})}},8746:function(e,n,r){r.r(n),r.d(n,{default:function(){return x},getImageComponent:function(){return j}});var t=r(8519),i=r(866),a=r(715),c=r(5927),s=r(265),l=r(9544),o=r(4089),u=r(4980),d=r(7719),v=r(1507),m=r(9009),f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:e.name||"",description:e.description||"",is_published:e.is_published||!1,meta_title:e.meta_title||"",meta_slug:(null===e||void 0===e?void 0:e.meta_slug)||"",meta_description:(null===e||void 0===e?void 0:e.meta_description)||""}};function x(){var e=(0,i.UO)().catSlug,n=(0,o.cI)(f()),r=(0,s.QT)((function(){return(0,d.D)({slug:e}).retrieve()}),{refreshDeps:[e],onSuccess:function(e){var r=e.data;document.title="".concat(null===r||void 0===r?void 0:r.name," - Update category"),n.setValues(f(r))},onError:function(e){e.response}}),t=r.res,l=r.updateData,x=new c.HM(t);if(!x.isSuccess)return null;var j=(0,d.D)(x.data),h=function(e){var n=e.data;return l(n)},g=n.errors;return(0,m.jsx)(a.ZP.View,{title:"Modifier cette cat\xe9gorie",back:"../",requiredPerms:["store.change_category"],className:"cat-staff-update-view",children:(0,m.jsxs)("div",{className:"d-grid grid-md-4",children:[(0,m.jsx)("div",{className:"p-md-1",children:(0,m.jsx)("div",{className:"p-1",children:(0,m.jsx)(p,{instance:j,updateData:l})})}),(0,m.jsxs)("div",{className:"span-md-3 span-lg-2",children:[(0,m.jsx)(a.ZP.Section,{title:"Details",children:(0,m.jsx)(v.V5,{context:n,instance:j,fields:["name","description"],onSuccess:h,children:(0,m.jsx)("div",{className:"d-flex justify-content-center",children:(0,m.jsx)(o.ZP.Submit,{value:"Sauvegarder",className:"btn-primary-3 min-w-25"})})})}),(0,m.jsx)(a.ZP.Section,{title:"SEO",children:(0,m.jsxs)(v.V5,{context:n,instance:j,fields:["meta_title","meta_description","meta_slug"],onSuccess:h,children:[(0,m.jsx)(o.lm,{error:g.meta_title}),(0,m.jsx)(o.uV,{error:g.meta_slug}),(0,m.jsx)(o.bA,{error:g.meta_description}),(0,m.jsx)("div",{className:"d-flex justify-content-center",children:(0,m.jsx)(o.ZP.Submit,{value:"Sauvegarder",className:"btn-primary-3 min-w-25"})})]})})]}),(0,m.jsx)("div",{className:"span-lg-1",children:(0,m.jsx)("div",{style:{top:0,position:"sticky"},children:j.is_published?(0,m.jsx)(u.Ko,{instance:j,onSuccess:function(e){var n=e.data;return l(n)},children:"D\xe9publier cette cat\xe9gorie"}):(0,m.jsx)(u.H5,{instance:j,onSuccess:function(e){var n=e.data;return l(n)},onError:function(e){return n.handleError(e)},children:"Publier cette cat\xe9gorie"})})})]})})}var p=function(e){var n=e.updateData,r=e.instance,i=(0,o.cI)({view:"src"}),c=a.ZP.Img((null===r||void 0===r?void 0:r.cover_data)||{});if(null===c||void 0===c||!c.slug)return(0,m.jsx)("div",{className:"d-flex align-items-center justify-content-center flex-column text-center border-1 rounded p-3",children:(0,m.jsx)(a.CD,{onSuccess:function(e){var t=e.data;r.update({cover:t.slug}).then((function(e){var r=e.data;return n(r)})).catch((function(e){}))},label:"Ajouter une image",className:"btn-primary-3 btn-md"})});var s=j(i.values.view);return(0,m.jsx)(o.ZP,{context:i,className:"p-cover-update-form",children:(0,m.jsx)(a.ZP.Section,{border:!0,title:(0,m.jsx)(a.RC,{onSuccess:function(){return n({cover_data:null,cover:null})},instance:c,className:"btn-danger-3",children:(0,m.jsx)(l.PJ.rF,{})}),actions:(0,m.jsx)(a.K7,{required:!0,name:"view"}),className:"p-image-card",children:(0,m.jsx)(a.Cz,{instance:c,field:i.values.view,onSuccess:function(e){var r=e.data;return n({cover:r.slug,cover_data:r})},children:(0,m.jsx)(s,(0,t.Z)({},c))})})})},j=function(e){switch(e){case"mobile":return StaffImg.Mobile;case"square":return StaffImg.Square;case"thumb":return StaffImg.Thumb;case"picture":return StaffImg.Picture;default:return StaffImg.Image}}}}]);
//# sourceMappingURL=746.ebabed13.chunk.js.map