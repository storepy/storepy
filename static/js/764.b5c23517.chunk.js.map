{"version":3,"file":"static/js/764.b5c23517.chunk.js","mappings":"+QAQaA,EAET,SAACC,GACH,IAAQC,EAAwCD,EAAxCC,SAAUC,EAA8BF,EAA9BE,UAAWC,EAAmBH,EAAnBG,QAASC,EAAUJ,EAAVI,MAiBtC,OACE,UAAC,KAAD,CAEEC,MAAOJ,EAASK,WAAa,uBAAyB,6BACtDC,aAAc,kBAAM,gDAAN,EACdC,aAAc,gBAAGC,EAAH,EAAGA,QAAH,OACZ,iBAAKC,UAAU,oDAAf,WACE,SAAC,KAAD,CAAQC,QAAS,kBAAMF,GAAQ,EAAd,EAAjB,sBAEA,SAAC,YAAD,CACEE,QAAS,kBAzBE,SAACF,GAGpBR,EACGW,UACAC,MAAK,SAACC,GACE,OAAPL,QAAO,IAAPA,GAAAA,GAAU,GACD,OAATP,QAAS,IAATA,GAAAA,EAAYY,EACb,IACAC,OAAM,SAACC,GACC,OAAPP,QAAO,IAAPA,GAAAA,GAAU,GACH,OAAPN,QAAO,IAAPA,GAAAA,EAAUa,EACX,GACJ,CAYwBC,CAAaR,EAAnB,EACTC,UAAU,aACVQ,cAAe,CAAC,yBAHlB,yBAJU,EAadC,OAAQ,kBAAM,gBAAKT,UAAU,MAAf,4CAAN,EACRA,UAAU,2CAlBZ,WAoBE,SAAC,QAAD,IACCN,IAAS,iBAAMM,UAAU,QAAhB,SAAyBN,MAGxC,ECjCc,SAASgB,IACtB,MAKIC,EAAAA,WAA4EC,EAAAA,IALhF,IACEC,UAAAA,OADF,MACc,GADd,EAEEC,EAFF,EAEEA,WACAC,EAHF,EAGEA,SACAC,EAJF,EAIEA,UAGF,OAAKD,GAGH,SAAC,UAAD,CACEpB,MAAM,UACNsB,KAAK,gBACLjB,UAAU,iCACVkB,SAAS,gBACTC,OACEL,IACE,0BACE,SAAC,MAAD,kBAAgBA,GAAhB,IAA4BM,UAAWC,EAAAA,GAAAA,KAAYC,IAAE,OAR7D,UAaE,gBAAKtB,UAAU,SAAf,gBACGa,QADH,IACGA,OADH,EACGA,EAAWU,KAAI,SAACC,GAAD,OACd,SAACC,EAAD,CACED,KAAMA,EACNE,WAAY,kBACVV,EACE,YACAH,EAAUc,QAAO,SAACC,GAAD,OAAOA,EAAEC,QAAF,OAAWL,QAAX,IAAWA,OAAX,EAAWA,EAAMK,KAAxB,IAHT,IAMPC,EAAAA,EAAAA,MATO,SAjBA,SAAC,KAAD,GAgCvB,CAED,IAAML,EAAmB,SAAC,GAA2E,IAAD,EAAxED,EAAwE,EAAxEA,KAAME,EAAkE,EAAlEA,WAChC,OACE,SAAC,KAAD,CACEK,QAAM,EACNpC,OACE,4BACE,SAAC,IAAD,CAAc6B,KAAMA,KACpB,iBAAKxB,UAAU,qBAAf,WACE,kBAAMA,UAAU,GAAGL,MAAM,cAAzB,oBACG6B,EAAKQ,aADR,QACiB,IACd,UAEH,kBAAMhC,UAAU,GAAGL,MAAM,eAAzB,UACG6B,EAAKS,aADR,qBASNC,SACE,iBAAKlC,UAAU,SAAf,WACE,SAACX,EAAD,CAAsBE,UAAU4C,EAAAA,EAAAA,GAASX,GAAOhC,UAAWkC,KAC3D,SAAC,IAAD,CAAoBF,KAAMA,EAAMxB,UAAU,oCAA1C,UACE,SAAC,QAAD,SAINA,UAAU,kBAGf,C","sources":["../../../../shopy/shopy-salejs/src/customer/buttons.tsx","../../../../shopy/shopy-salejs/src/customer/views.List.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport type { TCustomerInstance } from './utils';\n\nimport Staff from '@miq/staffjs';\nimport { TFormUpdateProps } from '@miq/formjs';\nimport { Button, ConfirmButton, Icons } from '@miq/componentjs';\n\nexport const CustomerDeleteButton: React.FC<\n  Omit<TFormUpdateProps<{ label?: string; instance: TCustomerInstance }>, 'context'>\n> = (props) => {\n  const { instance, onSuccess, onError, label } = props;\n\n  const handleDelete = (setOpen: any) => {\n    // if (!instance.canDestroy) return;\n\n    instance\n      .destroy()\n      .then((res) => {\n        setOpen?.(false);\n        onSuccess?.(res);\n      })\n      .catch((err: any) => {\n        setOpen?.(false);\n        onError?.(err);\n      });\n  };\n\n  return (\n    <ConfirmButton\n      // disabled={!instance.canDestroy}\n      title={instance.canDestroy ? 'Delete this customer' : \"Can't delete this customer\"}\n      renderHeader={() => <div>Supprimer ce client</div>}\n      renderFooter={({ setOpen }) => (\n        <div className=\"d-flex justify-content-between align-items-center\">\n          <Button onClick={() => setOpen(false)}>Annuler</Button>\n\n          <Staff.Button\n            onClick={() => handleDelete(setOpen)}\n            className=\"btn-danger\"\n            requiredPerms={['sales.delete_customer']}\n          >\n            Supprimer\n          </Staff.Button>\n        </div>\n      )}\n      render={() => <div className=\"p-3\">Veuillez confirmer cette action</div>}\n      className=\"btn-round cus-delete-button btn-danger-3\"\n    >\n      <Icons.Trash />\n      {label && <span className=\"label\">{label}</span>}\n    </ConfirmButton>\n  );\n};\n","import * as React from 'react';\n\nimport { Customer, TCustomer } from './utils';\nimport type { TSDState } from '@miq/contextjs';\n\nimport Staff from '@miq/staffjs';\nimport { uuid } from '@miq/utiljs';\nimport { SharedDataCtx } from '@miq/contextjs';\nimport { Icons, Loading, Pagination, ViewSection } from '@miq/componentjs';\n\nimport { CustomerCard } from './components';\nimport { CustomerUpdateLink } from './links';\nimport { CustomerDeleteButton } from './buttons';\n\ntype TCustomerItem = {\n  slug: TCustomer['slug'];\n  name: TCustomer['name'];\n  orders_count: TCustomer['orders_count'];\n};\n\nexport default function CustomerListView() {\n  const {\n    customers = [],\n    pagination,\n    isLoaded,\n    updateKey,\n  } = React.useContext<TSDState<{ customers: TCustomerItem[]; pagination: any }>>(SharedDataCtx);\n\n  if (!isLoaded) return <Loading />;\n\n  return (\n    <Staff.View\n      title=\"Clients\"\n      back=\"/staff/sales/\"\n      className=\"sales-index-view miq-container\"\n      headerCN=\"miq-container\"\n      footer={\n        pagination && (\n          <div>\n            <Pagination {...pagination} component={Staff.Link} to />\n          </div>\n        )\n      }\n    >\n      <div className=\"d-grid\">\n        {customers?.map((data) => (\n          <CustomerListItem\n            data={data}\n            removeItem={() =>\n              updateKey(\n                'customers',\n                customers.filter((i) => i.slug !== data?.slug)\n              )\n            }\n            key={uuid()}\n          />\n        ))}\n      </div>\n    </Staff.View>\n  );\n}\n\nconst CustomerListItem = ({ data, removeItem }: { data: TCustomerItem; removeItem: () => void }) => {\n  return (\n    <ViewSection\n      border\n      title={\n        <div>\n          <CustomerCard data={data} />\n          <div className=\"text-muted text-sm\">\n            <span className=\"\" title=\"Total spent\">\n              {data.spent ?? '_'}\n              {' / '}\n            </span>\n            <span className=\"\" title=\"Total orders\">\n              {data.orders_count} order(s)\n            </span>\n          </div>\n        </div>\n      }\n      // text={\n\n      // }\n      actions={\n        <div className=\"d-flex\">\n          <CustomerDeleteButton instance={Customer(data)} onSuccess={removeItem} />\n          <CustomerUpdateLink data={data} className=\"btn btn-primary-3 btn-square ms-1\">\n            <Icons.Edit />\n          </CustomerUpdateLink>\n        </div>\n      }\n      className=\"cust-list-item\"\n    />\n  );\n};\n"],"names":["CustomerDeleteButton","props","instance","onSuccess","onError","label","title","canDestroy","renderHeader","renderFooter","setOpen","className","onClick","destroy","then","res","catch","err","handleDelete","requiredPerms","render","CustomerListView","React","SharedDataCtx","customers","pagination","isLoaded","updateKey","back","headerCN","footer","component","Staff","to","map","data","CustomerListItem","removeItem","filter","i","slug","uuid","border","spent","orders_count","actions","Customer"],"sourceRoot":""}