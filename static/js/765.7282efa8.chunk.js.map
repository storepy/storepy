{"version":3,"file":"static/js/765.7282efa8.chunk.js","mappings":"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","sources":["../../../../shopy/shopy-salejs/src/cart/components.tsx","../../../../shopy/shopy-salejs/src/cart/utils.ts","../../../../shopy/shopy-salejs/src/cart/views.List.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport Staff from '@miq/staffjs';\nimport { truncateStr } from '@miq/utiljs';\nimport { ProductPriceDisplay, TProduct, TProductSize } from '@shopy/storejs';\n\nexport const ItemProductCard = ({ product, size }: { product: TProduct; size: TProductSize }) => (\n  <div className=\"d-flex align-items-center\">\n    <ProductImage {...{ product, width: 60, height: 60 }} />\n    <div className=\"flex-1 rounded p-1 \">\n      <div className=\"fw-bold\">{truncateStr(product?.name, 0, 25)}</div>\n      <ProductPriceDisplay {...product} inline />\n      {size && (\n        <div>\n          <span className=\"me-1\">Size:</span>\n          <span className=\"text-sm\">{size?.name}</span>\n        </div>\n      )}\n    </div>\n  </div>\n);\n\nexport const ProductImage = ({\n  product,\n  width,\n  height,\n  ...props\n}: {\n  product: TProduct;\n  width?: number | string;\n  height?: number | string;\n}) =>\n  product?.slug ? (\n    <div {...props} style={{ width: width, height: height }}>\n      <Staff.Img.Square slug=\"slug\" src=\"src\" {...product.cover_data} className=\"rounded\" />\n    </div>\n  ) : null;\n","import { getStaffModel, StaffService } from '@miq/staffjs';\nimport { TPriceData, TProductSize } from '@shopy/storejs';\n\nimport { TCustomer } from '../customer';\n\nconst timeout = 5000;\n\nexport type TAPIOrderItem = {\n  slug: string;\n  product: {\n    // slug: string;\n    meta_slug: string;\n    name: string;\n    name_truncated: string;\n    cover: string;\n    cover_data: {\n      src: string;\n      src_mobile: string;\n      thumb: string;\n      thumb_sq: string;\n      alt_text: string;\n      caption: string;\n    };\n    price: TPriceData;\n    retail_price: string;\n    retail_price_data: TPriceData;\n    sale_price: string;\n    sale_price_data: TPriceData;\n    is_on_sale: boolean;\n    is_oos: boolean;\n  };\n  size: string;\n  size_data: TProductSize;\n  quantity: number;\n};\n\nexport type TAPICart = {\n  slug?: string;\n  customer?: string;\n  customer_name?: string;\n  products?: string[];\n  items?: TAPIOrderItem[];\n};\n\nexport type TOrderItem = Record<string, any> & {\n  order?: string;\n  product?: string;\n  product_data?: any;\n  name?: string;\n  price?: string;\n  size?: string;\n  was_sale?: boolean;\n  img?: string;\n  quantity?: number;\n};\n\nexport type TCart = {\n  slug?: string;\n  customer?: string;\n  customer_name?: string;\n  customer_data?: TCustomer;\n  notes?: string;\n  is_completed?: boolean;\n\n  dt_delivery?: string;\n  items?: TOrderItem[];\n  products?: string[];\n\n  is_placed?: boolean;\n  subtotal?: TPriceData;\n  total?: TPriceData;\n\n  created?: string;\n  updated?: string;\n};\n\nclass CartService extends StaffService<TCart> {\n  get canDestroy(): boolean {\n    return this?.data?.products?.length === 0;\n  }\n\n  place() {\n    return this.post(`${this._path}place/`, {}, { timeout });\n  }\n\n  addItems(values: { size: string; quantity: number; product_slug: string }[]) {\n    return this.post(`${this._path}products/`, values);\n  }\n\n  addItem(prodSlug: string, values: { size: string; quantity: number }) {\n    return this.post(`${this._path}product/${prodSlug}/`, values);\n  }\n\n  updateItem(prodSlug: string, values: Record<string, any>) {\n    return this.post(`${this._path}item/${prodSlug}/`, { ...values }, { timeout });\n  }\n\n  destroyItem(itemSlug: string) {\n    return this.delete(`${this._path}item/${itemSlug}/`, { timeout });\n  }\n}\n\nexport const Cart = getStaffModel<TCart, CartService>('carts', CartService);\n\nexport type TCartInstance = ReturnType<typeof Cart>;\n","import * as React from 'react';\n\nimport Staff from '@miq/staffjs';\nimport { uuid } from '@miq/utiljs';\n\nimport { ProductPriceDisplay } from '@shopy/storejs';\nimport { useDocumentTitle, useRequest, ResultsResponse } from '@miq/hookjs';\nimport { Card, HorizontalScrollGridLayout, Icons, Loading } from '@miq/componentjs';\n\nimport { Cart, TCart } from './utils';\n\nimport { ProductImage } from './components';\nimport { CartDeleteButton, CartUpdateLink } from './buttons';\n\nexport default function CartListView() {\n  useDocumentTitle('Carts - Sales');\n  const { res, loading, refresh } = useRequest(() => Cart({}).list());\n\n  if (loading) return <Loading />;\n\n  const r = new ResultsResponse<TCart>(res);\n  if (!r.isSuccess) return null;\n\n  return (\n    <Staff.View className=\"sales-index-view\">\n      {r.items?.map((i) => {\n        const { customer_data = {}, items = [], products = [] } = i || {};\n        const cart = Cart(i);\n\n        return (\n          <Card\n            // border\n            style={{ marginBottom: 12 }}\n            actions={\n              <div className=\"d-flex\">\n                <CartDeleteButton instance={cart} onSuccess={() => refresh()} />\n                <CartUpdateLink instance={cart} className=\"btn btn-round btn-primary-3 ms-1\">\n                  <Icons.Edit />\n                </CartUpdateLink>\n              </div>\n            }\n            title={<div className=\"\">{`${cart.customer_name}`}</div>}\n            text={new Date(cart?.created!).toLocaleDateString(undefined, {\n              day: '2-digit',\n              weekday: 'short',\n              month: 'short',\n              year: '2-digit',\n            })}\n            footer={\n              products.length > 0 && (\n                <div className=\"fw-bold\">\n                  <ProductPriceDisplay retail_price_data={i?.total || i?.subtotal} />\n                </div>\n              )\n            }\n            key={i.slug}\n            className=\"mb-1\"\n          >\n            {items.length > 0 && (\n              <HorizontalScrollGridLayout className=\"cart-items-preview\" style={{ marginBottom: 0 }}>\n                {items.map((i) => {\n                  return (\n                    <div key={uuid()}>\n                      <ProductImage product={i.product} {...{ width: 48, height: 48 }} />\n                    </div>\n                  );\n                })}\n              </HorizontalScrollGridLayout>\n            )}\n          </Card>\n        );\n      })}\n    </Staff.View>\n  );\n}\n"],"names":["ItemProductCard","product","size","className","ProductImage","width","height","truncateStr","name","inline","props","slug","style","src","cover_data","timeout","CartService","this","data","products","length","post","_path","values","prodSlug","itemSlug","delete","StaffService","Cart","getStaffModel","CartListView","useDocumentTitle","useRequest","list","res","loading","refresh","r","ResultsResponse","isSuccess","items","map","i","customer_data","cart","marginBottom","actions","instance","onSuccess","title","customer_name","text","Date","created","toLocaleDateString","undefined","day","weekday","month","year","footer","retail_price_data","total","subtotal","uuid"],"sourceRoot":""}