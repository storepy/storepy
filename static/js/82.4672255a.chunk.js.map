{"version":3,"file":"static/js/82.4672255a.chunk.js","mappings":"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","sources":["../../../../shopy/shopy-salejs/src/cart/utils.ts","../../../../shopy/shopy-salejs/src/cart/views.List.tsx"],"sourcesContent":["import { getStaffModel, StaffService } from '@miq/staffjs';\nimport { TPriceData, TProductSize } from '@shopy/storejs';\n\nimport type { TDiscount } from '../discount/types';\nimport type { TCustomer } from '../customer';\n\nconst timeout = 5000;\n//     ^?\n\nexport type TAPIOrderItem = {\n  slug: string;\n  product: {\n    // slug: string;\n    meta_slug: string;\n    name: string;\n    name_truncated: string;\n    cover: string;\n    cover_data: {\n      src: string;\n      src_mobile: string;\n      thumb: string;\n      thumb_sq: string;\n      alt_text: string;\n      caption: string;\n    };\n    price: TPriceData;\n    retail_price: string;\n    retail_price_data: TPriceData;\n    sale_price: string;\n    sale_price_data: TPriceData;\n    is_on_sale: boolean;\n    is_oos: boolean;\n  };\n  size: string;\n  size_data: TProductSize;\n  quantity: number;\n};\n\nexport type TAPICart = {\n  slug?: string;\n  customer?: string;\n  customer_name?: string;\n  products?: string[];\n  items?: TAPIOrderItem[];\n};\n\nexport type TOrderItem = Record<string, any> & {\n  order?: string;\n  product?: string;\n  product_data?: any;\n  name?: string;\n  price?: string;\n  size?: string;\n  was_sale?: boolean;\n  img?: string;\n  quantity?: number;\n};\n\nexport type TCart = {\n  slug?: string;\n  customer?: string;\n  customer_name?: string;\n  customer_data?: TCustomer;\n  notes?: string;\n  is_paid?: boolean;\n  discounts?: TDiscount[];\n\n  dt_delivery?: string;\n  items?: TOrderItem[];\n  products?: string[];\n\n  is_placed?: boolean;\n  subtotal?: TPriceData;\n  total?: TPriceData;\n\n  created?: string;\n  updated?: string;\n};\n\nclass CartService extends StaffService<TCart> {\n  get createdDt() {\n    return this.data?.created\n      ? new Date(this.data.created!).toLocaleDateString(undefined, {\n          day: '2-digit',\n          weekday: 'short',\n          month: 'short',\n          year: '2-digit',\n        })\n      : null;\n  }\n\n  get canDestroy(): boolean {\n    return this?.data?.products?.length === 0;\n  }\n\n  mark_paid() {\n    return this.post(`${this._path}pay/`, {}, { timeout });\n  }\n\n  place() {\n    return this.post(`${this._path}place/`, {}, { timeout });\n  }\n\n  postDiscount(values: Exclude<TDiscount, 'slug' | 'amt_data'>) {\n    return this.post(`${this._path}discount/`, values);\n  }\n  destroyDiscount(discountSlug: string) {\n    return this.delete(`${this._path}discount/${discountSlug}/`);\n  }\n\n  addItems(values: { size: string; quantity: number; product_slug: string }[]) {\n    return this.post(`${this._path}products/`, values);\n  }\n\n  addItem(prodSlug: string, values: { size: string; quantity: number }) {\n    return this.post(`${this._path}product/${prodSlug}/`, values);\n  }\n\n  updateItem(prodSlug: string, values: Record<string, any>) {\n    return this.post(`${this._path}item/${prodSlug}/`, { ...values }, { timeout });\n  }\n\n  destroyItem(itemSlug: string) {\n    return this.delete(`${this._path}item/${itemSlug}/`, { timeout });\n  }\n}\n\nexport const Cart = getStaffModel<TCart, CartService>('carts', CartService);\n\nexport type TCartInstance = ReturnType<typeof Cart>;\n//            ^?\n","import * as React from 'react';\n\nimport './views.list.scss';\n\nimport Staff from '@miq/staffjs';\nimport { ProductPriceDisplay } from '@shopy/storejs';\nimport { Card, Icons, Loading } from '@miq/componentjs';\nimport { useDocumentTitle, useRequest, ResultsResponse } from '@miq/hookjs';\n\nimport { Cart, TCart } from './utils';\nimport { CartDeleteButton, CartUpdateLink } from './buttons';\n\nexport default function CartListView() {\n  useDocumentTitle('Carts - Sales');\n  const { res, loading, refresh } = useRequest(() => Cart({}).list());\n\n  if (loading) return <Loading />;\n\n  const r = new ResultsResponse<TCart>(res);\n  if (!r.isSuccess) return null;\n\n  return (\n    <Staff.View\n      title=\"Paniers\"\n      back=\"/staff/sales/\"\n      className=\"sales-index-view miq-container\"\n      headerCN=\"miq-container\"\n    >\n      {r.items?.map((i) => {\n        const { products = [] } = i || {};\n        const cart = Cart(i);\n\n        return (\n          <Card\n            // border\n            style={{ marginBottom: 12 }}\n            actions={\n              <div className=\"d-flex\">\n                {!cart?.is_placed && <CartDeleteButton instance={cart} onSuccess={() => refresh()} />}\n\n                <CartUpdateLink reloadDocument={false} instance={cart} className=\"btn btn-round btn-primary-3 ms-1\">\n                  <Icons.Edit />\n                </CartUpdateLink>\n              </div>\n            }\n            title={<div className=\"\">{`${cart.customer_name}`}</div>}\n            key={i.slug}\n            className=\"cart-list-item-card mb-1\"\n          >\n            <ul className=\"text-sm\">\n              <li className=\"d-flex align-items-center justify-content-between\">\n                <span className=\"\">{products.length} produit(s)</span>\n                {products.length > 0 && (\n                  <span className=\"fw-bold\">\n                    <ProductPriceDisplay retail_price_data={i?.total || i?.subtotal} />\n                  </span>\n                )}\n              </li>\n              <li className=\"text-sm text-muted\">{cart.createdDt}</li>\n            </ul>\n          </Card>\n        );\n      })}\n    </Staff.View>\n  );\n}\n"],"names":["timeout","CartService","this","data","created","Date","toLocaleDateString","undefined","day","weekday","month","year","products","length","post","_path","values","discountSlug","delete","prodSlug","itemSlug","StaffService","Cart","getStaffModel","CartListView","useDocumentTitle","useRequest","list","res","loading","refresh","r","ResultsResponse","isSuccess","title","back","className","headerCN","items","map","i","cart","style","marginBottom","actions","is_placed","instance","onSuccess","reloadDocument","customer_name","retail_price_data","total","subtotal","createdDt","slug"],"sourceRoot":""}