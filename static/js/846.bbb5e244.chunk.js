"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[846],{474:function(t,e,n){n.d(e,{A:function(){return u}});var i=n(3872),s=n(5561),a=n(1253),r=n(4733),c=n(2562),l=n(5789),d=5e3,o=function(t){(0,r.Z)(n,t);var e=(0,c.Z)(n);function n(){return(0,s.Z)(this,n),e.apply(this,arguments)}return(0,a.Z)(n,[{key:"createdDt",get:function(){var t;return null!==(t=this.data)&&void 0!==t&&t.created?new Date(this.data.created).toLocaleDateString(void 0,{day:"2-digit",weekday:"short",month:"short",year:"2-digit"}):null}},{key:"canDestroy",get:function(){var t,e;return 0===(null===this||void 0===this||null===(t=this.data)||void 0===t||null===(e=t.products)||void 0===e?void 0:e.length)}},{key:"mark_paid",value:function(){return this.post("".concat(this._path,"pay/"),{},{timeout:d})}},{key:"place",value:function(){return this.post("".concat(this._path,"place/"),{},{timeout:d})}},{key:"addItems",value:function(t){return this.post("".concat(this._path,"products/"),t)}},{key:"addItem",value:function(t,e){return this.post("".concat(this._path,"product/").concat(t,"/"),e)}},{key:"updateItem",value:function(t,e){return this.post("".concat(this._path,"item/").concat(t,"/"),(0,i.Z)({},e),{timeout:d})}},{key:"destroyItem",value:function(t){return this.delete("".concat(this._path,"item/").concat(t,"/"),{timeout:d})}}]),n}(l.x5),u=(0,l.QY)("carts",o)},7846:function(t,e,n){n.r(e),n.d(e,{ProductAddForm:function(){return _},default:function(){return N}});var i=n(4384),s=n(3872),a=n(7406),r=n(9996),c=n(9157),l=n(5789),d=n(9576),o=n(9474),u=n(810),m=n(2050),h=n(3088),v=n(474),f=n(2444),x=n(7494),p=n(9450),j=n(7532),b=n(7457),y=["item","onItemClick"],g=a.lazy((function(){return n.e(221).then(n.bind(n,8221))}));function N(){var t,e,n,i;(0,o.jr)("Place cart - Sales");var d=(0,r.UO)().cartSlug,y=a.useContext(p.h2),N=y.cart,_=(0,r.s0)();if(d!==(null===N||void 0===N?void 0:N.slug)||!y.isLoaded)return(0,b.jsx)(m.gb,{});var Z=(0,v.A)(N||{});return null!==Z&&void 0!==Z&&Z.is_placed?(0,b.jsx)(g,{cart:Z,onSuccess:function(){_("../")}}):(0,b.jsx)(l.ZP.View,{title:"Panier",text:"Verifiez les informations du client et du panier avant de confirmer. Un panier sans produits ne peut pas \xeatre confirm\xe9.",actions:(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(c.rU,{to:"/staff/sales/carts/".concat(null===Z||void 0===Z?void 0:Z.slug,"/items/"),className:"btn-primary-3 btn-round",title:"Ajouter des produits",children:(0,b.jsx)(m.PJ.HB,{})})}),back:"/staff/sales/carts",headerCN:"miq-container center",children:(0,b.jsxs)("div",{className:"miq-container center",children:[(0,b.jsx)(l.ZP.Section,{border:!0,title:"Panier (".concat(null===Z||void 0===Z||null===(t=Z.products)||void 0===t?void 0:t.length," produits)"),footer:(0,b.jsxs)("div",{className:"",children:[(0,b.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,b.jsx)("span",{className:"",children:"Subtotal"}),(0,b.jsx)("span",{children:(0,b.jsx)(h._S,{retail_price_data:null===Z||void 0===Z?void 0:Z.subtotal})})]}),(0,b.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,b.jsx)("span",{className:"",children:"Total"}),(0,b.jsx)("span",{className:"fw-bold",children:(0,b.jsx)(h._S,{retail_price_data:null===Z||void 0===Z?void 0:Z.subtotal})})]})]}),children:Z&&(null===Z||void 0===Z||null===(e=Z.items)||void 0===e?void 0:e.length)>0?(0,b.jsx)(b.Fragment,{children:null===(n=Z.items)||void 0===n?void 0:n.map((function(t){return(0,b.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,b.jsx)(x.n,(0,s.Z)((0,s.Z)({},t),{},{size:t.size_data})),(0,b.jsx)("div",{children:(0,b.jsx)(j.uf,{cartInstance:Z,itemSlug:null===t||void 0===t?void 0:t.slug,onSuccess:function(t){y.updateData({cart:t.data})}})})]},(0,u.Vj)())}))}):(0,b.jsx)(b.Fragment,{children:"Ajouter"})}),(0,b.jsx)(l.ZP.Section,{border:!0,title:"Client",children:(0,b.jsx)(f.CustomerCard,{data:Z.customer_data})}),(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)(m.zx,{onClick:function(){Z.place().then((function(t){y.updateData({cart:t.data})})).catch((function(t){return console.log(t)}))},disabled:(null===Z||void 0===Z||null===(i=Z.products)||void 0===i?void 0:i.length)<=0,className:"btn-primary btn-md fw-bold w-50",children:"Confirmer"})})]})})}var _=function(t){var e,n=t.item,a=t.onItemClick,r=((0,i.Z)(t,y),(0,d.cI)({quantity:1,size:""}));if(null===n||void 0===n||!n.slug)return null;var c=n.sizes,o=void 0===c?[]:c,m=n.cover_data,v=n.name;return(0,b.jsx)(d.ZP,{context:r,onSubmit:function(t){t.preventDefault(),a(n,r.values.size,r.values.quantity).catch((function(t){r.handleError(t)}))},children:(0,b.jsx)(l.ZP.Section,{border:!0,header:(0,b.jsxs)("div",{className:"d-flex",children:[(0,b.jsx)("div",{style:{minWidth:34,maxWidth:50},className:"me-1",children:(0,b.jsx)(l.ZP.Img.Thumb,(0,s.Z)((0,s.Z)({src:"src"},m),{},{className:"rounded"}))}),(0,b.jsxs)("div",{className:"flex-1",title:v,children:[(0,b.jsx)("div",{className:"text-ellipsis text-sm",children:(0,b.jsx)("span",{className:"me-1 fw-bold",children:(0,u.bI)(v,0,45)})}),(0,b.jsxs)("div",{className:"d-flex flex-column flex-md-ro justify-content-between",children:[(0,b.jsxs)("div",{className:"d-grid grid-md-2 gap-1 flex-1",children:[(0,b.jsx)(h.D8,{required:!0,sizes:o.filter((function(t){return t.quantity>0})),error:r.errors.size}),(0,b.jsx)(h.PI,{max:(null===(e=o.find((function(t){return t.slug===r.values.size})))||void 0===e?void 0:e.quantity)||0,min:1})]}),(0,b.jsx)("div",{className:"text-right",children:(0,b.jsx)(d.ZP.Submit,{className:"btn btn-primary-2 btn-md fw-bold",children:"Ajouter"})})]})]})]}),actions:(0,b.jsx)(h._S,(0,s.Z)((0,s.Z)({},n),{},{className:"d-flex flex-wrap"})),className:"mb-1"})})}}}]);
//# sourceMappingURL=846.bbb5e244.chunk.js.map