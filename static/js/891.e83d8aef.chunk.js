"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[891],{2891:function(n,e,t){t.r(e),t.d(e,{default:function(){return f}});var r=t(8312),i=t(8519),a=t(6113),o=t(7497),s=t(715),d=t(5927),c=t(9544),u=t(8876),l=t(9009),g=["img"],m=function(n){var e=n.img,t=(0,r.Z)(n,g),a=t.order,o=t.setOrder,d=t.onOrderChange;return(0,l.jsx)("div",{draggable:!0,onDragEnter:function(n){return o(e)},onDragEnd:function(n){a&&a.slug!==e.slug&&(0,s.pB)(e).swapPosition(a.slug,a.position).then((function(n){var e=n.data;return d(e)})).catch((function(n){console.error(n)}))},children:(0,l.jsx)(s.pB.Square,(0,i.Z)((0,i.Z)({},e),{},{className:"rounded"}))})},v=function(n){return(0,l.jsx)(s.RC,(0,i.Z)((0,i.Z)({},n),{},{children:(0,l.jsx)(c.PJ.rF,{})}))},p=["img","actions"];function f(n){var e,t=n.instance,r=n.onUpdate,g=t.cover_data,v=t.images_data,p=o.useState(!1),f=(0,a.Z)(p,2),h=f[0],Z=f[1],b=o.useState(null),N=(0,a.Z)(b,2),_=N[0],C=N[1];return(0,l.jsx)(s.ZP.Section,{title:(0,l.jsxs)(u.n9,{productInstance:t,onSuccess:function(n){return null===r||void 0===r?void 0:r(n.data)},className:"d-flex align-items-center",children:[(0,l.jsx)(c.PJ.nH,{}),(0,l.jsx)("span",{className:"ms-1 d-none d-md-block",children:"Upload images"})]}),actions:(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"d-none d-md-block",children:(0,l.jsx)(c.zx,{onClick:function(){return Z(!h)},className:(0,d.UT)(["btn-round",h?"btn-primary":"btn-secondary-4"]),children:(0,l.jsx)(c.PJ.v0,{})})})}),children:h?(0,l.jsx)("div",{className:"d-grid grid-3 gap-2",children:null===v||void 0===v?void 0:v.map((function(n){return(0,o.createElement)(m,{img:n,order:_,setOrder:C,onOrderChange:function(n){null===r||void 0===r||r((0,i.Z)((0,i.Z)({},t.export()),{},{images_data:v.map((function(e){var t,r;return e.slug===(null===n||void 0===n||null===(t=n.to)||void 0===t?void 0:t.slug)?null===n||void 0===n?void 0:n.from:e.slug===(null===n||void 0===n||null===(r=n.from)||void 0===r?void 0:r.slug)?null===n||void 0===n?void 0:n.to:e}))})),C(null)},key:n.slug})}))}):(0,l.jsxs)("div",{className:"d-grid grid-2 grid-md-3 grid-lg-4 gap-2",children:[(0,l.jsx)(x,{img:(0,s.pB)(g),productInstance:t,onUpdate:r}),null===t||void 0===t||null===(e=t.images_data)||void 0===e?void 0:e.map((function(n){var e=(0,s.pB)(n);return(0,l.jsx)(j,{img:e,actions:(0,l.jsx)(s.ZP.Button,{onClick:function(){return t.swapCover(e.slug).then((function(n){var e=n.data;return r(e)}))},children:"Set as cover"}),onDelete:function(){return r((0,i.Z)((0,i.Z)({},t.export()),{},{images_data:t.images_data.filter((function(n){return n.slug!==e.slug})),images:t.images.filter((function(n){return n!==e.slug}))}))}},e.slug)}))]})})}var x=function(n){var e=n.img,t=n.onUpdate,r=n.productInstance;return e.slug?(0,l.jsx)(j,(0,i.Z)((0,i.Z)({},n),{},{onDelete:function(){return t((0,i.Z)((0,i.Z)({},r.export()),{},{cover_data:void 0,cover:void 0}))}})):(0,l.jsxs)("div",{className:"p-cover-add-btn d-flex align-items-center justify-content-center flex-column text-center border-1 rounded p-3",children:[(0,l.jsx)("p",{className:"text-sm text-muted mb-3",children:"Ce produit n'a pas d'image principale"}),(0,l.jsx)(s.CD,{onSuccess:function(n){r.update({cover:null===n||void 0===n?void 0:n.data.slug}).then((function(n){return t(null===n||void 0===n?void 0:n.data)})).catch((function(n){}))},label:"Ajouter une image",className:"btn-primary-3 btn-md"})]})},j=function(n){var e=n.img,t=n.actions,a=(0,r.Z)(n,p);return(0,l.jsx)(s.ZP.Section,{border:!0,title:(0,l.jsx)(v,{onSuccess:function(n){return a.onDelete(null===n||void 0===n?void 0:n.data)},instance:e,className:"btn-danger-3"}),actions:t,className:"p-image-card",children:(0,l.jsx)(s.pB.Image,(0,i.Z)({},e.export()))})}}}]);
//# sourceMappingURL=891.e83d8aef.chunk.js.map