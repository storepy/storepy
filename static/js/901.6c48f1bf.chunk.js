"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[901],{4901:function(e,n,t){t.r(n),t.d(n,{default:function(){return te}});var r=t(2551),i=t(3872),a=t(7406),s=t(3041),l=t(8427),o=t(6851),c=t(5789),d=t(9576),u=t(2050),x=t(810),m=t(201),p=t(6567),v=t(2988),j=t(1910),f=t(2106),b=t(1475),h=t(7457),g=window.i18n;function Z(e){var n=e.form,t=e.instance,r=e.onUpdate,a=n.errors;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"border-bottom mb-4",children:(0,h.jsx)(S,(0,i.Z)({},e))}),(0,h.jsx)(c.ZP.Section,{title:g(o.Z,"SeoTab.title"),children:(0,h.jsxs)(b.Eh,{context:n,instance:t,fields:["meta_title","meta_description","meta_slug"],onSuccess:function(e){var n=e.data;return r(n)},children:[(0,h.jsx)(d.lm,{error:a.meta_title}),(0,h.jsx)(d.uV,{error:a.meta_slug}),(0,h.jsx)(d.bA,{error:a.meta_description}),(0,h.jsx)("div",{className:"d-flex justify-content-center",children:(0,h.jsx)(d.ZP.Submit,{value:g(o.Z,"Btn.saveLabel"),className:"btn-primary-3 btn-md min-w-25 fw-bold"})})]})})]})}var _=["name","category","description","retail_price","is_pre_sale","is_pre_sale_text","is_pre_sale_dt","is_on_sale","sale_price","is_oos","is_explicit"],S=function(e){var n=e.form,t=e.instance,r=e.categories,a=e.onUpdate,s=n.errors,l={title:g(o.Z,"InfoTab.title"),text:g(o.Z,"InfoTab.text")};return(0,h.jsx)(b.Eh,{context:n,instance:t,fields:_,onSuccess:function(e){var n=e.data;return a(n)},children:(0,h.jsxs)(c.ZP.Section,(0,i.Z)((0,i.Z)({},l),{},{footer:(0,h.jsx)("div",{className:"d-flex justify-content-center",children:(0,h.jsx)(d.ZP.Submit,{value:g(o.Z,"Btn.saveLabel"),className:"btn-md btn-primary min-w-25 fw-bold"})}),children:[(0,h.jsx)(b.HG.NameField,{error:s.name,label:window.i18n(f.Z,"NField.label"),text:window.i18n(f.Z,"NField.text")}),(0,h.jsxs)("div",{className:"d-grid grid-md-2 gap-1",children:[(0,h.jsx)(b.HG.CategoryField,{error:s.category,categories:r,label:window.i18n(f.Z,"CatField.label")}),(0,h.jsx)(b.HG.RetailPriceField,{label:window.i18n(f.Z,"RetailPField.label"),error:s.retail_price})]}),(0,h.jsx)(b.HG.PresaleCheckboxField,{error:s.is_pre_sale,label:window.i18n(f.Z,"PresaleField.label")}),n.values.is_pre_sale&&(0,h.jsx)(b.HG.PresaleTextField,{text:window.i18n(f.Z,"PresaleTextField.text"),error:s.is_pre_sale_text}),(0,h.jsx)(b.HG.OnSaleCheckboxField,{error:s.is_on_sale,label:window.i18n(f.Z,"OnsaleField.label")}),n.values.is_on_sale&&(0,h.jsx)(b.HG.SalePriceField,{label:window.i18n(f.Z,"SalePField.label"),error:s.sale_price}),(0,h.jsx)(b.HG.DescriptionField,{error:s.description,label:window.i18n(f.Z,"DField.label"),text:window.i18n(f.Z,"DField.text")}),(0,h.jsx)("div",{className:"my-4",children:(0,h.jsx)(b.HG.OosCheckboxField,{error:s.is_oos})}),(0,h.jsx)("div",{className:"my-4",children:(0,h.jsx)(b.HG.IsExplicitCheckboxField,{error:s.is_explicit})})]}))})},N=t(4384),w=t(1161),P=["img"],y=function(e){var n=e.img,t=(0,N.Z)(e,P),r=t.order,a=t.setOrder,s=t.onOrderChange;return(0,h.jsx)("div",{draggable:!0,onDragEnter:function(e){return a(n)},onDragEnd:function(e){r&&r.slug!==n.slug&&(0,c.pB)(n).swapPosition(r.slug,r.position).then((function(e){var n=e.data;return s(n)})).catch((function(e){console.error(e)}))},children:(0,h.jsx)(c.pB.Square,(0,i.Z)((0,i.Z)({},n),{},{className:"rounded"}))})},F=function(e){return(0,h.jsx)(c.RC,(0,i.Z)((0,i.Z)({},e),{},{children:(0,h.jsx)(u.PJ.rF,{})}))},I=["img","actions"];function T(e){var n,t=e.instance,s=e.onUpdate,l=t.cover_data,o=t.images_data,d=a.useState(!1),m=(0,r.Z)(d,2),p=m[0],v=m[1],j=a.useState(null),f=(0,r.Z)(j,2),b=f[0],g=f[1];return(0,h.jsx)(c.ZP.Section,{title:(0,h.jsxs)(w.n9,{productInstance:t,onSuccess:function(e){return null===s||void 0===s?void 0:s(e.data)},className:"d-flex align-items-center",children:[(0,h.jsx)(u.PJ.nH,{}),(0,h.jsx)("span",{className:"ms-1 d-none d-md-block",children:"Upload images"})]}),actions:(0,h.jsx)(h.Fragment,{children:(0,h.jsx)("div",{className:"d-none d-md-block",children:(0,h.jsx)(u.zx,{onClick:function(){return v(!p)},className:(0,x.UT)(["btn-round",p?"btn-primary":"btn-secondary-4"]),children:(0,h.jsx)(u.PJ.v0,{})})})}),children:p?(0,h.jsx)("div",{className:"d-grid grid-3 gap-2",children:null===o||void 0===o?void 0:o.map((function(e){return(0,a.createElement)(y,{img:e,order:b,setOrder:g,onOrderChange:function(e){null===s||void 0===s||s((0,i.Z)((0,i.Z)({},t.export()),{},{images_data:o.map((function(n){var t,r;return n.slug===(null===e||void 0===e||null===(t=e.to)||void 0===t?void 0:t.slug)?null===e||void 0===e?void 0:e.from:n.slug===(null===e||void 0===e||null===(r=e.from)||void 0===r?void 0:r.slug)?null===e||void 0===e?void 0:e.to:n}))})),g(null)},key:e.slug})}))}):(0,h.jsxs)("div",{className:"d-grid grid-2 grid-md-3 grid-lg-4 gap-2",children:[(0,h.jsx)(k,{img:(0,c.pB)(l),productInstance:t,onUpdate:s}),null===t||void 0===t||null===(n=t.images_data)||void 0===n?void 0:n.map((function(e){var n=(0,c.pB)(e);return(0,h.jsx)(C,{img:n,actions:(0,h.jsx)(c.ZP.Button,{onClick:function(){return t.swapCover(n.slug).then((function(e){var n=e.data;return s(n)}))},children:"Set as cover"}),onDelete:function(){return s((0,i.Z)((0,i.Z)({},t.export()),{},{images_data:t.images_data.filter((function(e){return e.slug!==n.slug})),images:t.images.filter((function(e){return e!==n.slug}))}))}},n.slug)}))]})})}var k=function(e){var n=e.img,t=e.onUpdate,r=e.productInstance;return n.slug?(0,h.jsx)(C,(0,i.Z)((0,i.Z)({},e),{},{onDelete:function(){return t((0,i.Z)((0,i.Z)({},r.export()),{},{cover_data:void 0,cover:void 0}))}})):(0,h.jsxs)("div",{className:"p-cover-add-btn d-flex align-items-center justify-content-center flex-column text-center border-1 rounded p-3",children:[(0,h.jsx)("p",{className:"text-sm text-muted mb-3",children:"Ce produit n'a pas d'image principale"}),(0,h.jsx)(c.CD,{onSuccess:function(e){r.update({cover:null===e||void 0===e?void 0:e.data.slug}).then((function(e){return t(null===e||void 0===e?void 0:e.data)})).catch((function(e){}))},label:"Ajouter une image",className:"btn-primary-3 btn-md"})]})},C=function(e){var n=e.img,t=e.actions,r=(0,N.Z)(e,I);return(0,h.jsx)(c.ZP.Section,{border:!0,title:(0,h.jsx)(F,{onSuccess:function(e){return r.onDelete(null===e||void 0===e?void 0:e.data)},instance:n,className:"btn-danger-3"}),actions:t,className:"p-image-card",children:(0,h.jsx)(c.pB.Image,(0,i.Z)({},n.export()))})},A=t(6009),D=["data","productInstance"],L=["onSuccess","onFailure"];function U(e){var n=e.data,t=e.productInstance,r=(0,N.Z)(e,D);if(null===n||void 0===n||!n.slug||null===t||void 0===t||!t.slug)return null;var a=r.onSuccess,s=r.onFailure,l=(0,N.Z)(r,L);return(0,h.jsx)(u.pu,(0,i.Z)((0,i.Z)({},l),{},{renderHeader:function(){return(0,h.jsx)("div",{children:"Supprimer un attribut"})},renderFooter:function(e){var r=e.setOpen;return(0,h.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,h.jsx)(u.zx,{onClick:function(){return r(!1)},children:"Annuler"}),(0,h.jsx)(u.zx,{onClick:function(){return t.deleteAttribute(n.slug).then((function(e){return r(!1),null===a||void 0===a?void 0:a(e)})).catch((function(e){return null===s||void 0===s?void 0:s(e)}))},className:"btn-danger",children:"Supprimer"})]})},render:function(){return(0,h.jsxs)("div",{className:"p-3",children:["Are you sure you want to delete this attribute:",(0,h.jsx)("div",{className:"fw-bold",children:n.name})]})},className:"attr-delete-button btn-danger-3",children:(0,h.jsx)(u.PJ.rF,{})}))}var B=["data","productInstance"],H=["productInstance"],E=["label","text","error","placeholder"],G=["label","text","error","placeholder"],K=function(e){var n=e.data,t=e.productInstance,r=(0,N.Z)(e,B),i=(0,d.cI)({name:n.name||"",value:n.value||""});if(null===n||void 0===n||!n.slug||null===t||void 0===t||!t.slug)return null;var a=r.onSuccess,s=r.onFailure;return(0,h.jsx)(d.ZP,{context:i,onSubmit:function(e){e.preventDefault(),t.patchAttribute(n.slug,i.values).then((function(e){return null===a||void 0===a?void 0:a(e)})).catch((function(e){return i.handleError(e),null===s||void 0===s?void 0:s(e)}))},children:(0,h.jsxs)("div",{className:"d-grid grid-md-6 gap-1",children:[(0,h.jsx)("div",{className:"span-md-2",children:(0,h.jsx)(V,{error:i.errors.name})}),(0,h.jsx)("div",{className:"span-md-3",children:(0,h.jsx)(q,{error:i.errors.value,className:""})}),(0,h.jsxs)("div",{className:"span-md-1",children:[(0,h.jsx)(d.ZP.Submit,{value:"Save",className:"btn-primary-2 me-2"}),(0,h.jsx)(U,{productInstance:t,data:n,onSuccess:a,onFailure:s})]})]})})},O={name:"",value:""},z=function(e){var n=e.productInstance,t=(0,N.Z)(e,H),r=(0,d.cI)(O);return null!==n&&void 0!==n&&n.slug?(0,h.jsx)(d.ZP,{context:r,onSubmit:function(e){e.preventDefault(),n.postAttribute(r.values).then((function(e){var n;return r.setValues(O),null===t||void 0===t||null===(n=t.onSuccess)||void 0===n?void 0:n.call(t,e)})).catch((function(e){var n;return r.handleError(e),null===t||void 0===t||null===(n=t.onFailure)||void 0===n?void 0:n.call(t,e)}))},children:(0,h.jsxs)("div",{className:"d-grid grid-md-6 gap-1",children:[(0,h.jsx)("div",{className:"span-md-2",children:(0,h.jsx)(V,{error:r.errors.name})}),(0,h.jsx)("div",{className:"span-md-3",children:(0,h.jsx)(q,{error:r.errors.value,className:""})}),(0,h.jsx)("div",{className:"span-md-1",children:(0,h.jsx)(d.ZP.Submit,{value:"Save",className:"btn-primary-2"})})]})}):null},V=function(e){var n=e.label,t=e.text,r=e.error,a=e.placeholder,s=void 0===a?"Entrez le nom de l'attribut ...":a,l=(0,N.Z)(e,E);return(0,h.jsx)(d.ZP.Field,{label:n,text:t,error:r,children:(0,h.jsx)(d.ZP.Text,(0,i.Z)((0,i.Z)({placeholder:s,maxLength:30,minLength:2},l),{},{required:!0,name:"name"}))})},q=function(e){var n=e.label,t=e.text,r=e.error,a=e.placeholder,s=void 0===a?"Entrez la valuer de l'attribut ...":a,l=(0,N.Z)(e,G);return(0,h.jsx)(d.ZP.Field,{label:n,text:t,error:r,children:(0,h.jsx)(d.ZP.Text,(0,i.Z)((0,i.Z)({placeholder:s,maxLength:99,minLength:2},l),{},{required:!0,name:"value"}))})},M=window.i18n,J=function(e){var n,t=a.useState(!1),i=(0,r.Z)(t,2),s=i[0],l=i[1],o=e.instance,d=e.onUpdate;return(0,h.jsxs)(c.ZP.Section,{title:"Tailles",text:"Ajouter des tailles",actions:(0,h.jsx)(u.zx,{onClick:function(){return l(!s)},className:"btn-primary-3",children:"Ajouter une taille"}),children:[s&&(0,h.jsx)(c.ZP.Section,{text:"Ajouter une taille",children:(0,h.jsx)(A.T9,{productInstance:o,onSuccess:function(e){var n=e.data;return d(n)}})}),null===(n=o.sizes)||void 0===n?void 0:n.map((function(e){return(0,h.jsx)(A.dh,{data:e,productInstance:o,onSuccess:function(e){var n=e.data;return d(n)}},e.slug)}))]})},R=function(e){var n,t=e.instance,i=e.onUpdate,s=a.useState(!1),l=(0,r.Z)(s,2),o=l[0],d=l[1];return(0,h.jsxs)(c.ZP.Section,{title:"Attributs",actions:(0,h.jsx)(u.zx,{onClick:function(){return d(!o)},className:"btn-primary-3",children:"Ajouter un attribut"}),children:[o&&(0,h.jsx)(c.ZP.Section,{text:"Ajouter un attribut au produit.",children:(0,h.jsx)(z,{productInstance:t,onSuccess:function(e){var n=e.data;return i(n)}})}),null===t||void 0===t||null===(n=t.attributes)||void 0===n?void 0:n.map((function(e){return(0,h.jsx)("div",{className:"mb-1",children:(0,h.jsx)(K,{data:e,productInstance:t,onSuccess:function(e){var n=e.data;return i(n)}})},e.slug)}))]})};function X(e){return(0,h.jsxs)(c.ZP.Section,{title:M(o.Z,"InventoryTab.title"),children:[(0,h.jsx)(J,(0,i.Z)({},e)),(0,h.jsx)(R,(0,i.Z)({},e))]})}var Q=window.i18n;function W(e){var n=(0,s.s0)(),t=e.instance,r=e.to;return(0,h.jsx)(c.ZP.Section,{title:Q(o.Z,"SettingsTab.title"),children:(0,h.jsx)(c.ZP.Section,{title:Q(o.Z,"SettingsTab.deleteSectionTitle"),actions:(0,h.jsx)(w.sq,{instance:t,onSuccess:function(){return n(r)},onFailure:function(e){404===e.status&&n("../")}})})})}var Y=t(9450),$=function(e){return window.i18n(o.Z,e)},ee=[].concat(["name","category","description","retail_price","is_pre_sale","is_pre_sale_text","is_pre_sale_dt","is_oos","is_on_sale","sale_price","is_explicit"],["cost","color_group_pk","stage"],["supplier_name","supplier_item_id","supplier_item_sn","supplier_item_category","supplier_item_url","supplier_item_cost","supplier_item_cost_currency","supplier_order_id"],["meta_title","meta_description","meta_slug"]),ne={retail_price:0,is_pre_sale:!1,sale_price:0,is_on_sale:!1,is_published:!1};function te(e){var n=e.back,t=((0,s.UO)().prodSlug,(0,l.lr)()),o=(0,r.Z)(t,1)[0],f=((0,s.s0)(),a.useContext(Y.h2)),b=f.product,g=f.categories,_=(0,d.cI)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={};return ee.forEach((function(t){var r,i=null===e||void 0===e?void 0:e[t];n[t]=null!=i?i:null!==(r=ne[t])&&void 0!==r?r:""})),(0,i.Z)((0,i.Z)({},ne),n)}(b)),S=(0,p.Z)(b),N=function(e){f.updateData((0,i.Z)((0,i.Z)({},f),{},{product:(0,i.Z)((0,i.Z)({},b),e)})),m.u.update(e)};return(0,h.jsx)(c.ZP.View,{className:"product-staff-update-view",requiredPerms:["store.change_product"],title:(0,h.jsx)(j.wP,{data:(0,i.Z)({},S.export())}),back:"".concat((0,x.Xs)(n)).concat("".concat(o)?"?".concat(o):""),actions:S.is_published?(0,h.jsx)(v.Ko,{instance:S,onSuccess:function(e){var n=e.data;return N(n)},children:"D\xe9publier"}):(0,h.jsx)(v.H5,{instance:S,onSuccess:function(e){var n=e.data;return N(n)},onFailure:function(e){return _.handleError(e)},children:"Publier"}),children:(0,h.jsx)(c.ZP.Section,{title:(0,h.jsx)("div",{className:"mb-1",children:re}),children:(0,h.jsxs)(u.KZ,{children:[(0,h.jsx)(u.KZ.Tab,{index:!0,children:(0,h.jsx)(Z,{form:_,instance:S,categories:g,onUpdate:N})}),(0,h.jsx)(u.KZ.Tab,{value:"media",children:(0,h.jsx)(T,{instance:S,onUpdate:N})}),(0,h.jsx)(u.KZ.Tab,{value:"inventory",children:(0,h.jsx)(X,{instance:S,onUpdate:N})}),(0,h.jsx)(u.KZ.Tab,{value:"settings",children:(0,h.jsx)(W,{instance:S,onUpdate:N,to:n})})]})})})}var re=(0,h.jsxs)("div",{className:"query-buttons",children:[(0,h.jsx)(u.KZ.Button,{index:!0,target:"__tab",className:"btn-md",children:"Info"}),(0,h.jsx)(u.KZ.Button,{target:"__tab",value:"media",className:"btn-md",children:$("MediaTab.title")}),(0,h.jsx)(u.KZ.Button,{target:"__tab",value:"inventory",className:"btn-md",children:$("InventoryTab.title")}),(0,h.jsx)(u.KZ.Button,{target:"__tab",value:"settings",className:"btn-md",children:$("SettingsTab.title")})]})},6851:function(e,n){n.Z={"InfoTab.title":{fr:"D\xe9tails",en:"Details"},"InfoTab.text":{fr:"Modifier les informations de ce produit",en:"Update product's info"},"SeoTab.title":{fr:"Seo",en:"Seo"},"InventoryTab.title":{fr:"Inventaire",en:"Inventory"},"MediaTab.title":{fr:"M\xe9dia",en:"Media"},"SettingsTab.title":{fr:"Param\xe8tres",en:"Settings"},"SettingsTab.deleteSectionTitle":{fr:"Supprimer ce produit",en:"Delete product"},"CreateView.title":{fr:"Ajouter un produit",en:"Add product"},"ListView.title":{fr:"Produits",en:"Products"},"ListView.actionLinkLabel":{fr:"Ajouter",en:"Add product"},"ListView.noItemText":{fr:"Ajouter un produit pour commencer",en:"Add products to your shop to get started"},"ListView.addProductLinkLabel":{fr:"Ajouter un produit",en:"Add a new product"},"Btn.saveLabel":{fr:"Sauvegarder",en:"Save"}}}}]);
//# sourceMappingURL=901.6c48f1bf.chunk.js.map