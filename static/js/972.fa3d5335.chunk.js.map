{"version":3,"file":"static/js/972.fa3d5335.chunk.js","mappings":"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","sources":["../../../../shopy/shopy-salejs/src/cart/components.tsx","../../../../shopy/shopy-salejs/src/cart/utils.ts","../../../../shopy/shopy-salejs/src/cart/views.AddItem.tsx","../../../../shopy/shopy-salejs/src/cart/views.Update.tsx","../../../../shopy/shopy-salejs/src/customer/components.tsx","../../../../shopy/shopy-salejs/src/customer/forms/index.tsx","../../../../shopy/shopy-salejs/src/customer/index.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport Staff from '@miq/staffjs';\nimport { truncateStr } from '@miq/utiljs';\nimport { ProductPriceDisplay, TProduct, TProductSize } from '@shopy/storejs';\n\nexport const ItemProductCard = ({ product, size }: { product: TProduct; size: TProductSize }) => (\n  <div className=\"d-flex align-items-center\">\n    <ProductImage {...{ product, width: 60, height: 60 }} />\n    <div className=\"flex-1 rounded p-1 \">\n      <div className=\"fw-bold\">{truncateStr(product?.name, 0, 25)}</div>\n      <ProductPriceDisplay {...product} inline />\n      {size && (\n        <div>\n          <span className=\"me-1\">Size:</span>\n          <span className=\"text-sm\">{size?.name}</span>\n        </div>\n      )}\n    </div>\n  </div>\n);\n\nexport const ProductImage = ({\n  product,\n  width,\n  height,\n  ...props\n}: {\n  product: TProduct;\n  width?: number | string;\n  height?: number | string;\n}) =>\n  product?.slug ? (\n    <div {...props} style={{ width: width, height: height }}>\n      <Staff.Img.Square slug=\"slug\" src=\"src\" {...product.cover_data} className=\"rounded\" />\n    </div>\n  ) : null;\n","import { StaffModel, StaffService } from '@miq/staffjs';\nimport { TPrice } from '@shopy/storejs';\n\nimport { TCustomer } from '../customer';\n\nconst timeout = 5000;\n\nexport type TOrderItem = object & {\n  order?: string;\n  product?: string;\n  product_data?: any;\n  name?: string;\n  price?: string;\n  size?: string;\n  was_sale?: boolean;\n  img?: string;\n  quantity?: number;\n};\n\nexport type TCart = {\n  slug?: string;\n  customer?: string;\n  customer_data?: TCustomer;\n  notes?: string;\n  is_completed?: boolean;\n\n  dt_delivery?: string;\n  items?: TOrderItem[];\n  products?: string[];\n\n  is_paid?: boolean;\n  subtotal?: TPrice;\n  total?: TPrice;\n};\n\nclass CartService extends StaffService<TCart> {\n  get canDestroy(): boolean {\n    return this?.data?.products?.length === 0;\n  }\n  addItems(values: { size: string; quantity: number; product_slug: string }[]) {\n    return this.post(`${this._path}products/`, values);\n  }\n\n  addItem(prodSlug: string, values: { size: string; quantity: number }) {\n    return this.post(`${this._path}product/${prodSlug}/`, values);\n  }\n\n  updateItem(prodSlug: string, values: Record<string, any>) {\n    return this.post(`${this._path}item/${prodSlug}/`, { ...values }, { timeout });\n  }\n\n  destroyItem(itemSlug: string) {\n    return this.delete(`${this._path}item/${itemSlug}/`, { timeout });\n  }\n}\n\nexport const Cart = (data: TCart = {}) => {\n  return StaffModel<TCart, CartService>(data, 'carts', CartService);\n};\n\nexport type TCartInstance = ReturnType<typeof Cart>;\n","import * as React from 'react';\n\nimport Staff from '@miq/staffjs';\nimport { Response, uuid } from '@miq/utiljs';\nimport { useProductListRequest, ProductListFilterForm, TProduct, TProductSize } from '@shopy/storejs';\nimport { Button, HorizontalScrollGridLayout, Loading, SectionHeader, StickyFooterLayout } from '@miq/componentjs';\n\nimport { TCartInstance } from './utils';\nimport { ItemProductCard, ProductImage } from './components';\n\ntype TProps = {\n  cart: TCartInstance;\n  isOpen: boolean;\n  setOpen: any;\n  onSuccess: (res: any) => void;\n  onError?: (err: any) => void;\n};\n\ntype TSelect = TProduct & { sizeSlug: string };\n\nconst CartAddItemViewHeader = (props: TProps & { selected: TSelect[] }) => {\n  const { setOpen, selected = [] } = props;\n\n  return (\n    <div className=\"cart-add-item-view-header miq-container center px-1 pt-2\">\n      <SectionHeader\n        title={<span className=\"fw-bold mt-2\">Ajouter des produits</span>}\n        text=\"Tap on a product to add to the cart/ Cliquez sur un produit pour l'ajouter au panier\"\n        actions={<div onClick={() => setOpen?.(false)}> [ x ]</div>}\n      />\n\n      <HorizontalScrollGridLayout className=\"cart-items-preview\" style={{ minHeight: 48, paddingBottom: 0 }}>\n        {selected.map((i) => {\n          return (\n            <div key={uuid()}>\n              <ProductImage product={i} {...{ width: 48, height: 48 }} />\n            </div>\n          );\n        })}\n      </HorizontalScrollGridLayout>\n    </div>\n  );\n};\n\nexport default function CartAddItemView(props: TProps) {\n  const { res: productRes, loading } = useProductListRequest({}, { atc: '1' });\n  const [selected, setSelected] = React.useState<TSelect[]>([]);\n\n  if (!props.isOpen) return null;\n  if (loading) return <Loading />;\n\n  const r = new Response<TProduct>(productRes);\n\n  const products = r.items || [];\n\n  const { cart } = props;\n  const cartSizes = cart?.items?.map(({ size }) => size) || [];\n\n  const addItems = () => {\n    const values = selected.map((s) => ({ product_slug: s.meta_slug!, size: s.sizeSlug, quantity: 1 }));\n\n    if (values.length === 0) return;\n\n    cart\n      .addItems(values)\n      .then((r) => {\n        setSelected([]);\n        props?.onSuccess?.(r);\n      })\n      .catch((err) => props?.onError?.(err));\n  };\n\n  return (\n    <StickyFooterLayout\n      style={{ zIndex: 10000 }}\n      className=\"bg-white m-1 rounded\"\n      header={<CartAddItemViewHeader {...props} {...{ selected }} />}\n      footer={\n        <div className=\"miq-container center\">\n          <div className=\"d-flex justify-content-between bg-white p-2\">\n            <div>\n              <Button onClick={() => props.setOpen(false)} className=\"\">\n                Annuler\n              </Button>\n            </div>\n            <div>\n              <Button disabled={selected.length === 0} onClick={() => addItems()} className=\"btn-primary fw-bold\">\n                Ajouter\n              </Button>\n            </div>\n          </div>\n        </div>\n      }\n    >\n      <Staff.Section header={<ProductListFilterForm fields={[]} />} className=\"miq-container center px-1\">\n        {products.map((product) => {\n          const { sizes = [] } = product;\n\n          return sizes\n            .filter(({ quantity }) => quantity >= 1)\n            .filter((i) => !cartSizes.includes(i.slug))\n            .map((size: TProductSize) => {\n              const checked = selected.find(({ sizeSlug }) => sizeSlug === size?.slug);\n              const isChecked = Boolean(checked);\n              return (\n                <div\n                  className=\"d-flex align-items-center mb-1 border-1 rounded\"\n                  key={uuid()}\n                  style={{ padding: 6 }}\n                  onClick={() => {\n                    if (isChecked) setSelected((items) => items.filter(({ sizeSlug }) => sizeSlug != size?.slug));\n                    else setSelected([{ ...product, sizeSlug: size.slug }, ...selected]);\n                  }}\n                >\n                  <div className=\"flex-1\">\n                    <ItemProductCard {...{ product, size }} />\n                  </div>\n\n                  <div style={{ minWidth: 24, marginLeft: 3, marginRight: 6 }}>\n                    <input type=\"checkbox\" name=\"selected\" className=\"me-2\" checked={isChecked} onChange={() => {}} />\n                  </div>\n                </div>\n              );\n            });\n        })}\n      </Staff.Section>\n    </StickyFooterLayout>\n  );\n}\n","import * as React from 'react';\nimport { useParams } from 'react-router-dom';\n\nimport Staff from '@miq/staffjs';\nimport { useDocumentTitle, useRequest } from '@miq/hookjs';\nimport { Button, Icons, Loading } from '@miq/componentjs';\nimport Form, { useForm } from '@miq/formjs';\nimport { Response, truncateStr, uuid } from '@miq/utiljs';\nimport { SizeQuantityField, SizeSelectField, TProduct, ProductPriceDisplay } from '@shopy/storejs';\n\nimport { TCart, Cart } from './utils';\nimport { ItemProductCard } from './components';\nimport CartAddItemView from './views.AddItem';\nimport { CartItemDeleteButton } from './buttons';\nimport { CustomerCard } from '../customer';\n\nexport default function CartUpdateView() {\n  useDocumentTitle('Add items to cart - Sales');\n  const { cartSlug } = useParams();\n\n  const { res, setRes, loading, ...request } = useRequest(() => Cart({ slug: cartSlug }).retrieve(), {\n    refreshDeps: [cartSlug],\n    // onSuccess: ({ data }) => form.setValues(mapData2Values(data)),\n    onError: ({ response }) => {\n      // if (response?.status === 404) return navigate('../');\n    },\n  });\n  const [isOpen, setOpen] = React.useState<boolean>(false);\n\n  const r = new Response(res);\n  if (!r.isSuccess) return null;\n\n  if (loading) return <Loading />;\n\n  const cart = Cart(r.data);\n\n  return (\n    <Staff.View title=\"Ajouter au panier\" back=\"/staff/sales/carts\">\n      <div className=\"miq-container center\">\n        <Staff.Section\n          border\n          title={`Panier (${cart?.products?.length} produits)`}\n          actions={\n            <>\n              <Button onClick={() => setOpen(true)} className=\"btn-primary-3 btn-round\" title=\"Ajouter des produits\">\n                <Icons.CartPlus />\n              </Button>\n            </>\n          }\n          footer={\n            <div className=\"\">\n              <div className=\"d-flex justify-content-between\">\n                <span className=\"\">Subtotal</span>\n                <span>\n                  <ProductPriceDisplay retail_price_data={cart?.subtotal} />\n                </span>\n              </div>\n              <div className=\"d-flex justify-content-between\">\n                <span className=\"\">Total</span>\n                <span className=\"fw-bold\">\n                  <ProductPriceDisplay retail_price_data={cart?.subtotal} />\n                </span>\n              </div>\n            </div>\n          }\n        >\n          {cart.items.length > 0 ? (\n            <>\n              {cart.items.map((i) => {\n                // console.log(i);\n\n                return (\n                  <div key={uuid()} className=\"d-flex justify-content-between align-items-center\">\n                    <ItemProductCard {...i} size={i.size_data} />\n                    <div>\n                      <CartItemDeleteButton cartInstance={cart} itemSlug={i?.slug} onSuccess={(r) => setRes(r)} />\n                    </div>\n                  </div>\n                );\n              })}\n            </>\n          ) : (\n            <>Ajouter</>\n          )}\n        </Staff.Section>\n\n        <Staff.Section border title=\"Client\">\n          <CustomerCard data={cart.customer_data!} />\n        </Staff.Section>\n\n        <div className=\"text-center\">\n          <Button disabled={cart.products!.length <= 0} className=\"btn-primary btn-md fw-bold w-50\">\n            Confirmer\n          </Button>\n        </div>\n      </div>\n\n      {isOpen && (\n        <CartAddItemView\n          {...{ isOpen, setOpen, cart }}\n          onSuccess={(r) => {\n            setRes(r);\n            setOpen(false);\n          }}\n        />\n      )}\n    </Staff.View>\n  );\n}\n\nexport const ProductAddForm = ({\n  item,\n  onItemClick,\n  ...props\n}: {\n  item: TProduct;\n  onItemClick: (p: TProduct, size: string, qty: string) => Promise<TCart>;\n}) => {\n  const form = useForm({ quantity: 1, size: '' });\n\n  if (!item?.slug) return null;\n\n  const { sizes = [], is_oos, category_data, cover_data, name, size_count = 0 } = item;\n\n  const canAdd = !is_oos && size_count > 0;\n\n  return (\n    <Form\n      context={form}\n      onSubmit={(e) => {\n        e.preventDefault();\n        onItemClick(item, form.values.size, form.values.quantity).catch((err) => {\n          form.handleError(err);\n        });\n      }}\n    >\n      <Staff.Section\n        border\n        header={\n          <div className=\"d-flex\">\n            <div style={{ minWidth: 34, maxWidth: 50 }} className=\"me-1\">\n              <Staff.Img.Thumb src=\"src\" {...cover_data} className=\"rounded\" />\n            </div>\n\n            <div className=\"flex-1\" title={name}>\n              <div className=\"text-ellipsis text-sm\">\n                <span className=\"me-1 fw-bold\">{truncateStr(name!, 0, 45)}</span>\n              </div>\n\n              <div className=\"d-flex flex-column flex-md-ro justify-content-between\">\n                <div className=\"d-grid grid-md-2 gap-1 flex-1\">\n                  <SizeSelectField required sizes={sizes.filter((i) => i.quantity > 0)} error={form.errors.size} />\n                  <SizeQuantityField max={sizes.find((i) => i.slug === form.values.size)?.quantity || 0} min={1} />\n                </div>\n                <div className=\"text-right\">\n                  <Form.Submit className=\"btn btn-primary-2 btn-md fw-bold\">Ajouter</Form.Submit>\n                </div>\n              </div>\n            </div>\n          </div>\n        }\n        actions={<ProductPriceDisplay {...item} className=\"d-flex flex-wrap\" />}\n        className=\"mb-1\"\n      ></Staff.Section>\n    </Form>\n  );\n};\n","import * as React from 'react';\n\nimport { TCustomer } from './types';\n\nexport const CustomerCard = ({ data, ...props }: { data: TCustomer }) => {\n  if (!data || !data.slug) return null;\n\n  const { first_name, last_name, email, phone } = data;\n\n  return (\n    <div className=\"customer-card\">\n      <div className=\"fw-bold\">{`${first_name} ${last_name}`}</div>\n      <div className=\"\">{phone}</div>\n      <div className=\"text-muted text-sm\">{email}</div>\n    </div>\n  );\n};\n","import * as React from 'react';\n\nimport Form, { IFormUpdateProps, useForm } from '@miq/formjs';\nimport { TCustomer } from '../types';\nimport { TCustomerInstance } from '../models';\nimport { CustomerEmailField, CustomerFNameField, CustomerLNameField, CustomerPhoneField } from './fields';\n\ntype TFormUpdateProps<T, I> = IFormUpdateProps<T> & {\n  fields: string[];\n  instance?: I;\n};\n\ntype TCustomerFormProps = Omit<TFormUpdateProps<TCustomer, TCustomerInstance>, 'context'> & {\n  onCustomerSelect?: (p: TCustomer) => void;\n};\n\nexport const CustomerForm = ({\n  children,\n  instance,\n  onSuccess,\n  onError,\n  onCustomerSelect,\n  ...props\n}: TCustomerFormProps) => {\n  const { fields } = props;\n  const form = useForm<TCustomer>(getCustomerFD(instance?.export(), fields));\n\n  const { errors } = form;\n  const sharedProps = { className: 'span-md-3', fieldCN: 'd-grid grid-md-5' };\n\n  return (\n    <Form {...props} context={form} className=\"customer-form\">\n      <div className=\"base-fields\">\n        {fields?.includes('last_name') && (\n          <CustomerLNameField\n            allowSuggestions\n            error={errors.last_name}\n            {...sharedProps}\n            onCustomerSelect={onCustomerSelect}\n            className=\"\"\n          />\n        )}\n\n        {fields?.includes('first_name') && <CustomerFNameField error={errors.first_name} {...sharedProps} />}\n\n        {fields?.includes('phone') && <CustomerPhoneField error={errors.phone} {...sharedProps} />}\n        {fields?.includes('email') && <CustomerEmailField error={errors.email} {...sharedProps} />}\n      </div>\n\n      {children}\n    </Form>\n  );\n};\nconst getCustomerFD = (data?: TCustomer, fields?: string[]) => {\n  if (!data) data = { first_name: '', last_name: '', email: '', phone: '' };\n  const fd: TCustomer = {};\n  fields?.forEach((field) => {\n    fd[field] = data![field];\n  });\n\n  return fd;\n};\n\nconst CustomerSearchInput = (props) => {\n  return <Form.Text {...props} />;\n};\n","import * as React from 'react';\nimport { Routes, Route } from 'react-router-dom';\n\nconst CustomerCreateView = React.lazy(() => import('./views.Create'));\nconst CustomerUpdateView = React.lazy(() => import('./views.Update'));\nconst CustomerListView = React.lazy(() => import('./views.List'));\n\nexport default function CustomerRoutes() {\n  return (\n    <Routes>\n      <Route path=\":custSlug/\" element={<CustomerUpdateView />} />\n      <Route path=\"new/\" element={<CustomerCreateView />} />\n      <Route index element={<CustomerListView />} />\n    </Routes>\n  );\n}\n\nexport * from './types';\nexport * from './components';\nexport { CustomerForm } from './forms';\n"],"names":["ItemProductCard","product","size","className","ProductImage","width","height","truncateStr","name","inline","props","slug","style","src","cover_data","CartService","this","data","products","length","values","post","_path","prodSlug","timeout","itemSlug","delete","StaffService","Cart","StaffModel","CartAddItemViewHeader","setOpen","selected","title","text","actions","onClick","minHeight","paddingBottom","map","i","uuid","CartAddItemView","useProductListRequest","atc","productRes","res","loading","React","setSelected","isOpen","Response","items","cart","cartSizes","zIndex","header","footer","disabled","s","product_slug","meta_slug","sizeSlug","quantity","addItems","then","r","onSuccess","catch","err","onError","fields","sizes","filter","includes","checked","find","isChecked","Boolean","padding","minWidth","marginLeft","marginRight","type","onChange","CartUpdateView","useDocumentTitle","cartSlug","useParams","useRequest","retrieve","refreshDeps","response","setRes","isSuccess","back","border","retail_price_data","subtotal","size_data","cartInstance","CustomerCard","customer_data","ProductAddForm","item","onItemClick","form","useForm","is_oos","category_data","size_count","context","onSubmit","e","preventDefault","handleError","maxWidth","required","error","errors","max","min","first_name","last_name","email","phone","CustomerForm","children","instance","onCustomerSelect","getCustomerFD","export","sharedProps","fieldCN","allowSuggestions","fd","forEach","field","CustomerCreateView","CustomerUpdateView","CustomerListView","CustomerRoutes","path","element","index"],"sourceRoot":""}