"use strict";(self.webpackChunk_storepy_clientjs=self.webpackChunk_storepy_clientjs||[]).push([[977],{3977:function(e,n,s){s.r(n),s.d(n,{ProductAddForm:function(){return y},default:function(){return Z}});var i=s(8519),t=s(6009),r=s(8312),l=s(2411),a=s(6520),c=s(7371),d=s(2134),o=s(125),u=s(3308),m=s(3896),x=s(4113),j=s(840),h=s(6123),f=s(9062),v=s(8136),p=function(e){var n=e.setOpen,s=e.selected,i=void 0===s?[]:s;return(0,v.jsxs)("div",{className:"cart-add-item-view-header miq-container center px-1 pt-2",children:[(0,v.jsx)(o.M$,{title:(0,v.jsx)("span",{className:"fw-bold mt-2",children:"Ajouter des produits"}),text:"Tap on a product to add to the cart/ Cliquez sur un produit pour l'ajouter au panier",actions:(0,v.jsx)("div",{onClick:function(){return null===n||void 0===n?void 0:n(!1)},children:" [ x ]"})}),(0,v.jsx)(o.j6,{className:"cart-items-preview",style:{minHeight:48,paddingBottom:0},children:i.map((function(e){return(0,v.jsx)("div",{children:(0,v.jsx)(h.qN,{product:e,width:48,height:48})},(0,m.Vj)())}))})]})};function g(e){var n=(0,x._P)(void 0,{published:"include",atc:1}).res,s=l.useState([]),r=(0,t.Z)(s,2),a=r[0],d=r[1];if(!e.isOpen)return null;var u=new m.HM(n).items||[],j=e.cart.items.map((function(e){var n=e.size;return null===n||void 0===n?void 0:n.slug}))||[];return(0,v.jsx)(o.cv,{style:{zIndex:1e4},className:"bg-white",header:(0,v.jsx)(p,(0,i.Z)((0,i.Z)({},e),{},{selected:a})),footer:(0,v.jsx)("div",{className:"miq-container center",children:(0,v.jsxs)("div",{className:"d-flex justify-content-between bg-white p-2",children:[(0,v.jsx)("div",{children:(0,v.jsx)(o.zx,{onClick:function(){return e.setOpen(!1)},className:"",children:"Annuler"})}),(0,v.jsx)("div",{children:(0,v.jsx)(o.zx,{disabled:0===a.length,className:"btn-primary fw-bold",children:"Ajouter"})})]})}),children:(0,v.jsx)(c.ZP.Section,{header:(0,v.jsx)(x.ir,{}),className:"miq-container center px-1",children:u.map((function(e){var n=e.sizes;return(void 0===n?[]:n).filter((function(e){return!j.includes(e.slug)})).map((function(n){var s=a.find((function(e){return e.sizeSlug===(null===n||void 0===n?void 0:n.slug)})),t=Boolean(s);return(0,v.jsxs)("div",{className:"d-flex align-items-center mb-1 border-1 rounded",style:{padding:6},onClick:function(){d(t?function(e){return e.filter((function(e){return e.sizeSlug!=(null===n||void 0===n?void 0:n.slug)}))}:[(0,i.Z)((0,i.Z)({},e),{},{sizeSlug:n.slug})].concat((0,f.Z)(a)))},children:[(0,v.jsx)("div",{className:"flex-1",children:(0,v.jsx)(h.nG,{product:e,size:n})}),(0,v.jsx)("div",{style:{minWidth:24,marginLeft:3,marginRight:6},children:(0,v.jsx)("input",{type:"checkbox",name:"selected",className:"me-2",checked:t,onChange:function(){}})})]},(0,m.Vj)())}))}))})})}var b=s(3303),N=["res","setRes","loading"],w=["item","onItemClick"];function Z(){var e=(0,a.UO)().cartSlug,n=(0,d.QT)((function(){return(0,j.A)({slug:e}).retrieve()}),{refreshDeps:[e],onError:function(e){e.response}}),s=n.res,u=n.setRes,f=n.loading,p=((0,r.Z)(n,N),l.useState(!1)),w=(0,t.Z)(p,2),Z=w[0],y=w[1],z=new m.HM(s);if(!z.isSuccess)return null;if(f)return(0,v.jsx)(o.gb,{});var S=(0,j.A)(z.data);return(0,v.jsxs)(c.ZP.View,{title:"Modifier une commande",back:"/staff/sales/",children:[(0,v.jsxs)("div",{className:"miq-container center",children:[(0,v.jsx)(c.ZP.Section,{border:!0,title:"Client",actions:(0,v.jsx)(v.Fragment,{children:"Modifier"}),children:(0,v.jsx)(h.uY,{data:S.customer_data})}),(0,v.jsx)(c.ZP.Section,{border:!0,title:"Panier (".concat(S.products.length," produits)"),actions:(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(o.zx,{onClick:function(){return y(!0)},className:"btn-primary-3 btn-round",title:"Ajouter des produits",children:(0,v.jsx)(o.PJ.HB,{})})}),footer:(0,v.jsxs)("div",{className:"",children:[(0,v.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,v.jsx)("span",{className:"",children:"Subtotal"}),(0,v.jsx)("span",{children:(0,v.jsx)(x._S,{retail_price_data:null===S||void 0===S?void 0:S.subtotal})})]}),(0,v.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,v.jsx)("span",{className:"",children:"Total"}),(0,v.jsx)("span",{className:"fw-bold",children:(0,v.jsx)(x._S,{retail_price_data:null===S||void 0===S?void 0:S.subtotal})})]})]}),children:S.items.length>0?(0,v.jsx)(v.Fragment,{children:S.items.map((function(e){return console.log(e),(0,v.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,v.jsx)(h.nG,(0,i.Z)((0,i.Z)({},e),{},{size:e.size_data})),(0,v.jsx)("div",{children:(0,v.jsx)(b.u,{cartInstance:S,itemSlug:null===e||void 0===e?void 0:e.slug,onSuccess:function(e){return u(e)}})})]},(0,m.Vj)())}))}):(0,v.jsx)(v.Fragment,{children:"Ajouter"})}),(0,v.jsx)("div",{className:"text-center",children:(0,v.jsx)(o.zx,{disabled:S.products.length<=0,className:"btn-primary btn-md fw-bold w-50",children:"Confirmer"})})]}),(0,v.jsx)(g,{isOpen:Z,setOpen:y,cart:S})]})}var y=function(e){var n,s=e.item,t=e.onItemClick,l=((0,r.Z)(e,w),(0,u.cI)({quantity:1,size:""}));if(null===s||void 0===s||!s.slug)return null;var a=s.sizes,d=void 0===a?[]:a,o=(s.is_oos,s.category_data,s.cover_data),j=s.name;s.size_count;return(0,v.jsx)(u.ZP,{context:l,onSubmit:function(e){e.preventDefault(),t(s,l.values.size,l.values.quantity).catch((function(e){l.handleError(e)}))},children:(0,v.jsx)(c.ZP.Section,{border:!0,header:(0,v.jsxs)("div",{className:"d-flex",children:[(0,v.jsx)("div",{style:{minWidth:34,maxWidth:50},className:"me-1",children:(0,v.jsx)(c.ZP.Img.Thumb,(0,i.Z)((0,i.Z)({src:"src"},o),{},{className:"rounded"}))}),(0,v.jsxs)("div",{className:"flex-1",title:j,children:[(0,v.jsx)("div",{className:"text-ellipsis text-sm",children:(0,v.jsx)("span",{className:"me-1 fw-bold",children:(0,m.bI)(j,0,45)})}),(0,v.jsxs)("div",{className:"d-flex flex-column flex-md-ro justify-content-between",children:[(0,v.jsxs)("div",{className:"d-grid grid-md-2 gap-1 flex-1",children:[(0,v.jsx)(x.D8,{required:!0,sizes:d.filter((function(e){return e.quantity>0})),error:l.errors.size}),(0,v.jsx)(x.PI,{max:(null===(n=d.find((function(e){return e.slug===l.values.size})))||void 0===n?void 0:n.quantity)||0,min:1})]}),(0,v.jsx)("div",{className:"text-right",children:(0,v.jsx)(u.ZP.Submit,{className:"btn btn-primary-2 btn-md fw-bold",children:"Ajouter"})})]})]})]}),actions:(0,v.jsx)(x._S,(0,i.Z)((0,i.Z)({},s),{},{className:"d-flex flex-wrap"})),className:"mb-1"})})}}}]);
//# sourceMappingURL=977.9ac671b3.chunk.js.map